var app=angular.module ('main', ['ngRoute','ui.bootstrap', 'ngCookies','ngAnimate', 'ngSanitize']);
app.run( function ($rootScope,$cookies, $window, $location) 
	{
	$rootScope.$on('$routeChangeStart', function (e, curr, prev) { console.log ('in $routeChangeStart');  $rootScope.isLodding=true; });
	$rootScope.$on('$routeChangeSuccess', function (e, curr, prev) { console.log ('in $routeChange Success '+ $rootScope.logStatus); $rootScope.isLodding=false; });	
	$rootScope.$on('$routeChangeError', function (e, curr, prev, rejection, ) { console.log ('in $routeChange Error'+ rejection); $rootScope.isLodding=false; $window.history.back(); }	);				
		$rootScope.loggedIn=false; $rootScope.signedout=false; $rootScope.logName='Login'; $rootScope.logAnchor='#/login'; $rootScope.logEvenListner=null; //$rootScope.logRec=null;
		//$rootScope.configTable=false; $rootScope.rootP=''; $rootScope.logStatus=false;  $rootScope.showNav=false; $rootScope.selMainRec=null; 		
		//$rootScope.userId='', $rootScope.userP='', $rootScope.dbName='', $rootScope.tName='';
	});

//angular.element(function() { angular.bootstrap(document, ['main']);  });
//var app=angular.module ("Mod1", []).run(["$rootScope", function ($rootScope) { $rootScope.TaxPercent="30%";}]);
app.config (function ($routeProvider) {
	$routeProvider.when ('/', { templateUrl: 'pages/main.php',  controller: 'indexCtrl' })
	.when ('/login', {templateUrl: 'pages/signin.php', controller: 'loginCtrl' ,
		 resolve: { logNotify:  function ($q, $cookies) { if ($cookies.get('logStatus') === 'true') { return $q.reject('Already logged In!'); }  } }
		   })
	.when ('/signout', {templateUrl: 'pages/signout.php', controller: 'signoutCtrl',
		   resolve: { logNotify:  function ($q, $cookies) { if ($cookies.get('logStatus') === 'false'	) { return $q.reject('Already logged In!'); }  } }
		  })
	.when ('/loggedIn', {templateUrl: 'pages/loggedIn.php', controller: 'loggedInCtrl',
		   resolve: { logNotify:  function ($q, $cookies) { if ($cookies.get('logStatus') === 'false'	) { return $q.reject('log out is false'); }  } }
		   })
	.when ('/link11', {templateUrl: 'pages/link11.php', controller: 'RecordMgtCtrl',
		   resolve: { logNotify:  function ($q, $cookies) { if ($cookies.get('logStatus') === 'false'	) { return $q.reject('log out is false'); }  } }
		   })	
	.when ('/link21', {templateUrl: 'pages/link21.php', controller: 'SummaryCtrl',
		  resolve: { logNotify:  function ($q, $cookies) { if ($cookies.get('logStatus') === 'false'	) { return $q.reject('log out is false'); }  } } 
		   })	
	.otherwise ({template: '404'}) });
	app.config(['$locationProvider', function($locationProvider) { $locationProvider.hashPrefix(''); }]);  //Removes hashtag #! and #%2F etc.
	app.controller ('loadDefault', function ($scope, $log, $rootScope, $location, $cookies, $route, $window) { 
		$rootScope.funcloadDef= function () { 
		if ($cookies.get('logStatus')==='true')  { $rootScope.logStatus=true; $rootScope.logStrue();  } else if ($cookies.get('logStatus')==='false')  {  $rootScope.logStatus=false; $rootScope.logSfalse(); }	 else  {  $rootScope.logStatus=false; $rootScope.logSfalse(); }	  		  
		}
		$rootScope.logStrue= function () { var obj1=$cookies.getObject('logRec'),obj2=$cookies.getObject('logRec2'); $rootScope.logRec=  angular.merge({}, obj1, obj2);
		var t1="", y2=document.getElementById("myNav");   var tOpt=''; fHome=''; for(var k in $rootScope.logRec) { tOpt=tOpt + "<option>XXX-"+ $rootScope.logRec[k]['licenseNo'].substring($rootScope.logRec[k]['licenseNo'].length-2,  $rootScope.logRec[k]['licenseNo'].length) + "</option>";  }  
		if ($rootScope.logRec[$cookies.get('licNo')]['PrevName']=='Admin') 
		t1="<div class='row-fluid'><div style=float:left; top:5px; margin-left:1%;' id='fosHome'></div><div style='float:right; top:5px; margin-left:1%;' id='licNo'>License No. <select style='border-radius: 5px; float:right;' class='dropdown-toggle' data-toggle='dropdown' type='text' id='licNoOption'  ng-model='selectedLicenseNo'>"+ tOpt +"</select></div></div><div class='row-fluid'> <div style='margin-left:1%;' id='menu'><ul><li><a href='#'>Home</a></li><li><a href=''>About</a></li><li><a>Tasks</a><ul><li><a href='#/link11'>Record Operation</a></li><li><a href='#/link21'>Forms/Reports</a></li><li><a href='#/loggedIn'>Summaries</a></li></ul></li><li><a href=''>Contacts</a></li><li id='login'><a href='#/signout'>signout</a></li></ul></div></div>";	
		else 
		t1="<div class='row-fluid'><div style=float:left; top:5px; margin-left:1%;' id='fosHome'></div><div style='float:right; top:5px; margin-left:1%;' id='licNo'>License No. <select style='border-radius: 5px; float:right;' class='dropdown-toggle' data-toggle='dropdown' type='text' id='licNoOption'  ng-model='selectedLicenseNo'>"+ tOpt +"</select></div></div><div class='row-fluid'> <div style='margin-left:1%;' id='menu'><ul><li><a href='#'>Home</a></li><li><a href=''>About</a></li><li><a>Tasks</a><ul><li><a href='#/link11'>Record Operation</a></li></ul></li><li><a href=''>Contacts</a></li><li id='login'><a href='#/signout'>signout</a></li></ul></div></div>";	
		y2.innerHTML= t1; 
		document.getElementById("licNoOption").addEventListener("change", $rootScope.licNoChange); document.getElementById("licNoOption").selectedIndex=$cookies.get ('licNo'); 
		document.getElementById("fosHome").innerHTML=$rootScope.logRec[$cookies.get('licNo')]['Name'];  
		
		//$rootScope.logRec= $cookies.getObject('logRec');
		}
		$rootScope.logSfalse= function () { $cookies.put('logStatus', 'false'); $cookies.putObject('logRec', ''); var y2=document.getElementById("myNav"); y2.innerHTML= "<div style='margin-left:10%;' id='menu'><ul><li><a href='#'>Home</a></li><li><a href=''>About</a></li><li><a href=''>Contacts</a></li><li id='login'><a href='#/login'>login</a></li></ul></div>"; }		
		$rootScope.licNoChange = function () { $cookies.put ('licNo', document.getElementById("licNoOption").selectedIndex); document.getElementById("fosHome").innerHTML=$rootScope.logRec[$cookies.get('licNo')]['Name']; $window.location.reload();   }
	});  
 app.controller ('indexCtrl', function ($scope, $log,$cookies, $rootScope) { 
  		if ($cookies.get('logStatus')==='true')  { $rootScope.logStrue();  } else if ($cookies.get('logStatus')==='false')  { $rootScope.logSfalse();  }	
});  	
app.controller ('signoutCtrl', function ($scope, $http, $rootScope, $cookies) { 		
		if ($cookies.get('logStatus')==='true')  { $rootScope.logSfalse(); }
});   

app.controller ('loginCtrl', function ($scope,$rootScope, $http, $location, $cookies, $window) {		
	$rootScope.loggedIn=false; $scope.curK=-1;  $rootScope.rootP='123456789'; $scope.rpChecker=false; $scope.sfChecker=true; $scope.checkConfigT=false; $scope.checkSignIn=true;
	//if ($cookies.get('logStatus')==='true')  { $rootScope.loggedIn=true; $rootScope.logStrue();   } else if ($cookies.get('logStatus')==='false')  { $rootScope.logSfalse();   }								   	 
	$scope.rootPCheck = function (rootP) { $rootScope.rootP=rootP;  var data= {'root_P':rootP, 'getName':'connection'  }; var config= {params: data, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) .then (function(response) { $scope.rP=response.data;  if ($scope.rP.length>=0) $scope.checkconfigTRecord (rootP);  }) , function (response) { alert ("failed to show"); };  } 
		$scope.checkConfigTable = function (configRec, rootP) {  var found=false;  for(var k in configRec) if (configRec[k].dbName=='configuration') {  if ($scope.rtRec[0].fldTName!=null) found=true; } if (found==false) { $scope.createConfigTable(rootP); $scope.checkSignIn=false; $scope.rpChecker=false; $scope.checkConfigT=true; } else {$scope.checkSignIn=true;  $scope.sfChecker=true; $scope.rpChecker=false; $scope.checkConfigT=false; } }
		$scope.createConfigTable = function (rootP) { var data= { 'getName':'createConfigurationTable', 'root_P':rootP }; var config= {params: data, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) .then (function(response) {  }) , function (response) { alert ("failed to show"); }; }
		$scope.turnOnOffDefault = function(dbName) { $scope.emptyDisable(); for (var k in $scope.rP) if (dbName==$scope.rP[k].dbName) {$scope.curK=k; $scope.rP[k].enadis=false;  $scope.getdbTables(dbName, k);  } } 
		$scope.getdbTables = function (dbName, k) { var data= { 'getName':'getdbTable', 'root_P':$rootScope.rootP, 'dbName': dbName }; var config= {params: data, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) .then (function(response) { $scope.rP[k].tName=response.data; $scope.rP[k].onoff='on'; $scope.rP[k].save='ok'; }) , function (response) { alert ("failed to show"); }; return ($scope.defTables); }
		$scope.emptyDisable = function () {for (var k in $scope.rP) { $scope.rP[k].tName=null; $scope.rP[k].enadis=true; $scope.rP[k].onoff='off';}  }
		$scope.ontblselChange= function (dbName) { $scope.rP[$scope.curK].enadisOk=true; $scope.tblcolumnNames=null;  $scope.getColNames($scope.rP[$scope.curK].dbName, dbName.Table_Name); }
		$scope.onpasselChange= function (us, ps) {if (us.tblLabel!=null && ps.tblLabel!=null) $scope.rP[$scope.curK].enadisOk=false; else $scope.rP[$scope.curK].enadisOk=true;  } 	
		$scope.onuserselChange= function (us, ps) {if (us.tblLabel!=null && ps.tblLabel!=null) $scope.rP[$scope.curK].enadisOk=false; else $scope.rP[$scope.curK].enadisOk=true;  }
		$scope.getColNames = function (dbName, tName) { $scope.curK; var data= { 'dbName': dbName, 'tName': tName, 'getName':'getColNames', 'root_P':$rootScope.rootP };  var config= {params: data, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) 	.then (function(response) { $scope.rP[$scope.curK].userId=response.data; $scope.rP[$scope.curK].userpass=response.data;   }) , function (response) { alert ("failed to show"); }; }					
		$scope.saveConfig = function (dbName, tName, uId, uP) { $scope.checkSignIn=true;  $scope.sfChecker=true; $scope.rpChecker=false; $scope.checkConfigT=false; var data= { 'getName':'saveConfiguration', 'root_P':$rootScope.rootP, 'dbName': dbName, 'tName': tName.Table_Name, 'uId': uId.tblLabel, 'uP': uP.tblLabel, 'style': 'Style' };  var config= {params: data, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) 	.then (function(response) {  alert (response.data); }) , function (response) { alert ("failed to show"); }; }
		$scope.checkconfigTRecord = function (rootP) {  var data= { 'getName':'configTRecord', 'root_P':rootP }; var config= {params: data, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) .then (function(response) { $scope.rtRec=response.data; $scope.checkConfigTable($scope.rP, rootP); }) , function (response) { alert ("failed to show"); };  }	
	$scope.signIn = function (userId, userP) {  $rootScope.logRec=null; $scope.checkLoginRecord (userId, userP);  }
		$scope.checkLoginRecord = function (uIdV, uPV) {  var data= { 'getName':'logginRecord',  'uIdV':uIdV, 'uPV':uPV };  
			var config= {params: data, headers: {'Accept' : 'application/json'}};  $http.get("pages/connection.php", config) .then (function(response)
			{    if (response.data.length> 0) 
				{  $cookies.put ('logStat', true);    
					var y2=document.getElementById("myNav"); $rootScope.logRec= response.data; var tOpt=''; fHome='';  $scope.arrJson=[]; $scope.arrJson2=[]; var jsonData2;  var jsonData;
					for(var k in response.data) {  tOpt=tOpt+ "<option>"+  response.data[k]['licenseNo'].length  + "</option>"; 
					jsonData = {'EmpId':response.data[k]['EmpId'], 'licenseNo':response.data[k]['licenseNo'] , 'lictype' : response.data[k]['lictype'],  'Name':response.data[k]['Name'], 'EmpFName':response.data[k]['EmpFName'], 'EmpLName':response.data[k]['EmpLName'], 'PrevName':response.data[k]['PrevName'], 'EmpEaddress':response.data[k]['EmpEaddress'], 'Email':response.data[k]['Email'], 'EmpUserId':response.data[k]['EmpUserId'], 'EmpPassword':response.data[k]['EmpPassword']};  $scope.arrJson.push(jsonData); 
					jsonData2 = {'OpFName': response.data[k]['OpFName'], 'OpMName':response.data[k]['OpMName'], 'OpLName': response.data[k]['OpLName'], 'OpDb': response.data[k]['OpDb'], 'OpAddress': response.data[k]['OpAddress'], 'OpCity': response.data[k]['OpCity'], 'OpState': response.data[k]['OpState'], 'OpZipCode': response.data[k]['OpZipCode'], 'CellPhone': response.data[k].CellPhone, 'HomePhone': response.data[k].HomePhone, 'Address': response.data[k].Address, 'City': response.data[k].City, 'State':response.data[k].State, 'Zipcode':response.data[k].Zipcode}; $scope.arrJson2.push(jsonData2);   
					}  
					fHome=response.data[0]['Name'];     $cookies.putObject('logRec',  $scope.arrJson);  $cookies.putObject('logRec2',  $scope.arrJson2); 
					y2.innerHTML= "<div class='row-fluid'><div style='float:left; top:-5px; margin-left:1%;' id='fosHome'>"+fHome +"</div><div style='float:right; top:-5px; margin-right:5%;' id='licNo'>License No. <select style='border-radius: 5px; float:right;position:top;' class='dropdown-toggle' data-toggle='dropdown' type='text' id='licNoOption'  ng-model='selectedLicenseNo'>"+ tOpt +"</select></div></div><div class='row-fluid'> <div style='margin-left:1%;' id='menu'><ul><li><a href='#'>Home</a></li><li><a href=''>About</a></li><li><a>Tasks</a><ul><li><a href='#/link11'>Record Operation</a></li><li><a href='#/link21'>Forms/Reports</a></li><li><a href='#/loggedIn'>Summaries</a></li></ul></li><li><a href=''>Contacts</a></li><li id='login'><a href='#/signout'>signout</a></li></ul></div></div>";						
					document.getElementById("licNoOption").addEventListener("change", $rootScope.licNoChange);  
					document.getElementById("licNoOption").selectedIndex=0; $cookies.put ('licNo', 0);  
					$cookies.put('AfcAddress', response.data[0].Address + ' ' + response.data[0].City + ' '+ response.data[0].State + ' ' + response.data[0].Zipcode); $cookies.put('AfcOpName', response.data[0].OpFName + ' ' + response.data[0].OpLName);  $cookies.put('AfcPhone', response.data[0].CellPhone + (response.data[0].HomePhone==null ?'':('/'+ response.data[0].HomePhone)) ); $cookies.put('AfcFax', response.data[0].Fax); 			
				}  
			$scope.setLoginRecord (response.data);  }) , function (response) { alert ("failed to show"); 
		   	};  
		}
		$rootScope.licNoChange = function () {   $cookies.put ('licNo', document.getElementById("licNoOption").selectedIndex); document.getElementById("fosHome").innerHTML=$rootScope.logRec[$cookies.get('licNo')]['Name'];  $route.reload();  }
		//$scope.checkLoginRecord = function (rootP, uIdV, uPV) {   var dbName=$scope.rtRec[0].flddbName, tName= $scope.rtRec[0].fldTName, uId=$scope.rtRec[0].fldUserId, uP=$scope.rtRec[0].fldPassword;  $cookies.put('tName', tName); $cookies.put('userId', uId); $cookies.put('userP', uP); $cookies.put('rootP', rootP); $cookies.put('dbName', dbName);  var data= { 'getName':'logginRecord', 'root_P':rootP, 'dbName':dbName, 'tName':tName, 'uIdV':uIdV, 'uPV':uPV, 'uId':uId, 'uP':uP };  var config= {params: data, headers: {'Accept' : 'application/json'}};  $http.get("pages/connection.php", config) .then (function(response) {  if (response.data!=null) { $cookies.put ('logStat', true); $rootScope.logRec=response.data; $cookies.put('prevName', response.data[0]['prevName']);  $cookies.put('uName', $rootScope.logRec[0]['EmpFName']); $cookies.put('EmpId', $rootScope.logRec[0]['EmpId']);  $cookies.put('uLName', $rootScope.logRec[0]['EmpLName']); $cookies.put('OpId', $rootScope.logRec[0]['Opid']);  } $scope.setLoginRecord ($rootScope.logRec);  }) , function (response) { alert ("failed to show"); };  }		
		$scope.setLoginRecord = function (resp) { if (resp.length>=1)  {  $cookies.put('logStatus', true); $rootScope.logStatus=true; $location.path('/loggedIn'); $cookies.put ('logName', 'signout');  $rootScope.logName= $cookies.get ('logName'); $cookies.put ('logAnchor', '#/signout'); $rootScope.logAnchor= $cookies.get ('logAnchor');  /*  $scope.setLoginContent();  */ $scope.sfChecker=false; $scope.checkConfigT=false; $scope.checkSignIn=false;} else  { alert ('Wrong UserId/Password!'); } }
		$scope.setLoginContent = function () { $rootScope.logStrue();   }
		$scope.EvenListner= function () { alert ('Creates a funciton listenter!');} 
	}); 
app.controller ('loggedInCtrl', function ($scope,$rootScope, $http, $location, $cookies) {   
		if ($cookies.get('logStatus')==='true')  {    $rootScope.logStrue();   } else if ($cookies.get('logStatus')==='false')  { $rootScope.logSfalse();  }
		$scope.nPageC=0;  $scope.docSummary={};  $scope.licenseNo =$rootScope.logRec[$cookies.get ('licNo')]['licenseNo'];  $scope.prevName=$rootScope.logRec[$cookies.get ('licNo')]['PrevName']; $scope.empId=$rootScope.logRec[$cookies.get ('licNo')]['EmpId']; $scope.fName=$rootScope.logRec[$cookies.get ('licNo')]['EmpFName']; $scope.lName=$rootScope.logRec[$cookies.get ('licNo')]['EmpLName'];
		$scope.btnClicked={}; $scope.btnKvalue={}; var  temp='', s3="'margin: auto; float: left;'", c1="'col-xs-2 col-sm-2 col-md-2 col-lg-2'", c2="'col-xs-1 col-sm-1 col-md-1 col-lg-1'", c3="'col-xs-3 col-sm-3 col-md-3 col-lg-3'";  
			var temp, sNo=0,i=0; 	var data= { 'getName':'docSummary', 'licenseNo': $scope.licenseNo, 'prevName':$scope.prevName, 'empId': $scope.empId, 'dbName': $cookies.get('dbName'), 'root_P':$cookies.get('rootP') };  var config= {params: data, headers: {'Accept' : 'application/json'}};
			$http.get("pages/connection.php", config) .then (function(response) { $scope.docSummary= response.data;  $scope.allAtOne();  }), function (response) { alert ("failed to show"); }; 		
		$scope.allAtOne = function () {
		for (var k in $scope.docSummary) { 
			var objKeys='', objKeys = Object.keys($scope.docSummary[k]), strKey= JSON.stringify(objKeys),  strKey=strKey.substr(2,9), strKeySub=strKey.substr(0,6);  $scope.btnKvalue[strKey]=k; initialScope(strKey, k);  
			 //arrJson[$scope.columnNames[k].tblLabel] = new Array(); arrJson[$scope.columnNames[k].tblLabel].push($scope.columnNames[k].tblName); arrDataInfo[1]= arrJson; $scope.arrDataInfo= arrDataInfo; 
			document.getElementById(strKeySub).innerHTML= "<div id="+strKey+" class='row-fluid' style='margin-left: 0.5% margin:0px; border-bottom:solid 1px; border-radius:5px; width:90%'><div style='width:5in; margin: auto; float: left;'>" +strKey+" information : <i style='color:red'>"+  $scope.docSummary[k][strKey].length+" record/s </i></div></div>";   $scope.btnClicked[strKey]= false; document.getElementById(strKey).onclick = $scope.disBlock;  
		 }
		document.getElementById("summary").innerHTML= "<div id='' class='row' style='margin:0px; border-bottom:solid 1px; border-radius:5px; width:90%'><div style='width:5in; margin: auto; float: left;'>Welcome! <label style='font-familly: arial verdena; margin-left:1%;'>"+ $scope.fName +'  ' +  $scope.lName +" </label><a id=printBtn type='submit' class='btn' ng-click='' name='' value=''>(click to print)</a>/<a id=sendEmail type='submit' class='btn' ng-click='' name='' value=''>(Send Email)</a></div></div>";  document.getElementById('printBtn').onclick = $scope.tSummary;   document.getElementById('sendEmail').onclick=sendStEmail;
		//sendEmail('oPSummary');
		
		}
	$scope.disBlock = function () { var temp='',i=0,ii=1,tdata='',  element = document.getElementById(this.id); 	var  s3="'margin: 0px; float: left; font-size:0.8em;  white-space: nowrap;'", c2="'col-xs-2 col-sm-2 col-md-2 col-lg-2'", c1="'col-xs-1 col-sm-1 col-md-1 col-lg-1'", c3="'col-xs-3 col-sm-3 col-md-3 col-lg-3'";
	if ($scope.btnClicked[this.id]===false) 
	 		{  
			tdata= $scope.docSummary[$scope.btnKvalue[this.id]][this.id];   
			if (this.id==='getCurren') { $scope.getCurMed=tdata; temp=temp+ "<div class=row style='background-color:cyan; align-content:center; margin-left: 7.5%; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px red; border-radius: 5px;'><div class="+c1+" style="+s3+">Sno.</div><div class="+c2+" style="+s3+">Resident Id.</div><div class="+c2+" style="+s3+">Med. Name</div><div class="+c1+" style="+s3+">Days</div><div class="+c1+" style="+s3+">Strength</div><div class="+c1+" style="+s3+">Expiration</div><div class="+c2+" style="+s3+">Rx No</div><div class="+c1+" style="+s3+">Location</div></div>";			
					while (i< tdata.length) { temp=temp+ "<div class=row style='backgroundColor:yellow; align-content:center; margin-left: 7.5%; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px; border-radius: 5px;'><div class="+c1+" style="+s3+">"+ ii +")</div><div class="+c2+" style="+s3+">"+ tdata[i].resId+"</div><div class="+c2+" style="+s3+">"+ tdata[i].GenName+"</div><div class="+c1+" style="+s3+">"+ tdata[i].DatesRemained+"</div><div class="+c1+" style="+s3+">"+ tdata[i].strength+"</div><div class="+c1+" style="+s3+">"+ tdata[i].expDate+"</div><div class="+c2+" style="+s3+">"+ tdata[i].RxNo+"</div><div class="+c1+" style="+s3+">"+ tdata[i].location+"</div></div>";	 ii++; i++; } 	}			
			else if (this.id==='expCertif') {  $scope.expCertified=tdata; temp=temp+ "<div class=row style='background-color:cyan; align-content:center; margin-left: 7.5%; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px red; border-radius: 5px;'><div class="+c1+" style="+s3+">Sno.</div><div class="+c2+" style="+s3+">Staff Id</div><div class="+c3+" style="+s3+">Course Code</div><div class="+c2+" style="+s3+">Date Remained</div><div class="+c1+" style="+s3+">Expiration</div></div>";			
					while (i< tdata.length) {  temp=temp+ "<div class=row style='backgroundColor:yellow; align-content:center; margin-left: 7.5%; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px; border-radius: 5px;'><div class="+c1+" style="+s3+">"+ ii +")</div><div class="+c2+" style="+s3+">"+ tdata[i].Staff_Id+"</div><div class="+c3+" style="+s3+">"+ tdata[i].Course_Code+"</div><div class="+c2+" style="+s3+">"+ tdata[i].DatesRemained+"</div><div class="+c1+" style="+s3+">"+ tdata[i].CertExDate+"</div></div>";	ii++;  i++; } 	}			
			else if (this.id==='drapptRem') {  $scope.drApptReminder= tdata; temp=temp+ "<div class=row style='background-color:cyan; align-content:center; margin-left: 7.5%; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px red; border-radius: 5px;'><div class="+c1+" style="+s3+">Sno.</div><div class="+c2+" style="+s3+">Resient Id</div><div class="+c2+" style="+s3+">Appt. Date</div><div class="+c2+" style="+s3+">Appt. Time</div><div class="+c1+" style="+s3+">Remaining Days</div></div>";			
					while (i< tdata.length) { temp=temp+ "<div class=row style='backgroundColor:yellow; align-content:center; margin-left: 7.5%; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px; border-radius: 5px;'><div class="+c1+" style="+s3+">"+ ii +")</div><div class="+c2+" style="+s3+">"+ tdata[i].resId+"</div><div class="+c2+" style="+s3+">"+ tdata[i].AppDate+"</div><div class="+c2+" style="+s3+">"+ tdata[i].AppTime+"</div><div class="+c1+" style="+s3+">"+ tdata[i].DatesRemained+"</div></div>";	ii++;  i++; } 	}			
			else if (this.id==='deligatio') { $scope.expDeligation=tdata; temp=temp+ "<div class=row style='background-color:cyan; align-content:center; margin-left: 7.5%; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px red; border-radius: 5px;'><div class="+c1+" style="+s3+">Sno.</div><div class="+c2+" style="+s3+">Staff Name</div><div class="+c2+" style="+s3+">Resident Id</div><div class="+c1+" style="+s3+">Rem(D)</div><div class="+c2+" style="+s3+">Deligation Task</div><div class="+c2+" style="+s3+">Last Deligated</div><div class="+c2+" style="+s3+">Deligat Exp</div></div>";			
					while (i< tdata.length) { temp=temp+ "<div class=row style='backgroundColor:yellow; align-content:center; margin-left: 7.5%; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px; border-radius: 5px;'><div class="+c1+" style="+s3+">"+ ii +")</div><div class="+c2+" style="+s3+">"+ tdata[i].Staff_Id+"</div><div class="+c2+" style="+s3+">"+ tdata[i].Resident_Id+"</div><div class="+c1+" style="+s3+">"+ tdata[i].DatesRemained+"</div><div class="+c2+" style="+s3+">"+ tdata[i].Del_Id+"</div><div class="+c2+" style="+s3+">"+ tdata[i].lastDeligated+"</div><div class="+c2+" style="+s3+">"+ tdata[i].maxDate+"</div></div>";	ii++;  i++; } 	}			
			else if (this.id==='fireDrill') {  $scope.fireDrillSummary=tdata; temp=temp+ "<div class=row style='background-color:cyan; align-content:center; margin-left: 7.5%; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px red; border-radius: 5px;'><div class="+c1+" style="+s3+">Sno.</div><div class="+c2+" style="+s3+">Operator Id</div><div class="+c2+" style="+s3+">Days Remainning</div><div class="+c2+" style="+s3+">Last Fire-Drill</div></div>";			
					while (i< tdata.length) { temp=temp+ "<div class=row style='align-content:center; margin-left: 7.5%; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px; border-radius: 5px;'><div class="+c1+" style="+s3+">"+ ii +")</div><div class="+c2+" style="+s3+">"+ tdata[i].licenseNo+"</div><div class="+c2+" style="+s3+">"+ tdata[i].DatesDiff+"</div><div class="+c2+" style="+s3+">"+ tdata[i].maxDate+"</div></div>";	ii++;  i++; } 	}										
			$scope.btnClicked[this.id]=true;  var para = document.createElement("span");  para.id='newPar' + this.id;  para.classList.add("row"); 
			para.innerHTML=temp;
	  	element.appendChild(para); 	     				
	  } 
	  else { var removeChild =document.getElementById ('newPar'+ this.id); removeChild.remove(); $scope.btnClicked[this.id]=false; element.style.backgroundColor = "white";  }
	}	
	
	$scope.tSummary =function () {   							  
	var x=document.getElementById("printBtn");  var myWindow = window.open("", "Print", "width='+screen.width+',height='+screen.height+'"); var today = new Date(); d=(today.getMonth()+1)+ '/'+(today.getDate())+'/'+today.getFullYear();
	if ($scope.nPageC==0) { x.innerHTML='(click to close)'; $scope.nPageC=1; 
		myWindow.document.write(makeSummaryTable()); 
	}
	else  { $scope.nPageC=0; x.innerHTML='(click to print)'; myWindow.close(); } 
	}
	function makeSummaryTable (){  
		var today = new Date(); d=(today.getMonth()+1)+ '/'+(today.getDate())+'/'+today.getFullYear();
		var  s3="'margin: 0px; float: left; font-size:1.1em;  white-space: nowrap;'", c2="'col-xs-2 col-sm-2 col-md-2 col-lg-2'", c1="'col-xs-1 col-sm-1 col-md-1 col-lg-1'", c3="'col-xs-3 col-sm-3 col-md-3 col-lg-3'";	
		var links= "<link rel=stylesheet href='css/bootstrap-responsive.css' media=all type=text/css><link rel=stylesheet href='css/Bootstrap.min.css' media=all type=text/css><link rel='stylesheet' href='css/ui-bootstrap-2.5.0-csp.css' type='text/css'> <link rel='stylesheet' href='css/Printable.css' type='text/css'>";  
		var bodyp='', temp='',tdata='', i=0,ii=1; 
		bodyp=bodyp + "<div class='container page' style='margin-left: 10px; border:solid 1px; font-size:10px;'><div class=row style='margin:0px; width:15cm;'><h3>Summary <i>(Date :"+d+"</i>) </h3><h4>"+$rootScope.logRec[$cookies.get ('licNo')]['Name']+"</h4></div>"; 
			if ($scope.getCurMed.length>0) { i=0,ii=1; tdata= $scope.getCurMed; temp=temp+ "<div class='row' style='margin:0px; border-bottom:solid 1px; border-radius:5px; width:8in'><div style='width:5in; margin: 0px; float: left;'>Resident Medication Information : <i style='color:red'>"+  tdata.length+" record/s </i></div></div><div class=row style='width:8in; background-color:yellow!important; align-content:center; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px red; border-radius: 5px;'><div class="+c1+" style="+s3+">Sno.</div><div class="+c2+" style="+s3+">Resident Id.</div><div class="+c3+" style="+s3+">Med. Name</div><div class="+c2+" style="+s3+">Date Remained</div><div class="+c1+" style="+s3+">Strength</div><div class="+c1+" style="+s3+">Expiration</div><div class="+c1+" style="+s3+">Rx No</div></div>";			
					while (i< tdata.length) { temp=temp+ "<div class=row style='width:8in; align-content:center; margin-left: 2%;  margin-bottom: 0px; border-bottom: solid 1px; border-radius: 5px;'><div class="+c1+" style="+s3+">"+ ii +")</div><div class="+c2+" style="+s3+">"+ tdata[i].resId+"</div><div class="+c3+" style="+s3+">"+ tdata[i].GenName+"</div><div class="+c2+" style="+s3+">"+ tdata[i].DatesRemained+"</div><div class="+c1+" style="+s3+">"+ tdata[i].strength+"</div><div class="+c1+" style="+s3+">"+ tdata[i].expDate+"</div><div class="+c1+" style="+s3+">"+ tdata[i].RxNo+"</div></div>";	 ii++; i++; } 	}			
			if ($scope.expCertified.length>0) { i=0,ii=1; tdata= $scope.expCertified; temp=temp+ "<div class='row' style='margin:0px; border-bottom:solid 1px; border-radius:5px; width:8in'><div style='width:5in; margin: 0px; float: left;'>Staff Documentations information : <i style='color:red'>"+  tdata.length+" record/s </i></div></div><div class=row style='width:8in; background-color:yellow!important; align-content:center; margin: 0px; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px red; border-radius: 5px;'><div class="+c1+" style="+s3+">Sno.</div><div class="+c2+" style="+s3+">Staff Id</div><div class="+c3+" style="+s3+">Course Code</div><div class="+c2+" style="+s3+">Date Remained</div><div class="+c1+" style="+s3+">Expiration</div></div>";			
					while (i< tdata.length) { temp=temp+ "<div class=row style='width:8in; align-content:center; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px; border-radius: 5px;'><div class="+c1+" style="+s3+">"+ ii +")</div><div class="+c2+" style="+s3+">"+ tdata[i].Staff_Id+"</div><div class="+c3+" style="+s3+">"+ tdata[i].Course_Code+"</div><div class="+c2+" style="+s3+">"+ tdata[i].DatesRemained+"</div><div class="+c1+" style="+s3+">"+ tdata[i].CertExDate+"</div></div>";	ii++;  i++; } 	}			
			if ($scope.drApptReminder.length>0) { i=0,ii=1; tdata= $scope.drApptReminder; temp=temp+ "<div class='row' style='margin:0px; border-bottom:solid 1px; border-radius:5px; width:8in'><div style='width:5in; margin: 0px; float: left;'>Resident Dr./Other Appointments : <i style='color:red'>"+  tdata.length+" record/s </i></div></div><div class=row style='width:8in;background-color:yellow!important; align-content:center; margin: 0px; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px red; border-radius: 5px;'><div class="+c1+" style="+s3+">Sno.</div><div class="+c2+" style="+s3+">Resient Id</div><div class="+c2+" style="+s3+">Appt. Date</div><div class="+c2+" style="+s3+">Appt. Time</div><div class="+c1+" style="+s3+">Remaining Days</div></div>";			
					while (i< tdata.length) { temp=temp+ "<div class=row style='width:8in;  align-content:center; margin-left: 2%;margin-bottom: 0px; border-bottom: solid 1px; border-radius: 5px;'><div class="+c1+" style="+s3+">"+ ii +")</div><div class="+c2+" style="+s3+">"+ tdata[i].resId+"</div><div class="+c2+" style="+s3+">"+ tdata[i].AppDate+"</div><div class="+c2+" style="+s3+">"+ tdata[i].AppTime+"</div><div class="+c1+" style="+s3+">"+ tdata[i].DatesRemained+"</div></div>";	ii++;  i++; } 	}			
			if ($scope.expDeligation.length>0) { i=0,ii=1; tdata= $scope.expDeligation; temp=temp+ "<div class='row' style='margin:0px; border-bottom:solid 1px; border-radius:5px; width:8in'><div style='width:5in; margin:0px; float: left;'>Deligation Expiration Check : <i style='color:red'>"+  tdata.length+" record/s </i></div></div><div class=row style='width:8in; background-color:yellow!important; align-content:center; margin: 0px; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px red; border-radius: 5px;'><div class="+c1+" style="+s3+">Sno.</div><div class="+c2+" style="+s3+">Staff Name</div><div class="+c2+" style="+s3+">Resident Id</div><div class="+c1+" style="+s3+">Rem(D)</div><div class="+c2+" style="+s3+">Deligation Task</div><div class="+c2+" style="+s3+">Last Deligated</div><div class="+c2+" style="+s3+">Next Deligation</div></div>";			
					while (i< tdata.length) { temp=temp+ "<div class=row style='width:8in;  align-content:center; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px; border-radius: 5px;'><div class="+c1+" style="+s3+">"+ ii +")</div><div class="+c2+" style="+s3+">"+ tdata[i].Staff_Id+"</div><div class="+c2+" style="+s3+">"+ tdata[i].Resident_Id+"</div><div class="+c1+" style="+s3+">"+ tdata[i].DatesRemained+"</div><div class="+c2+" style="+s3+">"+ tdata[i].Del_Id+"</div><div class="+c2+" style="+s3+">"+ tdata[i].lastDeligated+"</div><div class="+c2+" style="+s3+">"+ tdata[i].maxDate+"</div></div>";	ii++;  i++; } 	}			
			if ($scope.fireDrillSummary.length>0) { i=0,ii=1; tdata= $scope.fireDrillSummary; temp=temp+ "<div class='row' style='margin:0px; border-bottom:solid 1px; border-radius:5px; width:8in'><div style='width:5in; margin: 0px; float: left;'>Firedrill Expiration Info. : <i style='color:red'>"+  tdata.length+" record/s </i></div></div><div class=row style='width:8in; background-color:yellow!important; align-content:center; margin: 0px; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px red; border-radius: 5px;'><div class="+c1+" style="+s3+">Sno.</div><div class="+c2+" style="+s3+">Operator Id</div><div class="+c2+" style="+s3+">Days Remainning</div><div class="+c2+" style="+s3+">Last Fire-Drill</div></div>";			
					while (i< tdata.length) { temp=temp+ "<div class=row style='width:8in;  align-content:center; margin-left: 2%;  margin-bottom: 0px; border-bottom: solid 1px; border-radius: 5px;'><div class="+c1+" style="+s3+">"+ ii +")</div><div class="+c2+" style="+s3+">"+ tdata[i].licenseNo+"</div><div class="+c2+" style="+s3+">"+ tdata[i].DatesDiff+"</div><div class="+c2+" style="+s3+">"+ tdata[i].maxDate+"</div></div>";	ii++;  i++; } 	}			
		bodyp=bodyp + temp+ '</div>';  
		return (links+bodyp); 
	}
	function initialScope (key, k) { if (key==='getCurren') $scope.getCurMed=  $scope.docSummary[k][key]; else if (key==='expCertif')   $scope.expCertified = $scope.docSummary[k][key]; else if (key==='drapptRem')   $scope.drApptReminder = $scope.docSummary[k][key]; else if (key==='deligatio')   $scope.expDeligation = $scope.docSummary[k][key]; else if (key==='fireDrill')	  $scope.fireDrillSummary = $scope.docSummary[k][key]; }
	function sendStEmail () { var obj = {}; obj[0]= {'postName':'oPSummary'}, obj[1]=$scope.docSummary; obj[2]=$scope.docSummary[0]['expCertif'].map(item => item.Staff_Id).filter((value, index, self) => self.indexOf(value) === index); sendEmail (obj);
	}
	function sendEmail (obj) {  //obj= JSON.parse(obj); 
	$http.post("pages/Email.php", obj  ,  { headers: {'Content-Type': 'application/x-www-form-urlencoded'} }) .then (function(response) {   });
	}
});  

app.controller ('SummaryCtrl',  function ($scope, $http, $rootScope, $cookies, $window) {   
	if ($cookies.get('logStatus')==='true')  {  $rootScope.logStrue();  } else if ($cookies.get('logStatus')==='false')  { $rootScope.logSfalse();  }
	$scope.licenseNo =$rootScope.logRec[$cookies.get ('licNo')]['licenseNo'];
	var tdata= $rootScope.logRec[$cookies.get ('licNo')];  var fName= tdata['OpFName'], mName= tdata['OpMName'], LName= tdata['OpLName']; 
	var myObj1={"Task":"Progress_Note", "Table":"resident", "pK":"ResId"}, myObj2={"Task":"Physician_Order","Table":"resident", "pK":"ResId"}, myObj3={"Task":"Medicine_Administration","Table":"resident", "pK":"ResId"},  myObj4={"Task":"Disposed","Table":"resident", "pK":"ResId"},  myObj5={"Task":"Presentation","Table":"resident", "pK":"ResId"}, myObj6={"Task":"Rev-Exp Category","Table":"revexpcategory", "pK":"RevExpcatId"}; 
	var arrJson=[];  arrJson.push(myObj1); arrJson.push(myObj2); arrJson.push(myObj3); arrJson.push(myObj4); arrJson.push(myObj5); arrJson.push(myObj6);//arrJson[0]=myObj1; arrJson[1]=myObj2; arrJson[2]=myObj3;	
	$scope.Tasks=arrJson;  var x=document.getElementById("printBtn").disabled=true;
	$scope.initData= function () { $scope.searchReport=''; $scope.disposed=''; $scope.searchRecords=''; $scope.PhyOrderRec=''; var x=document.getElementById("printBtn").disabled=true; document.getElementById("display").innerHTML=''; }
	$scope.onSelectionReports = function () { var x=document.getElementById("ctrlMed"); x.innerHTML=''; $scope.initData(); $scope.nPageC=0;   if ($scope.selected.Task=='Rev-Exp Category')  $scope.revexpcategory();  else if ($scope.selected.Task=='Presentation')  $scope.presentation(); else $scope.getSearchData(); }
	$scope.searchList = function () { var arrColumnList=[];  for (var k in $scope.searchRecords) { arrColumnList[k] = new Array(); arrColumnList[k].push([$scope.searchRecords[k][$scope.selected.pK]]); arrColumnList[k].push([$scope.searchRecords[k][1]]); arrColumnList[k].push([$scope.searchRecords[k][2]]); arrColumnList[k].push([$scope.searchRecords[k][3]]);  }  return arrColumnList; }  //alert($scope.refColumnList[k][1]);
	$scope.typeaheadOnSelectsearch = function (selectedtd, index) { var x=document.getElementById("ctrlMed");   var searchValue=selectedtd[0].toString();  var index = $scope.searchRecords.findIndex(obj => obj[$scope.selected.pK]==searchValue);  $scope.searchReport= $scope.searchRecords[index][$scope.selected.pK]; $scope.fullName= $scope.searchRecords[index][1] + ' ' + $scope.searchRecords[index][3]; 
	if ($scope.selected.Task=='Physician_Order')   {  $scope.getPhyOrderRec();  $scope.nPageC=0;   }	 
	else if ($scope.selected.Task=='Disposed')   {  x.innerHTML='<label>Control Med: </label><input type=checkBox  id=MedChkId class=form-control name=MedChk ng-model=MedChk>'; var y=document.getElementById('MedChkId'); y.checked=true; $scope.chked=1; y.onclick = $scope.MedFunc;  $scope.getDisposed();  $scope.nPageC=0;  }	
	}		
	function cssSignature(t,r) {  var s1="'margin:0px; position: absolute; padding: 0px; top: "+ t +"px; right: "+r+"px;'";	return ("<div style="+s1+"><img src='img/renewal/Tseli_Signature.jpg' style='width:120px; height:25px;'>&nbsp;</div>");  }
	$scope.MedFunc = function () {  $scope.chked = document.getElementById(this.id).checked===true ? 1 : 0;   }
	$scope.getSearchData = function () { $scope.rootP=$cookies.get('rootP'); $scope.dbName=$cookies.get('dbName');  var arrRecJson={}; var temp, sNo=0; 	var data= {'getName':'fetch_Record',  'dbName': $scope.dbName, 'root_P':$scope.rootP, 'licenseNo': $scope.licenseNo, 't_Name':$scope.selected.Table };  var config= {params: data, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) .then (function(response) {  $scope.searchRecords= response.data;  })  , function (response) { alert ("failed to show"); };  }
	$scope.getPhyOrderRec = function () { var arrRecJson={}; var temp, sNo=0; 	var data= {'getName':'PhyOrderRec', 'dbName': $scope.dbName, 'root_P':$scope.rootP, 'ResId': $scope.searchReport};  var config= {params: data, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) .then (function(response) { if (response.data.length>0) {  $scope.PhyOrderRec = response.data;  $scope.displayPrescription(); var x=document.getElementById("printBtn"); x.disabled=false; x.onclick= $scope.Physician_Order_Preview;} $scope.$digest(); })  , function (response) { alert ("failed to show"); };  }
	$scope.getDisposed = function () { var arrRecJson={}; var temp, sNo=0; 	var data= {'getName':'disposed', 'dbName': $scope.dbName, 'root_P':$scope.rootP, 'ResId': $scope.searchReport};  var config= {params: data, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) .then (function(response) { $scope.disposed = response.data; $scope.displayDisposed(); var x=document.getElementById("printBtn"); x.disabled=true; if ($scope.disposed[$scope.disposed.length-1].length>0) { x.disabled=false; x.onclick= $scope.disposedMedPreview; } $scope.$digest(); })  , function (response) { alert ("failed to show"); };  }
	$scope.displayDisposed = function () {$scope.btnClicked={}; var  s3="'margin: auto; float: left;'", c1="'col-xs-2 col-sm-2 col-md-2 col-lg-2'", c2="'col-xs-1 col-sm-1 col-md-1 col-lg-1'", c3="'col-xs-3 col-sm-3 col-md-3 col-lg-3'";
	var i=0,j=0; x=document.getElementById("display"), temp="<div class='row' style='width:90%; background-color:gray; border-radius:5px; margin-left:0px;'><div class="+ c1+" style="+ s3+">&nbsp; S.No.</div><div class="+ c3+" style="+ s3+">Medication Name</div><div class="+ c2+" style="+ s3+">Controlled</div></div>"; 
		while (i< $scope.disposed.length-1) { 
		j=i+1; temp= temp+ "<div id='"+$scope.disposed[i]['MedId']+"' class='row' style='margin:0px; border-bottom:solid 1px; border-radius:5px; width:90%'><div class="+ c1+" style="+ s3+">"+ j +".</div><div  class="+ c3+"  style="+ s3+"><b>"+ $scope.disposed[i]['GenericName']+ "</b></div><div  class="+ c2+"  style="+ s3+">"+ ($scope.disposed[i]['Control']==1?'YES': 'NO') +" </div></div>";   		
		 x.innerHTML=temp; 	$scope.btnClicked[$scope.disposed[i]['MedId']]= false;
		i++; 
		} for (var i=0 ; i<$scope.disposed.length-1; i++) {  var y=document.getElementById($scope.disposed[i]['MedId']); y.onclick = $scope.disMedDetail; }
	}
	$scope.disMedDetail = function () {  var temp='', element = document.getElementById(this.id); 	var  s3="'margin: 0px; float: left; font-size:0.8em;  white-space: nowrap;'", c2="'col-xs-2 col-sm-2 col-md-2 col-lg-2'", c1="'col-xs-1 col-sm-1 col-md-1 col-lg-1'", c3="'col-xs-3 col-sm-3 col-md-3 col-lg-3'";
	 if ($scope.btnClicked[this.id]==false) 
	 		{ 
				var tempData= $scope.disposed[$scope.disposed.length-1]; var filtered = tempData.filter(x => x.MedId == this.id),i=0,ii=1;  //alert (filtered[0].RxNo);
			  temp=temp+ "<div class=row style='background-color:cyan; align-content:center; margin-left: 7.5%; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px red; border-radius: 5px;'><div class="+c1+" style="+s3+">SNo.</div><div class="+c2+" style="+s3+">Rx No.</div><div class="+c3+" style="+s3+">Reason</div><div class="+c2+" style="+s3+">Ex. Date</div><div class="+c2+" style="+s3+">Dis. Date</div><div class="+c1+" style="+s3+">Quantity</div></div>";			
					while (i< filtered.length) { 
					temp=temp+ "<div class=row style='backgroundColor:yellow; align-content:center; margin-left: 7.5%; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px red; border-radius: 5px;'><div class="+c1+" style="+s3+">"+ ii +")</div><div class="+c2+" style="+s3+">"+ filtered[i].RxNo+"</div><div class="+c3+" style="+s3+">"+ filtered[i].Reason+"</div><div class="+c2+" style="+s3+">"+ filtered[i].MedExpDate+"</div><div class="+c2+" style="+s3+">"+ filtered[i].DispDate+"</div><div class="+c1+" style="+s3+">"+ filtered[i].noDisposed+"</div></div>";			
					i++; ii++;
					}			
			$scope.btnClicked[this.id]=true;  var para = document.createElement("span");  para.id='newPar' + this.id;  para.classList.add("row"); 
			para.innerHTML=temp;
	  	element.appendChild(para); 	     				
	  } 
	  else { var removeChild =document.getElementById ('newPar'+ this.id); removeChild.remove(); $scope.btnClicked[this.id]=false; element.style.backgroundColor = "white";  }
	}
	$scope.disposedMedPreview = function () { var x=document.getElementById("printBtn"), myWindow = window.open("", "Print", "width='+screen.width+',height='+screen.height+'");  
	if ($scope.nPageC==0)  
	{  $scope.nPageC=1; x.innerHTML="Close";  var links= "<script type='text/javascript' src='js/jquery.min.js'></script><link rel=stylesheet href='css/bootstrap-responsive.css' media=all type=text/css><link rel=stylesheet href='css/Bootstrap.min.css' media=all type=text/css><link rel='stylesheet' href='css/ui-bootstrap-2.5.0-csp.css' type='text/css'> <link rel='stylesheet' href='css/printable.css' type='text/css'>";  
		var  s3="'float: left; border-right: solid 1px; border-left:solid 1px; border-bottom:solid 1px; width: 19cm; height: 0.8cm; border-radius:5px;'", s4="'margin:0px; float:left; border-bottom:solid 1px; border-top:solid 1px; border-right:solid 1px;  width:19cm;'",  s42="'float:left; margin:0px; border-left:solid 1px; border-right:solid 1px; border-top:solid 1px;border-radius:2px; width:6.323cm;'", s43="'float:left; margin:0px; border-left:solid 1px; border-right:solid 1px; border-top:solid 1px;border-radius:2px; width:9.475cm;'",  s44="'float:left; margin:0px; border-left:solid 1px; border-right:solid 1px; border-top:solid 1px;border-radius:2px; width:12.65cm;'"; var s10="'margin:0px; color:red; text-align: left; font-weight: normal; font-family: Helvetica, Arial, sans-serif; font-size:12px'"; s9="'width=19cm; margin:10px; float: left;  height: 50px; text-align: left; font-family: Helvetica, sans-serif; font-size:24px; '";
		var p=0, phyOrder='',i=0,ii=1, bodyp='', page='', tR=$scope.disposed[$scope.disposed.length-1].filter(x => x.Control == $scope.chked), cont='', footer='', header='',CommentPage='';  
		var resinfo="<div style="+s4+"><p style="+s9+">"+$rootScope.logRec[$cookies.get ('licNo')]['Name']+"</p></div><div style="+s4+"><p style="+s9+">Individual Medication Disposal Form</p></div><div style="+s4+"><p style='margin:10px; float: left; font-size:24px;'>Resident Name: <u><i>"+ $scope.fullName+ "</i></u></p></div>";
		cont=cont + "<div class='container page' style='margin: -25px;'>";   
		header=header + "<div class=row style='width:19cm;border:solid 1px;'><div style=''>"+resinfo+"</div></div>";
		footer=footer + "<div class=row style='width:19cm; margin-top:20px;'></div>";	
	if ($scope.chked===1) {
		while (i< tR.length) { var da1= new Date (tR[i]['DispDate']); da1.setDate(da1.getDate()+1); maxd1=(da1.getMonth()+1)+ '/'+(da1.getDate())+'/'+da1.getFullYear(); var da2= new Date(tR[i]['StDate']); da2.setDate(da2.getDate()+1); maxd2=(da2.getMonth()+1)+ '/'+(da2.getDate())+'/'+da2.getFullYear();
			bodyp=bodyp + "<div class=row style='margin-top:20px; width=19cm; border-left:solid 1px;'><div style="+s4+"> &nbsp;<b>Date of Disposal:</b> &nbsp;<i style="+s10+">"+ maxd1+"</i></div><div style="+s4+"> &nbsp;<b>Medication:</b> &nbsp;<i style="+s10+">"+ tR[i]['GenericName']+"</i></div><div style="+s4+"> &nbsp;<b>Strength:</b> &nbsp;<i style="+s10+">"+ tR[i]['Strength']+"</i></div><div style="+s4+"> &nbsp;<b>Number of Pills/Amount Disposed: </b>&nbsp;<i style="+s10+">"+ tR[i]['noDisposed']+"</i></div><div style="+s4+"> &nbsp;<b>Reason:</b> &nbsp;<i style="+s10+">"+ tR[i]['Reason']+"</i></div>"; 
		bodyp=bodyp + "<div style="+s4+"> &nbsp;<b>Rx Number:</b> &nbsp;<i style="+s10+">"+ tR[i]['RxNo']+"</i></div><div style="+s4+"> &nbsp;<b>Date Last Filled:</b> &nbsp;<i style="+s10+">"+ maxd2+"</i></div><div style="+s4+"> &nbsp;<b>Disposed Procedure:</b> &nbsp;<i style="+s10+">"+ tR[i]['DispPro'] +"</i></div><div style="+s4+"> &nbsp;<b>Name of Witness #1:</b> &nbsp;</div><div style="+s4+"> &nbsp;<b>Signature of Witness #1: &nbsp; &nbsp;</div><div style="+s4+"> &nbsp;<b>Name of Witness #2:</b> &nbsp;<i style="+s10+">"+ '' +"</i></div><div style="+s4+"> &nbsp;<b>Signature of Witness #2: </b> &nbsp;</div></div>"; 
		if ((ii%2!==0)&&(ii<tR.length)) 	page=page+ cont + header + bodyp;  else if ((ii%2!==0)&&(ii===tR.length)) page=page + cont + header + bodyp +  "<div class=row style='margin-top:20%;'>&nbsp;</div>" + footer + "</div>";
		else if ((ii%2===0)&&(ii<=tR.length)) page= page + bodyp + footer + "</div>"; 
		i++; ii++;  bodyp='';} }
	else {   
		while (i< tR.length) { var da1= new Date (tR[i]['DispDate']); da1.setDate(da1.getDate()+1); maxd1=(da1.getMonth()+1)+ '/'+(da1.getDate())+'/'+da1.getFullYear(); var da2= new Date(tR[i]['StDate']); da2.setDate(da2.getDate()+1); maxd2=(da2.getMonth()+1)+ '/'+(da2.getDate())+'/'+da2.getFullYear();
			bodyp=bodyp + "<div class=row style='margin-top:1px; border-left:solid 1px; width:19cm;'><div style="+s42+"> &nbsp;<b>Medication:</b> &nbsp;<i style="+s10+">"+ tR[i]['GenericName']+"</i></div><div style="+s42+"> &nbsp;<b>Strength:</b> &nbsp;<i style="+s10+">"+ tR[i]['Strength']+"</i></div><div style="+s42+"> &nbsp;<b>Rx #:</b> &nbsp;<i style="+s10+">"+ tR[i]['RxNo']+"</i></div>"; 
			bodyp=bodyp + "<div style="+s42+"> &nbsp;<b>Amount Disposed: </b>&nbsp;<i style="+s10+">"+ tR[i]['noDisposed']+"</i></div><div style="+s42+"> &nbsp;<b>Disposed On:</b> &nbsp;<i style="+s10+">"+ maxd1+"</i></div><div style="+s42+">&nbsp;<b>Last Filled:</b><i style="+s10+">"+ maxd2+"</i></div>"; 
			bodyp=bodyp + "<div style="+s4+"> &nbsp;<b>Disposed Procedure:</b> &nbsp;<i style="+s10+">"+ tR[i]['DispPro'] +"</i></div>";
			bodyp=bodyp + "<div style="+s42+"> &nbsp;<b>Reason:</b> &nbsp;<i style="+s10+">"+ tR[i]['Reason']+"</i></div><div style="+s42+"> <i style="+s10+">Full Name:</i></div><div style="+s42+">&nbsp;<b>Signature: </div></div>"; 
			if (ii===1 && ii<= tR.length)  { page=page+ cont + header + bodyp;  }
			else if (ii%13!==0 && ii<tR.length) page=page+ bodyp; 
			else if (ii%13===0 && ii<tR.length)  { page=page+ bodyp + footer + "</div>" + cont + header;   bodyp=''; }  
			else if (ii===tR.length)   page=page+ bodyp + "<div class=row style='width:19cm; margin-bottom: 10px;'>"+ footer+"</div></div>"; 
			++i; ++ii;  bodyp=''; } }
	myWindow.document.write(links + page); bodyp='';
	}
	else { $scope.nPageC=0; myWindow.close(); x.innerHTML="View"; }			
	}
	$scope.Physician_Order_Preview = function () { var x=document.getElementById("printBtn"), myWindow = window.open("", "Print", "width='+screen.width+',height='+screen.height+'");  
	if ($scope.nPageC==0)  
	{  $scope.nPageC=1; x.innerHTML="Close";  var links= "<script type='text/javascript' src='js/jquery.min.js'></script><link rel=stylesheet href='css/bootstrap-responsive.css' media=all type=text/css><link rel=stylesheet href='css/Bootstrap.min.css' media=all type=text/css><link rel='stylesheet' href='css/ui-bootstrap-2.5.0-csp.css' type='text/css'> <link rel='stylesheet' href='css/PrintableLandscape.css' type='text/css'>";  var s1="'margin-left:10px; float: left; border: solid 1px; width: 49.5%; border-radius:5px;'"; s2="'float: right; border: solid 1px; width: 49.4%; border-radius:5px;'"; 
		var  s3="'margin:0px; float: left; border-right: solid 1px; border-left:solid 1px; border-bottom:solid 1px; width: 16.92%; height: 0.8cm; border-radius:5px;'" , s4="' height: 0.8cm; margin:0px; float: left; border-right: solid 1px; border-bottom:solid 1px; width: 7.25%; border-radius:5px;'", s42="'height: 0.8cm; margin:0px; float: left; border-right: solid 1px; border-bottom:solid 1px; width: 6.6%; border-radius:5px;'", s5="'height: 0.8cm; margin:0px; float: left; border-right: solid 1px; border-bottom:solid 1px; width: 13.2%; border-radius:5px;'", s6="'height: 0.8cm; margin:0px; float: left; border-right: solid 1px; border-bottom:solid 1px; width: 9%; border-radius:5px;'", s7="' height: 0.8cm; margin:0px; float: left; border-right: solid 1px; border-bottom:solid 1px; width: 7.81%; border-radius:5px;'", s8="'height: 0.8cm; margin:0px; float: left; border-right: solid 1px; border-bottom:solid 1px; width: 9.95%; border-radius:5px;'", s9="'height: 0.8cm; margin:0px; border-right: solid 1px; border-bottom:solid 1px; float: left;  width: 5%; border-radius:5px;'"; var s10="'margin:0px; color:red; text-align: left; font-weight: normal; font-family: Helvetica, Arial, sans-serif; font-size:11px'";
		var p=0, phyOrder='', bodyp='', cont='', footer='', header='',CommentPage='';  // da= new Date($scope.weeklyMenuSummary[0][0]['maxDate']), maxd=(da.getMonth()+1)+ '/'+(da.getDate()+1)+'/'+da.getFullYear();
		cont=cont + "<div class='container page' style='margin: 0px;'>";  
		header=header + "<div class=row style='width:27cm;'><div style=''><img src=img/pict/PhyOrdHd1.jpg style='width:26cm;'></div></div>";
		header=header + "<div class=row style='width:25.5cm;'><div style="+s1+">&nbsp;&nbsp;Resident's Name:  <br>&nbsp;&nbsp;<i style="+s10+">"+ $scope.fullName + "</i></div> <div style="+s2+">&nbsp;&nbsp;GH/AFH Provider Name: <br>&nbsp;&nbsp;<i style="+s10+">"+ tdata['Name']+  "</i></div> </div>";
		header=header + "<div class=row style='width:25.5cm;'><div style="+s1+">&nbsp;&nbsp;Today's Date: <br>&nbsp;</div> <div style="+s2+">&nbsp;&nbsp;Address: <br>&nbsp;&nbsp;<i style="+s10+">"+tdata['Address']+"</i></div> </div>";
		header=header + "<div class=row style='width:25.5cm;'><div style="+s1+">&nbsp;&nbsp;GH/AFH Provider Phone Number: <br> &nbsp;&nbsp; <i style="+s10+">"+tdata['HomePhone']+ "/" + tdata['CellPhone'] +"</i></div> <div style="+s2+">&nbsp;&nbsp; GH/AFH Provider Fax Number: <br> &nbsp;&nbsp;<i style="+s10+">"+tdata['HomePhone']+"</i></div> </div>";
		header=header + "<div class=row style='width:27cm;'><div style=''><img src=img/pict/PhyOrdHd2.jpg style='width:26cm;'></div></div>";
		title="<div class=row style='width:27cm;'><div style='margin:0px;'><img src=img/pict/PhyOrdTitle.jpg style='width:26cm;'></div></div>";
		footer=footer + "<div class=row style='width:27cm; margin:0px;'><div style=''><img src=img/pict/PhyOrdFt2.jpg style='width:26cm; margin:0px;'></div></div>";	
		CommentPage= "<div class=row style='width:27cm;'><div style='margin:0px;'><img src=img/pict/PhyOrdComment.jpg style='width:26cm; height:80%; margin:0px;'></div></div>";	
		if ($scope.PhyOrderRec.length-1>=12) 
				{  var i=0; while (i<=12) 
					{ 
					bodyp=bodyp + "<div class=row style='width:27cm; '><div style="+s3+">&nbsp;<i style="+s10+">"+ $scope.PhyOrderRec[i]['GenericName']+"</i></div><div style="+s4+">&nbsp;<i style="+s10+">"+ $scope.PhyOrderRec[i]['strength']+"</i></div><div style="+s42+">&nbsp;<i style="+s10+">"+ $scope.PhyOrderRec[i]['Amt'] +"</i></div><div style="+s42+">&nbsp;<i style="+s10+">"+ $scope.PhyOrderRec[i]['Time'] +"</i></div><div style="+s42+">&nbsp;<i style="+s10+">"+ ($scope.PhyOrderRec[i]['PRN']==1?'YES': 'NO') +"</i></div><div style="+s5+">&nbsp;</div><div style="+s6+">&nbsp;</div><div style="+s7+">&nbsp;</div><div style="+s4+">&nbsp;</div><div style="+s8+">&nbsp;</div><div style="+s9+">&nbsp;</div></div>"; i++; 
					} 	
					phyOrder=cont + header + bodyp + footer + "</div>"; bodyp='';
					while (i<$scope.PhyOrderRec.length-1) 
					{ 
					bodyp= bodyp + "<div class=row style='width:27cm;'><div style="+s3+">&nbsp;<i style="+s10+">"+ $scope.PhyOrderRec[i]['GenericName']+"</i></div><div style="+s4+">&nbsp;<i style="+s10+">"+ $scope.PhyOrderRec[i]['strength']+"</i></div><div style="+s42+">&nbsp;<i style="+s10+">"+ $scope.PhyOrderRec[i]['Amt'] +"</i></div><div style="+s42+">&nbsp;<i style="+s10+">"+ $scope.PhyOrderRec[i]['Time'] +"</i></div><div style="+s42+">&nbsp;<i style="+s10+">"+ ($scope.PhyOrderRec[i]['PRN']==1?'YES': 'NO') +"</i></div><div style="+s5+">&nbsp;</div><div style="+s6+">&nbsp;</div><div style="+s7+">&nbsp;</div><div style="+s4+">&nbsp;</div><div style="+s8+">&nbsp;</div><div style="+s9+">&nbsp;</div></div>"; i++;  
					} //phyOrder=phyOrder + cont + title + bodyp + footer + "</div>";	
					if ($scope.PhyOrderRec.length-1<30) while (i< 30)  { bodyp= bodyp + "<div class=row style='width:27cm; '><div style="+s3+">&nbsp;</div><div style="+s4+">&nbsp;</i></div><div style="+s42+">&nbsp;</i></div><div style="+s42+">&nbsp;</div><div style="+s42+">&nbsp;</div><div style="+s5+">&nbsp;</div><div style="+s6+">&nbsp;</div><div style="+s7+">&nbsp;</div><div style="+s4+">&nbsp;</div><div style="+s8+">&nbsp;</div><div style="+s9+">&nbsp;</div></div>"; i++;  } phyOrder=phyOrder + cont + title + bodyp + footer + "</div>";  	

				}	
			// This code should work for medication less than 12
			else if ($scope.PhyOrderRec.length-1<=12) 
			{  
			var i=0; while (i<$scope.PhyOrderRec.length-1) 
				{ 
				bodyp=bodyp + "<div class=row style='width:27cm; '><div style="+s3+">&nbsp;<i style="+s10+">"+ $scope.PhyOrderRec[i]['GenericName']+"</i></div><div style="+s4+">&nbsp;<i style="+s10+">"+ $scope.PhyOrderRec[i]['strength']+"</i></div><div style="+s42+">&nbsp;<i style="+s10+">"+ $scope.PhyOrderRec[i]['Amt'] +"</i></div><div style="+s42+">&nbsp;<i style="+s10+">"+ $scope.PhyOrderRec[i]['Time'] +"</i></div><div style="+s42+">&nbsp;<i style="+s10+">"+ ($scope.PhyOrderRec[i]['PRN']==1?'YES': 'NO') +"</i></div><div style="+s5+">&nbsp;</div><div style="+s6+">&nbsp;</div><div style="+s7+">&nbsp;</div><div style="+s4+">&nbsp;</div><div style="+s8+">&nbsp;</div><div style="+s9+">&nbsp;</div></div>"; i++; 
				} 	
					 while (i< 12)  { bodyp= bodyp + "<div class=row style='width:27cm; '><div style="+s3+">&nbsp;</div><div style="+s4+">&nbsp;</i></div><div style="+s42+">&nbsp;</i></div><div style="+s42+">&nbsp;</div><div style="+s42+">&nbsp;</div><div style="+s5+">&nbsp;</div><div style="+s6+">&nbsp;</div><div style="+s7+">&nbsp;</div><div style="+s4+">&nbsp;</div><div style="+s8+">&nbsp;</div><div style="+s9+">&nbsp;</div></div>"; i++;  }  phyOrder=cont + header + bodyp + footer + "</div>"; bodyp=''; //phyOrder=phyOrder + cont + title + bodyp + footer + "</div>";  	
			}	
	myWindow.document.write(links+phyOrder + cont + CommentPage + "</div>");
	}
	else { $scope.nPageC=0; myWindow.close(); x.innerHTML="View"; }			
	}
	$scope.displayPrescription = function () {   $scope.btnClicked={}; var  s3="'margin: 0px; float: left; font-size:0.8em;  white-space: nowrap;'", c1="'col-xs-2 col-sm-2 col-md-2 col-lg-2'", c2="'col-xs-1 col-sm-1 col-md-1 col-lg-1'", c3="'col-xs-3 col-sm-3 col-md-3 col-lg-3'";
	var i=0,j=0; x=document.getElementById("display"), temp="<div class='row' style='background-color:cyan; border-radius:5px; margin-left:0px;'><div class="+ c2+" style="+ s3+">&nbsp; S.No.</div><div class="+ c3+" style="+ s3+">Medication Name</div><div class="+ c1+" style="+ s3+">Strength</div><div class="+ c1+" style="+ s3+">Amount</div><div class="+ c1+" style="+ s3+">Times(s)</div><div class="+ c2+" style="+ s3+">PRN</div><div class="+ c2+" style="+ s3+">E.Bag</div></div>"; 
		while (i< $scope.PhyOrderRec.length-1) {
		var tempData= $scope.PhyOrderRec[$scope.PhyOrderRec.length-1]; var filEB = tempData.filter(x => x.MedId == $scope.PhyOrderRec[i]['MedId'] && x.Location=='Emergency Bag' ); 
		j=i+1; temp= temp+ "<div id='"+$scope.PhyOrderRec[i]['MedId']+"' class='row' style='margin:0px; border-bottom:solid 1px; border-radius:5px;'><div class="+ c2+" style="+ s3+">"+ j +".</div><div  class="+ c3+"  style="+ s3+"><b>"+ $scope.PhyOrderRec[i]['GenericName']+ "</b></div><div  class="+ c1+"  style="+ s3+">" +$scope.PhyOrderRec[i]['strength']+"</div><div  class="+ c1+"  style="+ s3+">"+$scope.PhyOrderRec[i]['Amt'] +"</div><div  class="+ c1+"  style="+ s3+">"+ $scope.PhyOrderRec[i]['Time'] +" </div><div  class="+ c2+"  style="+ s3+">" +  ($scope.PhyOrderRec[i]['PRN']==1?'Yes': 'No')+"</div><div  class="+ c2+"  style="+ s3+">" +  (filEB.length>0?'Yes': '<i style=color:red;>No</i>')+"</div></div>";   		
		 x.innerHTML=temp; 	$scope.btnClicked[$scope.PhyOrderRec[i]['MedId']]= false;
		i++; 
		} for (var i=0 ; i<$scope.PhyOrderRec.length-1; i++) {  var y=document.getElementById($scope.PhyOrderRec[i]['MedId']); y.onclick = $scope.MedDetail; }
	}
	$scope.MedDetail = function () {  var temp='', i=0,ii=1, element = document.getElementById(this.id); 
	var  s3="'margin: 0px; float: left; font-size:0.8em;  white-space: nowrap;'", c2="'col-xs-2 col-sm-2 col-md-2 col-lg-2'", c1="'col-xs-1 col-sm-1 col-md-1 col-lg-1'", c3="'col-xs-3 col-sm-3 col-md-3 col-lg-3'";
	 if ($scope.btnClicked[this.id]==false) 
	 		{ var tempData= $scope.PhyOrderRec[$scope.PhyOrderRec.length-1]; var filtered = tempData.filter(x => x.MedId == this.id);   
				temp=temp+ "<div class=row style='background-color:cyan; align-content:center; margin-left: 7.5%; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px red; border-radius: 5px;'><div class="+c1+" style="+s3+">SNo.</div><div class="+c3+" style="+s3+">Rx No.</div><div class="+c2+" style="+s3+">Location</div><div class="+c2+" style="+s3+">St. Date</div><div class="+c2+" style="+s3+">Ex. Date</div><div class="+c2+" style="+s3+">Quantity</div></div>";			
					while (i< filtered.length) { 
					temp=temp+ "<div class=row style='backgroundColor:yellow; align-content:center; margin-left: 7.5%; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px red; border-radius: 5px;'><div class="+c1+" style="+s3+">"+ ii +")</div><div class="+c3+" style="+s3+">"+ filtered[i].RxNo+"</div><div class="+c2+" style="+s3+">"+ filtered[i].Location+"</div><div class="+c2+" style="+s3+">"+ filtered[i].StDate+"</div><div class="+c2+" style="+s3+">"+ filtered[i].MedExpDate+"</div><div class="+c2+" style="+s3+">"+ filtered[i].MedQnt+"</div></div>";			
					i++; ii++;
					}
			 $scope.btnClicked[this.id]=true;  var para = document.createElement("span");  para.id='newPar' + this.id;  para.classList.add("row"); 
			para.innerHTML=temp; 
	  	element.appendChild(para); 	     
	  } 
	  		else { var removeChild =document.getElementById ('newPar'+ this.id); removeChild.remove(); $scope.btnClicked[this.id]=false; element.style.backgroundColor = "white";  }
	} 
	 $scope.presentation = function () { 
		var myWindow = window.open("", "Print", "width='+screen.width+',height='+screen.height+'");  var page='';
		var links= "<link rel=stylesheet href='css/bootstrap-responsive.css' media=all type=text/css><link rel=stylesheet href='css/Bootstrap.min.css' media=all type=text/css><link rel='stylesheet' href='css/ui-bootstrap-2.5.0-csp.css' type='text/css'> <link rel='stylesheet' href='css/printable.css' type='text/css'>";  
		var backIm="background-image: url(img/renewal/developedBy.jpg)!important; background-repeat: repeat round";
		var str, end, da, bodyp='';  da= new Date(), da.setDate(da.getDate()) ,d=(da.getMonth()+1)+ '/'+(da.getDate())+'/'+da.getFullYear(); 
		bodyp=bodyp + "<div class='container page' style='margin:0px;'><div class=row style='margin:-25px; position: relative;'><div class=row style='margin:-25px; position: relative;'><img src='img/presentation/1. Home.jpg' style='width:8.5in;'><div class=row style='margin:-25px; position: relative;'><img src='img/presentation/2. login.jpg' style='width:8.5in;'></div></div>";  		//"+ (cssSetting(t-155,r+200,w, CPR)) + "
		bodyp=bodyp + "<div class='container page' style='margin:0px;'><div class=row style='margin:-25px; position: relative;'><img src='img/presentation/3. Logged In Summary.jpg' style='width:8.5in;'></div><div class=row style='margin:-25px; position: relative;'><img src='img/presentation/4. Data_Entry.jpg' style='width:8.5in;'></div></div>";  	 
		bodyp=bodyp + "<div class='container page' style='margin:0px;'><div class=row style='margin:-25px; position: relative;'><img src='img/presentation/5. Summary_phyRep.jpg' style='width:8.5in;'></div><div class=row style='margin:-25px; position: relative;'><img src='img/presentation/6. Disposal.jpg' style='width:8.5in;'></div></div>";  	 
		bodyp=bodyp + "<div class='container page' style='margin:0px;'><div class=row style='margin:-25px; position: relative;'><img src='img/presentation/7. Resident_finance.jpg' style='width:8.5in;'></div><div class=row style='margin:-25px; position: relative;'><img src='img/presentation/8. Resident_progress_Note.jpg' style='width:8.5in;'></div></div>";  	 		
		// Signature Part bodyp=bodyp + "<div class='container page' style='margin:0px;'><div class=row style='margin:-25px; position: relative;'><img src='img/presentation/ISP_Emily.jpg' style='width:8.5in; margin-top:50px; ; -webkit-transform: scale(1.15); transform: scale(1.15)'>"+cssSignature(267,320)+"</div></div>";  	 		
		myWindow.document.write(links+ bodyp);
	}
	$scope.revexpcategory = function () { 
	$scope.rootP=$cookies.get('rootP'); 
	$scope.dbName=$cookies.get('dbName');  
	var arrRecJson={}; var temp, sNo=0; 	
	var data= {'getName':'getrevexpcategory', 'dbName': $scope.dbName, 'root_P':$scope.rootP };  
	var config= {params: data, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) .then (function(response) {  $scope.revexpcatData = response.data;  $scope.revexpcatList(); })  , function (response) { alert ("failed to show"); }; 
	}
	$scope.revexpcatList = function () { 
		$scope.btnClicked={}; var  s3="'margin: 0px; float: left; font-size:1.0em;  white-space: nowrap;'", c2="'col-xs-2 col-sm-2 col-md-2 col-lg-2'", c1="'col-xs-1 col-sm-1 col-md-1 col-lg-1'", c3="'col-xs-3 col-sm-3 col-md-3 col-lg-3'", c4="'col-xs-4 col-sm-4 col-md-4 col-lg-4'", c5="'col-xs-5 col-sm-5 col-md-5 col-lg-5'", c6="'col-xs-6 col-sm-6 col-md-6 col-lg-6'";
		var i=1,j=0; x=document.getElementById("display"), temp="<div class='row' style='background-color:gray; border-radius:5px; margin-left:0px;'><div class="+ c1+" style="+ s3+">S.No.</div><div class="+ c6+" style="+ s3+">Revenue-Expenses list</div></div>"; 
		for (var k in $scope.revexpcatData) for (var j in $scope.revexpcatData[k]) 
			 { 
			temp= temp+ "<div id='"+$scope.revexpcatData[k][j]['catId']+"' class='row' style='margin:0px; border-bottom:solid 1px; border-radius:5px; width:90%'><div class="+ c1+" style="+ s3+">"+ i +".</div><div class="+ c6+ " style="+ s3+">"+ $scope.revexpcatData[k][j]['category']+ "</div></div>";   		
		 	$scope.btnClicked[$scope.revexpcatData[k][j]['catId']]= false; i++;
		} x.innerHTML=temp;  $scope.fil=$scope.revexpcatData; //[0].filter(x => x.catId == 1);
		for (var k in $scope.revexpcatData) for (var j in $scope.revexpcatData[k])  {   var y=document.getElementById($scope.revexpcatData[k][j]['catId']); y.onclick = $scope.revexpcatDetail; }			//alert ($scope.revexpcatData[k][j]['value']);
	}
	$scope.revexpcatDetail = function () {   
		var temp='', i=0,ii=1, element = document.getElementById(this.id);
		var  s3="'margin: 0px; float: left; font-size:0.8em;  white-space: nowrap;'", c2="'col-xs-2 col-sm-2 col-md-2 col-lg-2'", c1="'col-xs-1 col-sm-1 col-md-1 col-lg-1'", c3="'col-xs-3 col-sm-3 col-md-3 col-lg-3'";
	if ($scope.btnClicked[this.id]==false) 
	 		{ var tempData = $scope.revexpcatData[0].filter(x => x.catId == this.id);   
				temp=temp+ "<div class=row style='background-color:cyan; align-content:center; margin-left: 7.5%; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px red; border-radius: 5px;'><div class="+c1+" style="+s3+">SNo.</div><div class="+c3+" style="+s3+">Rx No.</div></div>";			
					for (var k in tempData[0]['value']) {  i++;
					temp=temp+ "<div class=row style='backgroundColor:yellow; align-content:center; margin-left: 7.5%; margin-left: 2%; margin-bottom: 0px; border-bottom: solid 1px red; border-radius: 5px;'><div class="+c1+" style="+s3+">"+ i +")</div><div class="+c3+" style="+s3+">"+ tempData[0]['value'][k]['Name']+"</div></div>";								
					}
			 $scope.btnClicked[this.id]=true;  var para = document.createElement("span");  para.id='newPar' + this.id;  para.classList.add("row"); 
			para.innerHTML=temp; 
	  	element.appendChild(para); 	     
	  } 
	  		else { var removeChild =document.getElementById ('newPar'+ this.id); removeChild.remove(); $scope.btnClicked[this.id]=false; element.style.backgroundColor = "white";  } 
	}
});
app.controller ('RecordMgtCtrl',  function ($scope, $http, $rootScope, $cookies, $window, $location) {    
	if ($cookies.get('logStatus')==='true')  {    $rootScope.logStrue();} else if ($cookies.get('logStatus')==='false')  { $rootScope.logSfalse();  } 
	$scope.collapseM=0; document.getElementById('collapseM').innerHTML='---';  $scope.collapseA=0; document.getElementById('collapseA').innerHTML='---';
	$scope.licenseNo =$rootScope.logRec[$cookies.get ('licNo')]['licenseNo']; $scope.prevName=$rootScope.logRec[$cookies.get ('licNo')]['PrevName']; $scope.empId=$rootScope.logRec[$cookies.get ('licNo')]['EmpId']; $scope.fName=$rootScope.logRec[$cookies.get ('licNo')]['EmpFName']; $scope.lName=$rootScope.logRec[$cookies.get ('licNo')]['EmpLName'];
	 $scope.EmpFullName= $rootScope.logRec[$cookies.get ('licNo')]['EmpFName'] + '  ' + $rootScope.logRec[$cookies.get ('licNo')]['EmpLName'];
	$scope.collapseMain = function () { var x= document.getElementById('collapseM'); if ($scope.collapseM===0) { x.innerHTML='+++'; $scope.collapseM=1;  $scope.tC1=$scope.C1; $scope.tC2= $scope.C2; $scope.tC3= $scope.C3; $scope.C1=''; $scope.C2=''; $scope.C3='';  } else  { x.innerHTML='---'; $scope.collapseM=0;  $scope.C1=$scope.tC1; $scope.C2= $scope.tC2; $scope.C3= $scope.tC3; $scope.getSummary(); } }
	$scope.collapseAss = function () { var x= document.getElementById('collapseA'); if ($scope.collapseA===0) { x.innerHTML='+++'; $scope.collapseA=1;  $scope.tassC1=$scope.assC1; $scope.tassC2= $scope.assC2; $scope.tassC3= $scope.assC3; $scope.assC1=''; $scope.assC2=''; $scope.assC3='';  } else  { x.innerHTML='---'; $scope.collapseA=0;  $scope.assC1=$scope.tassC1; $scope.assC2= $scope.tassC2; $scope.assC3= $scope.tassC3; } }
	$scope.rtSelected = { multipleSelect: [] };  
	$scope.checkBMain = function (cN,cV,index ) { $scope.cv=(cV==1?false:true); $scope.C2[index].tblName=$scope.cv; $scope.C2[index].tblChecked; }
	$scope.checkBAss = function (cN,cV,index ) { $scope.cv=(cV==1?false:true); $scope.assC2[index].tblName=$scope.cv; $scope.assC2[index].tblChecked; }
	$scope.inputChange = function (inChange,index) { if($scope.addNR==true) $scope.addChange(inChange,index); if ($scope.editR==true) $scope.edditChange(inChange,index);  } 	
	$scope.addChange = function (inChange,index) { var found=false; if (inChange==true) { $scope.insertBtn=true; $scope.columnNames[index].tblInvalid=inChange;  } else   { $scope.columnNames[index].tblInvalid=false; for (var k in $scope.columnNames) { if ($scope.columnNames[k].tblInvalid==true || ($scope.columnNames[k].tblAutoInc!=true && $scope.columnNames[k].tblNull=='NO' && $scope.columnNames[k].tblName=='')) {found=true; } } if (found==false) $scope.insertBtn=false; }  }
	$scope.edditChange = function (inChange,index) { var found=false; if (inChange==true) { $scope.saveBtn=true; $scope.columnNames[index].tblInvalid=inChange;  } else   { $scope.columnNames[index].tblInvalid=false; for (var k in $scope.columnNames) { if ($scope.columnNames[k].tblInvalid==true) {found=true; } } if (found==false) $scope.saveBtn=false; } }
	$scope.inputBlur = function (inputValue,index) { if ($scope.columnNames[index].tblLabel==$scope.pK) { var found=false; if($scope.addNR==true) $scope.addBlur(inputValue, index);  else if ($scope.editR==true) $scope.edditBlur(inputValue, index);  } }
	$scope.edditBlur = function (inputValue,index) { var found=false; for (var k in $scope.Records) if (inputValue==$scope.Records[k][$scope.pK] && $scope.rowNo!=k) found=true; if (found==true) $scope.saveBtn=true;  }
	$scope.addBlur = function (inputValue,index) { var found=false; for (var k in $scope.Records) if (inputValue==$scope.Records[k][$scope.pK]) found=true; if (found==true) $scope.insertBtn=true;  }
	$scope.typeaheadOnSelect = function (label, selectedtypeahead, index) { $scope.asscolumnNames[index].tblName= selectedtypeahead[0].toString();    $scope.refColumnList= null; $scope.assaddChange(selectedtypeahead[0], index); }
	$scope.typeaheadOnSelect2 = function (label, selectedtypeahead, index) {  $scope.columnNames[index].tblName= selectedtypeahead[0].toString(); $scope.refColumnList= null; $scope.addChange(selectedtypeahead[0], index);  }
	$scope.typeaheadOnSelect3 = function (label, selectedtypeahead, index) { $scope.asscolumnNames[index+1].tblName= selectedtypeahead[0].toString();   $scope.assaddChange(selectedtypeahead[0], index); }
	$scope.autoList = function ($cN, $tN) {  var arrColumnList=[];  $scope.getRefTable ($cN, $tN); for (var k in $scope.refColumnList) { arrColumnList[k] = new Array(); arrColumnList[k].push([$scope.refColumnList[k][$cN]]); arrColumnList[k].push([$scope.refColumnList[k][1]]);  arrColumnList[k].push([$scope.refColumnList[k][2]]); arrColumnList[k].push([$scope.refColumnList[k][3]]);    }  return arrColumnList; }  //alert($scope.refColumnList[k][1]);
	$scope.autoList2 = function ($cN, $tN) {  var arrColumnList=[];  
			if ($cN==='Location' && $tN==='predetail') {  
			arrColumnList[0] = new Array(); arrColumnList[0].push ("Cabinet"); 
			arrColumnList[1] = new Array(); arrColumnList[1].push ("Emergency Bag");
				}  
					 return arrColumnList;
		}  //alert($scope.refColumnList[k][1]);		
	$scope.searchList = function ($cN, tN) {  var arrColumnList=[];  for (var k in $scope.Records) {  arrColumnList[k] = new Array(); arrColumnList[k].push([$scope.Records[k][$cN]]); arrColumnList[k].push([$scope.Records[k][1]]); arrColumnList[k].push([$scope.Records[k][2]]); arrColumnList[k].push([$scope.Records[k][3]]);  }  return arrColumnList; }  //alert($scope.refColumnList[k][1]);
	$scope.typeaheadOnSelectsearch = function (label, selectedtd, index) { var searchValue=selectedtd[0].toString(); $scope.searchMain=''; var index = $scope.Records.findIndex(obj => obj[label]==searchValue);   $scope.rowNo=index; $scope.fillFields();	$scope.getAssociatedTableInfo($cookies.get('rtselected'), $scope.Records[$scope.rowNo][$cookies.get('pkLabel')], $cookies.get('pkLabel'));	 }	
	$scope.searchListRel = function ($cN, tN) { var arrColumnList=[];  for (var k in $scope.assRecordsInfo) {  arrColumnList[k] = new Array(); arrColumnList[k].push([$scope.assRecordsInfo[k][$cN]]); arrColumnList[k].push([$scope.assRecordsInfo[k][1]]); arrColumnList[k].push([$scope.assRecordsInfo[k][2]]); arrColumnList[k].push([$scope.assRecordsInfo[k][3]]);  }  return arrColumnList; }  //alert($scope.refColumnList[k][1]);
	$scope.typeaheadOnSelectsearchRel = function (label, selectedtd, index) { var searchValue=selectedtd[0].toString(); $scope.searchRelated=''; var index = $scope.assRecordsInfo.findIndex(obj => obj[label]==searchValue);   $scope.assrowNo=index; $scope.assfillFields();	 }	
	$scope.getMainTables = function () { $scope.rootP=$cookies.get('rootP'); $scope.dbName=$cookies.get('dbName'); var arrRecJson={}; var temp, sNo=0; 	var data= {'getName':'fetch_Info_Schema_Main_Tables', 'dbName': $scope.dbName, 'root_P':$scope.rootP };  var config= {params: data, headers: {'Accept' : 'application/json'}};
			$http.get("pages/connection.php", config) .then (function(response) { $scope.getMainSize= response.data.length; $scope.setSelected(response.data); $scope.selectionRecords= response.data;  })  , function (response) { alert ("failed to show"); };   }
	$scope.getMainTables2 = function () { $scope.rootP=$cookies.get('rootP'); $scope.dbName=$cookies.get('dbName'); var arrRecJson={}; var temp, sNo=0; 	var data= {'getName':'Main_Tables2', 'dbName': $scope.dbName, 'root_P':$scope.rootP, 'prevName': $scope.logRec[0].PrevName };  var config= {params: data, headers: {'Accept' : 'application/json'}};
			$http.get("pages/connection.php", config) .then (function(response) { /*$scope.getMainSize= response.data.length; $scope.setSelected(response.data); */ $scope.selectionRecords2= response.data; })  , function (response) { alert ("failed to show"); };   }
	$scope.setSelected= function () { $scope.rowNo=0;  $scope.getRecSize=0; $scope.Records=null; $scope.columnNames=null;  $scope.getColumnNames(); $scope.getTableRecord ($scope.selected.M_Table);  $scope.getAssociatedTables($scope.selected.M_Table); $rootScope.showNav=true; }
	$rootScope.onSelectionChange= function () {  $scope.asscolumnNames=null;  $scope.showAssNav=false; $cookies.put('selected', $scope.selected); $scope.rowNo=0; $scope.getRecSize=0; $scope.Records=null;  $scope.getColumnNames(); $scope.getTableRecord ($scope.selected.M_Table); if ($scope.selected.M_Table!=null) { $cookies.put('showNav', true); $rootScope.showNav=true; }   $scope.getAssociatedTables($scope.selected.M_Table);  $scope.getSummary(); 	}
	$rootScope.onSelectionChange2= function () { $scope.collapseA=0; $scope.collapseM=0; document.getElementById('collapseM').innerHTML='---'; document.getElementById('collapseA').innerHTML='---'; $scope.asscolumnNames=null;  $scope.showAssNav=false; $cookies.putObject('selected', $scope.selected);  $scope.rowNo=0; $scope.getRecSize=0; $scope.Records=null;   if ($scope.selected.M_Table!=null) { $cookies.put('showNav', true); $rootScope.showNav=true; }  $scope.getColumnNames(); /*---*/  $cookies.put('rtselected', $scope.selected.R_Table);  $val= $scope.selected.R_Table; if ($val!=null) $scope.showAssNav=true; else $scope.showAssNav=false;  $scope.assgetSize=0; $scope.assgetSizeInfo=0; $scope.assRecordsInfo=null; $scope.asscolumnNames=null;  $scope.currSelectedBox=$val;  /*--*/ $scope.getSummary(); }
	$scope.getTempColumnNames = function (tname) {  var data= { 'getName':'fetch_RecFields', 'dbName': $scope.dbName, 'root_P':$scope.rootP, 't_Name': tname };  var config= {params: data, headers: {'Accept' : 'application/json'}};
			$http.get("pages/connection.php", config) 	.then (function(response) {   $scope.columnNames= $scope.getPattern(response.data,'Main');  $scope.getTableRecord ($scope.selected.M_Table); $scope.filterByInputTypeM();  $scope.getAssColumnNames();   }) , function (response) { alert ("failed to show"); }; }					
	$scope.getColumnNames = function () {  var data= { 'getName':'fetch_RecFields', 'dbName': $scope.dbName, 'root_P':$scope.rootP, 't_Name': $scope.selected.M_Table };  var config= {params: data, headers: {'Accept' : 'application/json'}};
			$http.get("pages/connection.php", config) 	.then (function(response) {   $scope.columnNames= $scope.getPattern(response.data,'Main');  $scope.getTableRecord ($scope.selected.M_Table); $scope.filterByInputTypeM();  $scope.getAssColumnNames();   }) , function (response) { alert ("failed to show"); }; }					
	$scope.getTableRecord = function ($sname) { var arrRecJson={}; var temp, sNo=0; var data= {'getName':'fetch_Record', 'licenseNo': $scope.licenseNo, 'dbName': $scope.dbName, 'root_P':$scope.rootP, 't_Name': $sname };  var config= {params: data, headers: {'Accept' : 'application/json'}};
			$http.get("pages/connection.php", config) .then (function(response) { $scope.getRecSize= response.data.length; $scope.Records= response.data;   $scope.fillFields();  $scope.getAssociatedTableInfo($cookies.get('rtselected'), $scope.Records[$scope.rowNo][$cookies.get('pkLabel')], $cookies.get('pkLabel')); })  , function (response) { alert ("failed to show"); };  }
	$scope.fillFields = function () {  $scope.deleteBtn=false; $scope.enadisInBtn(true); $scope.enadisBtn(false); $scope.saveBtn=true; $scope.cancelBtn=true; $scope.insertBtn=true; var tCN=$scope.columnNames, aRi; for (var k in tCN) { aRI=$scope.Records[$scope.rowNo][$scope.columnNames[k].tblLabel]; if ($scope.Records.length==0) { $scope.rowNo=-1; $scope.columnNames[k].tblName='';  } else { if (tCN[k].tblType=='date') { var da= new Date(aRI);   tCN[k].tblName= new Date(da.setMinutes( da.getMinutes() + da.getTimezoneOffset() ));  } else tCN[k].tblName=aRI;  if (tCN[k].tblName=='1') tCN[k].tblChecked=true; else tCN[k].tblChecked=false;} } $scope.pkValue=$scope.Records[$scope.rowNo][$scope.pK]; $scope.pkLabel= $scope.pK; $cookies.put('pkValue', $scope.pkValue); $cookies.put('pkLabel', $scope.pkLabel); }					
	$scope.emptyFields = function () { for (var k in $scope.columnNames) { $scope.columnNames[k].tblName='';  if ($scope.columnNames[k].tblNull=='NO') $scope.insertBtn=true;  }  }				
	$scope.addnewRecord = function() { $scope.addNR=true; $scope.editR=false; $scope.enadisInBtn(false); $scope.enadisBtn(true); $scope.cancelBtn=false; $scope.insertBtn=false; $scope.saveBtn=true; $scope.deleteBtn=true; $scope.emptyFields(); }
	$scope.insertRecord = function() {	var jData=$scope.jsonData('insert');  $http.post("pages/post_Connection.php", jData ,  { headers: {'Content-Type': 'application/x-www-form-urlencoded'} }) .then (function(response) { alert (response.data); $scope.getTableRecord($scope.selected.M_Table); $scope.fillFields();    });  }
	$scope.insertSetting = function () { var arrJson={}, arrDataInfo={}; var temp;  for (var k in $scope.rtSelected.multipleSelect) { arrJson[k]=$scope.rtSelected.multipleSelect[k].Table_Name; }  var myObj = {'postName': 'settingMenu', 'dbName': $scope.dbName, 'pK': $scope.pK, 'root_P':$scope.rootP, 't_Name': $scope.selected.M_Table};  arrDataInfo[0]=myObj; arrDataInfo[1]= arrJson; $scope.arrDataInfo= arrDataInfo;   
	$http.post("pages/post_Connection.php", arrDataInfo ,  { headers: {'Content-Type': 'application/x-www-form-urlencoded'} }) .then (function(response) { alert (response.data); /*$scope.getTableRecord($scope.selected.M_Table); $scope.fillFields();  */  });
	}
	$scope.nextRecord= function() { if ($scope.getRecSize==0) alert("There is no records available!"); else if ($scope.rowNo < $scope.getRecSize-1) $scope.rowNo++;  else alert ("Your Reach Last Record!"); $scope.fillFields(); $scope.getAssociatedTableInfo($cookies.get('rtselected'), $scope.Records[$scope.rowNo][$cookies.get('pkLabel')], $cookies.get('pkLabel'));     }
	$scope.previousRecord= function(){  if ($scope.getRecSize==0) alert("There is no records available!"); else if ($scope.rowNo > 0) $scope.rowNo--;  else alert ("Your Reach First Record!"); $scope.fillFields(); $scope.getAssociatedTableInfo($cookies.get('rtselected'), $scope.Records[$scope.rowNo][$cookies.get('pkLabel')], $cookies.get('pkLabel'));   }			
	$scope.firstRecord= function() {  if ($scope.getRecSize==0) alert("There is no records available!"); else if ($scope.rowNo==0) alert ("Aleardy in the first record"); else $scope.rowNo=0;   $scope.fillFields(); $scope.getAssociatedTableInfo($cookies.get('rtselected'), $scope.Records[$scope.rowNo][$cookies.get('pkLabel')], $cookies.get('pkLabel'));  }
	$scope.lastRecord= function() {   if ($scope.getRecSize==0) alert("There is no records available!"); else if ($scope.getRecSize==0) alert("There is no records available!"); else if ($scope.rowNo==$scope.getRecSize-1) alert ("Aleardy in the last record"); else $scope.rowNo=$scope.getRecSize-1;  $scope.fillFields(); $scope.getAssociatedTableInfo($cookies.get('rtselected'), $scope.Records[$scope.rowNo][$cookies.get('pkLabel')], $cookies.get('pkLabel'));  }
	$scope.cancel = function() { $scope.fillFields(); }
	$scope.editRecord= function () {  if ($scope.Records.length>0) { $scope.addNR=false; $scope.editR=true; $scope.enadisInBtn(false); $scope.enadisBtn(true); $scope.saveBtn=false; $scope.cancelBtn=false; } else alert ('There is No Record Available to be Edited!'); }
	$scope.saveRecord= function () {  var jData=$scope.jsonData('saveEdit');  
				$http.post("pages/post_Connection.php",  jData, { headers: {'Content-Type': 'application/x-www-form-urlencoded'} } ) .then (function(response) {  alert (response.data);  $scope.getTableRecord($scope.selected.M_Table);  $scope.fillFields();   }); }	
	$scope.deleteRecord= function () { var confirmpas= $window.prompt ('Password for Record Operation Required!'); if (confirmpas==='Sami@123') { var jData=$scope.jsonData('delete');   $http.post("pages/post_Connection.php", jData ,  { headers: {'Content-Type': 'application/x-www-form-urlencoded'} }) .then (function(response) {  alert (response.data); $scope.getTableRecord($scope.selected.M_Table); $scope.rowNo=0; $scope.fillFields(); }); } else alert ('There is No Record Available to be Edited!'); }	
	$scope.jsonData = function (postName) { var arrJson={}, arrDataInfo={}; var temp;  for (var k in $scope.columnNames) { arrJson[$scope.columnNames[k].tblLabel] = new Array(); arrJson[$scope.columnNames[k].tblLabel].push($scope.columnNames[k].tblName); arrJson[$scope.columnNames[k].tblLabel].push($scope.columnNames[k].tblType); }  var myObj = {'postName': postName, 'dbName': $scope.dbName, 'pK': $scope.pK, 'pKV':$scope.pkValue, 'root_P':$scope.rootP, 't_Name': $scope.selected.M_Table};  arrDataInfo[0]=myObj; arrDataInfo[1]= arrJson; $scope.arrDataInfo= arrDataInfo; return (arrDataInfo);   }	
	$scope.enadisBtn = function ($val) { $scope.insertBtn=$val; $scope.firstBtn=$val; $scope.lastBtn=$val; $scope.prevBtn=$val; $scope.editBtn=$val; $scope.saveBtn=$val; $scope.cancelBtn=$val; $scope.nextBtn=$val;  $scope.newBtn=$val;   if ($scope.prevName!=='Admin') {  $scope.newBtn=true; $scope.deleteBtn=true; $scope.editBtn=true; }  }
	$scope.enadisInBtn = function ($val) {  for (var k in $scope.columnNames) { if ($scope.columnNames[k].tblAutoInc==true) $scope.columnNames[k].ngEnaDis=true; else $scope.columnNames[k].ngEnaDis=$val; }		}		
//Associate Tables Coding follows
	$scope.getAssColumnNames = function () {  var data= { 'getName':'fetch_RecFields', 'dbName': $scope.dbName, 'root_P':$scope.rootP, 't_Name': $scope.selected.R_Table };  var config= {params: data, headers: {'Accept' : 'application/json'}};
		$http.get("pages/connection.php", config) .then (function(response) { $scope.asscolumnNames= $scope.getPattern(response.data,'Ass'); $scope.filterByInputType(); $scope.assemptyFields(); $scope.getAssociatedTableInfo($val, $scope.pkValue, $scope.pkLabel); $scope.getRefColumnName(); $scope.asspkPos(); $scope.assenadisInBtn(true);  $scope.getSummary(); }) , function (response) { alert ("failed to show"); }; }					
	$scope.getAssociatedTableInfo = function ($tN, $pkV, $pkL) { var data= { 'getName':'fetch_Ass_Table_Info', 'dbName': $scope.dbName, 'root_P':$scope.rootP, 't_Name': $tN, 'pkV': $pkV, 'pkL': $pkL, 'EmpId': $scope.empId, 'prevName': $scope.prevName };  var config= {params: data, headers: {'Accept' : 'application/json'}};
			$http.get("pages/connection.php", config) .then (function(response) { if (response.data.length>0) $scope.assrowNo=0; else $scope.assrowNo=-1;   $scope.assRecordsInfo= response.data; $scope.assfillFields(); $scope.getSummary();   })  , function (response) { alert ("failed to show"); };  }				
	$scope.getAssociatedTables = function ($sname) { var data= { 'getName':'fetch_Info_Schema','dbName': $scope.dbName, 'root_P':$scope.rootP, 't_Name': $sname };  var config= {params: data, headers: {'Accept' : 'application/json'}};
			$http.get("pages/connection.php", config) .then (function(response) {  $scope.assRecords= response.data; $scope.rtSelectionRecords=$scope.assRecords; /*$scope.setAssSelected(response.data); */ $scope.assfillFields();  })  , function (response) { alert ("failed to show"); };  }			
	$scope.setAssSelected = function (mainRec) { var found=false; for(var i = 0; i < mainRec.length; i++) { if(mainRec[i].Table_Name === $cookies.get('rtselected')){ found=true; $scope.rtSelected= mainRec[i]; } } if (found==true) { $val= $scope.selected.R_Table; if ($val!=null) $scope.showAssNav=true; else $scope.showAssNav=false; $scope.assgetSize=0; $scope.assgetSizeInfo=0; $scope.assRecordsInfo=null; $scope.asscolumnNames=null; $scope.getAssColumnNames(); $scope.currSelectedBox=$val; $scope.getAssociatedTableInfo($val, $cookies.get('pkValue'), $cookies.get('pkLabel'));  $scope.getRefColumnName(); }}
	$scope.getAssociateColumn = function () { var data= { 'getName':'fetch_Ass_Column_Names', 'dbName': $scope.dbName, 'root_P':$scope.rootP,'ptN':$scope.selected.M_Table, 'asstN': $scope.selected.R_Table };  var config= {params: data, headers: {'Accept' : 'application/json'}};
			$http.get("pages/connection.php", config) .then (function(response) { $scope.assfkRecords= response.data;  })  , function (response) { alert ("failed to show"); };  }			
	$scope.rtSelectionChange = function () { /*$scope.selected.R_Table=$scope.rtSelected.multipleSelect[0].Table_Name; */ $cookies.put('pkValue', $scope.pkValue); $cookies.put('pkLabel', $scope.pkLabel); $cookies.put('rtselected', $scope.selected.R_Table ); $val= $scope.selected.R_Table; if ($val!=null) $scope.showAssNav=true; else $scope.showAssNav=false;  $scope.assgetSize=0; $scope.assgetSizeInfo=0; $scope.assRecordsInfo=null; $scope.asscolumnNames=null; $scope.getAssColumnNames(); $scope.currSelectedBox=$val; $scope.getAssociatedTableInfo($val, $scope.pkValue, $scope.pkLabel); $scope.getRefColumnName();  }
	$scope.getRefTable = function ($cN, $tN) {   var arrRecJson={}; var temp, sNo=0; 	var data= { 'getName':'fetch_Info_Schema_ref_Table', 'dbName': $scope.dbName, 'root_P':$scope.rootP, 'cN': $cN, 't_Name': $tN  };  var config= {params: data, headers: {'Accept' : 'application/json'}};
			$http.get("pages/connection.php", config) .then (function(response) { $scope.refTable= response.data;  $scope.getRefColumnList($cN, $scope.refTable[0].R_Table_Name); })  , function (response) { alert ("failed to show"); }; }
	$scope.getRefColumnList = function ($cN, $tN) {  var arrRecJson={}; var temp, sNo=0; 	var data= {'getName':'fetch_Record',  'dbName': $scope.dbName, 'root_P':$scope.rootP, 'cN': $cN, 't_Name': $tN , 'licenseNo': $scope.licenseNo  };  var config= {params: data, headers: {'Accept' : 'application/json'}};
			$http.get("pages/connection.php", config) .then (function(response) {   $scope.refColumnList= response.data;  })  , function (response) { alert ("failed to show"); };   }
	$scope.getRefJson = function ($cN, $tN) { 
	}
//Similar codes from above with remaing (ass) only
	$scope.assinputChange = function (inChange,index) { if($scope.assaddNR==true) $scope.assaddChange(inChange,index); if ($scope.asseditR==true) $scope.assedditChange(inChange,index);  } 	
	$scope.assaddChange = function (inChange,index) {  var found=false; if (inChange==true) { $scope.assinsertBtn=true; $scope.asscolumnNames[index].tblInvalid=inChange;  } else   { $scope.asscolumnNames[index].tblInvalid=false; for (var k in $scope.asscolumnNames) { if ($scope.asscolumnNames[k].tblInvalid==true || ($scope.asscolumnNames[k].tblNull=='NO' && $scope.asscolumnNames[k].tblName=='' && $scope.asscolumnNames[k].tblAutoInc==false)) { found=true; } } if (found==false) $scope.assinsertBtn=false; }  }
	$scope.assedditChange = function (inChange,index) { var found=false; if (inChange==true) { $scope.asssaveBtn=true; $scope.asscolumnNames[index].tblInvalid=inChange;  } else   { $scope.asscolumnNames[index].tblInvalid=false; for (var k in $scope.asscolumnNames) { if ($scope.asscolumnNames[k].tblInvalid==true || ($scope.asscolumnNames[k].tblNull=='NO' && $scope.asscolumnNames[k].tblName=='' && $scope.asscolumnNames[k].tblAutoInc==false)) {found=true; } } if (found==false) $scope.asssaveBtn=false; } }
	$scope.assfillFields = function () {  $scope.getAssociateColumn(); $scope.assenadisInBtn(true); $scope.assenadisBtn(false); $scope.asssaveBtn=true; $scope.asscancelBtn=true; $scope.assinsertBtn=true;  var tassCN=$scope.asscolumnNames, assRI; for (var k in tassCN) { if ($scope.assRecordsInfo.length==0) { $scope.assemptyFields(); } else { assRI=$scope.assRecordsInfo[$scope.assrowNo][tassCN[k].tblLabel]; if (tassCN[k].tblType=='datetime') { var da= new Date(assRI); tassCN[k].tblName= new Date(da.setMinutes( da.getMinutes() + da.getTimezoneOffset() ));  } else if (tassCN[k].tblType=='date') { var da= new Date(assRI);  tassCN[k].tblName= new Date(da.setMinutes( da.getMinutes() + da.getTimezoneOffset() ));  } else tassCN[k].tblName=assRI; if (tassCN[k].tblName=='1') tassCN[k].tblChecked= true;  else tassCN[k].tblChecked=false; if (tassCN[k].tblKey=='PRI')  $scope.asspkValue = assRI;  }  } $scope.getDocuments();  }	// if ($temp[k].tblKey=='MUL' || $temp[k].tblKey=='UNI') alert (assRI); 
	$scope.assemptyFields = function () {  for (var k in $scope.asscolumnNames) { if ($scope.asscolumnNames[k].tblLabel=="EmpId" && $scope.selected.R_Table==='progressnote') $scope.asscolumnNames[k].tblName=$scope.empId; else if ($scope.asscolumnNames[k].tblLabel==$scope.pK) $scope.asscolumnNames[k].tblName=$scope.pkValue; else $scope.asscolumnNames[k].tblName='';  }   }				
	$scope.assaddnewRecord = function() { $scope.assaddNR=true; $scope.asseditR=false; $scope.assemptyFields(); $scope.assenadisInBtn(false); $scope.assenadisBtn(true); $scope.asscancelBtn=false; $scope.asssaveBtn=true; $scope.assdeleteBtn=true;   $scope.asscolumnNames[$scope.realDTP].assngEnaDis=true; $scope.asscolumnNames[$scope.realDTP].tblName=$scope.realDT; }
	$scope.assinsertRecord = function() {	var jData=$scope.assjsonData('insert');  $http.post("pages/post_connection.php", jData ,  { headers: {'Content-Type': 'application/x-www-form-urlencoded'} }) .then (function(response) { alert (response.data); $scope.getAssociatedTableInfo($scope.selected.R_Table, $scope.pkValue, $scope.pK); $scope.assfillFields();    });  }
	$scope.assnextRecord= function() {  if ($scope.assRecordsInfo.length==0) alert("There is no records available!"); else if ($scope.assrowNo < $scope.assRecordsInfo.length-1) $scope.assrowNo++;  else alert ("Your Reach Last Record!"); $scope.assfillFields(); }
	$scope.asspreviousRecord= function(){  if ($scope.assRecordsInfo.length==0) alert("There is no records available!"); else if ($scope.assrowNo > 0) $scope.assrowNo--;  else alert ("Your Reach First Record!"); $scope.assfillFields(); }			
	$scope.assfirstRecord= function() {  if ($scope.assRecordsInfo.length==0) alert("There is no records available!"); else if ($scope.assrowNo>0) $scope.assrowNo=0; else alert("First record!");  $scope.assfillFields(); }
	$scope.asslastRecord= function() {  if ($scope.assRecordsInfo.length==0) alert("There is no records available!"); else if ($scope.assRecordsInfo.length-1>$scope.assrowNo) $scope.assrowNo=$scope.assRecordsInfo.length-1; else alert("Reached Last records!"); $scope.assfillFields(); }
	$scope.asscancel= function() { $scope.assfillFields(); }
	$scope.asseditRecord= function () { if ($scope.assRecordsInfo.length>0) { $scope.assaddNR=false; $scope.asseditR=true; $scope.assenadisInBtn(false); $scope.assenadisBtn(true); $scope.asssaveBtn=false; $scope.asscancelBtn=false;$scope.asscolumnNames[$scope.pkPos].tblName=$scope.pkValue; $scope.asscolumnNames[$scope.pkPos].assngEnaDis=true; } else alert ('There is No Record Available to be Edited!'); }
	$scope.asssaveRecord= function () {  var jData=$scope.assjsonData('saveEdit');  
				$http.post("pages/post_connection.php", jData ,  { headers: {'Content-Type': 'application/x-www-form-urlencoded'} }) .then (function(response) {  alert (response.data); $scope.getAssociatedTableInfo($scope.selected.R_Table, $scope.pkValue, $scope.pK); $scope.assfillFields();  }); }	
	$scope.assdeleteRecord= function () {  var confirmpas= $window.prompt ('Password for Record Operation Required!'); if (confirmpas==='Sami@123') { var jData=$scope.assjsonData('delete');  
				$http.post("pages/post_connection.php", jData ,  { headers: {'Content-Type': 'application/x-www-form-urlencoded'} }) .then (function(response) {  alert (response.data); $scope.getAssociatedTableInfo($scope.selected.R_Table, $scope.pkValue, $scope.pK); $scope.assrowNo=0; $scope.assfillFields(); }); } else alert ('Wrong Confirmation Password!');}	
	$scope.assjsonData = function (postName) { var arrJson={}, arrDataInfo={}; var temp;  for (var k in $scope.asscolumnNames) { arrJson[$scope.asscolumnNames[k].tblLabel] = new Array(); arrJson[$scope.asscolumnNames[k].tblLabel].push($scope.asscolumnNames[k].tblName); arrJson[$scope.asscolumnNames[k].tblLabel].push($scope.asscolumnNames[k].tblType); }  var myObj = {'postName': postName, 'dbName': $scope.dbName, 'pK': $scope.asspK, 'pKV': $scope.asspkValue, 'root_P':$scope.rootP, 't_Name': $scope.selected.R_Table};  arrDataInfo[0]=myObj; arrDataInfo[1]= arrJson; $scope.arrDataInfo= arrDataInfo; return (arrDataInfo);  }	
	$scope.assenadisBtn = function ($val) { $scope.assinsertBtn=$val; $scope.assfirstBtn=$val; $scope.asslastBtn=$val; $scope.assprevBtn=$val; $scope.asseditBtn=$val; $scope.asssaveBtn=$val; $scope.asscancelBtn=$val; $scope.assnextBtn=$val;   $scope.assdeleteBtn= $val; $scope.assnewBtn=$val;  if ($scope.prevName!=='Admin') {  $scope.assdeleteBtn=true; $scope.asseditBtn=true; }  }
	$scope.assenadisInBtn = function ($val) {  for (var k in $scope.asscolumnNames) { if ($scope.asscolumnNames[k].tblLabel=="EmpId" || $scope.asscolumnNames[k].tblLabel==$scope.pK) $scope.asscolumnNames[k].assngEnaDis=true; else if ($scope.asscolumnNames[k].tblAutoInc==true) $scope.asscolumnNames[k].assngEnaDis=true; else $scope.asscolumnNames[k].assngEnaDis=$val; }	}		
	$scope.asspkPos = function() { $scope.pkPos=null; for (var k in $scope.asscolumnNames) { if ($scope.asscolumnNames[k].tblLabel==$scope.pkLabel) $scope.pkPos=k;   } $scope.asscolumnNames[$scope.pkPos].tblName=$scope.pkValue; } 
	$scope.filterByInputType = function () {  var tarea = $scope.asscolumnNames.filter(function (e) {  return (e.tblInputType != 'textarea' && e.tblInputType != 'checkbox' && e.tblInputType != 'mediumblob') ; } );  $scope.assC1=tarea; $scope.tassC1=$scope.assC1; var tarea = $scope.asscolumnNames.filter(function (e) { return (e.tblInputType == 'checkbox') ; } );  $scope.assC2=tarea;  $scope.tassC2=$scope.assC2; var tarea = $scope.asscolumnNames.filter(function (e) { return (e.tblInputType == 'textarea') ; } );  $scope.assC3=tarea;  $scope.assC3=tarea; $scope.tassC3=$scope.assC3; }
	$scope.filterByInputTypeM = function () {   var tarea = $scope.columnNames.filter(function (e) { return (e.tblInputType != 'textarea' && e.tblInputType != 'checkbox' && e.tblInputType != 'mediumblob') ; } );  $scope.C1=tarea; $scope.tC1=$scope.C1;  var tarea = $scope.columnNames.filter(function (e) { return (e.tblInputType == 'checkbox') ; } );  $scope.C2=tarea; $scope.tC2=$scope.C2; var tarea = $scope.columnNames.filter(function (e) { return (e.tblInputType == 'textarea') ; } );  $scope.C3=tarea; $scope.tC3=$scope.C3; }		
// Specific function
	$scope.getSummary = function () { 	if ($scope.prevName=='Admin') { 
		if ($scope.selected.R_Table=='residentfinance' && $scope.selected.M_Table==='resident' ) {  $scope.getResFinSum($scope.asscolumnNames); } else if ($scope.selected.R_Table==='progressnote' && $scope.selected.M_Table==='resident' ) {  $scope.getResProgNoteSum($scope.asscolumnNames); } 
		else if ($scope.selected.R_Table==='evacuationdrill' && $scope.selected.M_Table==='licensed' ) { $scope.getFireDrillSum($scope.asscolumnNames); }
		else if ($scope.selected.R_Table==='menu' && $scope.selected.M_Table==='fosterhome' ) { $scope.getGetWeeklyMenu($scope.asscolumnNames); }
		else if ($scope.selected.R_Table==='certified' && $scope.selected.M_Table==='employee' ) { $scope.getStaffCertification($scope.asscolumnNames); }
	} 
		//else { var x=document.getElementById("summy"); x.innerHTML='<div><table class="table table-responsive"><tr><td>Summaries would be Available here!</td></tr></table></div>'; }
	}
	$scope.getDocuments = function () { if ($scope.prevName=='Admin') {
		if ($scope.selected.R_Table==='revexpense' && $scope.selected.M_Table==='licensed' ) {   $scope.displayRevExp();  $scope.getRevExp($scope.asscolumnNames); }
		}
	}
	$scope.getResFinSum = function (rT) {  var countF=0, countD=0, arrJson={}, arrDataInfo={};  $scope.sumColumns={};  for (var k in rT) {	$temp=rT[k].tblType;  if ($temp.substring(0, 7)=='decimal' || $temp.substring(0, 5)=='float' || $temp.substring(0, 6)=='double' || $temp.substring(0, 4)=='real') { countF++; arrJson[countF]=rT[k].tblLabel; arrJson[rT[k].tblLabel]=rT[k].tblComments; } } arrJson['countF']=countF;  for (var k in rT) {	$temp=rT[k].tblType;  if ($temp.substring(0, 4)=='date') {countD++; countF++; arrJson[countF]=rT[k].tblLabel; } } arrJson['countD']=countD;	 arrJson['getName']='aggSum';  arrJson['dbName']=$scope.dbName; arrJson['pK']=$scope.pK; arrJson['pKV']=$scope.pkValue; arrJson['root_P']=$scope.rootP; arrJson['t_Name']=$scope.selected.R_Table; $scope.tempArrJson=arrJson; var data = arrJson; var config= {params: data, headers: {'Accept' : 'application/json'}};
		$http.get("pages/connection.php", config) .then (function(response) {  $scope.summary=response.data; $scope.getDisplaySummary (response.data, $scope.selected.R_Table ); })  , function (response) { alert ("failed to show"); }; 	$scope.sumColumns=arrJson;  }
	$scope.getResProgNoteSum = function (rT) {  var arrJson={};  arrJson['getName']='lastProgNote'; arrJson['dbName']=$scope.dbName; arrJson['pK']=$scope.pK; arrJson['pKV']=$scope.pkValue; arrJson['root_P']=$scope.rootP; arrJson['t_Name']=$scope.selected.R_Table;  $scope.tempArrJson=arrJson; var data = arrJson; var config= {params: data, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) .then (function(response) {  $scope.progNoteSummary=response.data; $scope.getDisplayProgNote (response.data, $scope.selected.R_Table ); })  , function (response) { alert ("failed to show"); };  }
	$scope.getFireDrillSum = function (rT) {  var arrJson={};  arrJson['getName']='fireDrill'; arrJson['type']='insidesummary'; arrJson['dbName']=$scope.dbName; arrJson['pK']=$scope.pK; arrJson['pKV']=$scope.pkValue; arrJson['root_P']=$scope.rootP; arrJson['t_Name']=$scope.selected.R_Table;  arrJson['licenseNo']=$scope.licenseNo;  arrJson['prevName']= $scope.prevName; arrJson['empId']= $scope.empId; arrJson['EvaDrilId']= $scope.asscolumnNames[0]['tblName']; $scope.tempArrJson=arrJson; var data = arrJson; var config= {params: data, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) .then (function(response) {  $scope.fireDrillSummary=response.data; $scope.getDisplayFireDrill (response.data, $scope.selected.R_Table ); })  , function (response) { alert ("failed to show"); };  }
	$scope.getGetWeeklyMenu = function (rT) {  var arrJson={};  arrJson['getName']='weeklyMenu'; arrJson['dbName']=$scope.dbName; arrJson['pK']=$scope.pK; arrJson['pKV']=$scope.pkValue; arrJson['root_P']=$scope.rootP; arrJson['t_Name']=$scope.selected.R_Table;  $scope.tempArrJson=arrJson; var data = arrJson; var config= {params: data, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) .then (function(response) {  $scope.weeklyMenuSummary=response.data; $scope.getDisplayWeeklyMenu (response.data, $scope.selected.R_Table );  })  , function (response) { alert ("failed to show"); };   }	
	$scope.getStaffCertification = function (rT) { var arrJson={};  arrJson['getName']='staffCertificate';   arrJson['dbName']=$scope.dbName; arrJson['pK']=$scope.pK; arrJson['pKV']=$scope.pkValue; arrJson['root_P']=$scope.rootP; arrJson['t_Name']=$scope.selected.R_Table;  $scope.tempArrJson=arrJson; var data = arrJson; var config= {params: data, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) .then (function(response) {  $scope.staffCertSummary=response.data; $scope.getDisplayStafCert (response.data, $scope.selected.R_Table );  })  , function (response) { alert ("failed to show"); };  }
	$scope.getRevExp = function (rT) {  
			var arrJson={}, arrDataInfo={};  arrJson['getName']='revexp';  arrJson['dbName']=$scope.dbName;  arrJson['asspK']=$scope.asspK; arrJson['asspKV']= $scope.asspkValue;
			arrJson['root_P']=$scope.rootP;  $scope.tempArrJson=arrJson; 
			var data = arrJson;  var config= {params: data, headers: {'Accept' : 'application/json'}};
		$http.get("pages/connection.php", config) .then (function(response) {  $scope.revexp=response.data; $scope.getDisplayrevexp (response.data); })  , function (response) { alert ("failed to show"); }; 		
			var str1='<div style="border-bottom:solid 1px; margin-top:5px;">Total documents: </div><div style="border-bottom:solid 1px; margin-top:5px;"><input type="file" id="upload"><input type="button" value="Upload Image" id="uploadBtn"><input type="button" value="view" id="viewBtn"></div>';  				
			var x=document.getElementById("summyAss"); x.innerHTML= str1;
			var y=document.getElementById("uploadBtn"); y.onclick = $scope.uploadFile;   $scope.$digest();	 
		}
	$scope.displayRevExp =function () { 
	}
	$scope.uploadFile = function()  {   var file = document.getElementById('upload').files[0];     var fd = new FormData();  fd.append('file', file);   fd.append('pkV', $scope.asspkValue);  
		fd.append('getName','fetch_Record'); fd.append( 'dbName', $scope.dbName);  fd.append('root_P', $scope.rootP);  fd.append('t_Name', $scope.selected.R_Table); fd.append('licenseNo', $scope.licenseNo);   
		$http.post ("pages/upload.php", fd, { transformRequest: angular.identity, headers: {'Content-Type': undefined} } ).then (function(response) {  $scope.ddd= response.data;  }).error(function() { });
	}  
	$scope.getDisplayStafCert = function (temp,tN) { $scope.nPageC=0;
		var str1;  str1='<div class="row-fluid"> <div id=staffCRS href="" style="border-bottom:solid 1px; margin-top:5px;">Credit Hrs.<i><b style="color:red;">'+$scope.staffCertSummary[1]+ '</b></i></div>';    str3= str1+ '<div style="margin-top:5px;">' + 'Click button :&nbsp;<a id=printBtn type="submit" ng-disabled="true" class="btn" ng-click="" name="openWindow" value="">Print</a></div><div style="margin-top:5px;">' + '<a id=printRenewal type="submit" ng-disabled="true" class="btn" ng-click="" name="openWindow" value="">Renewal</a></div></div>';	
		var x=document.getElementById("summy"); x.innerHTML= str3;  var y=document.getElementById("printBtn"); y.onclick = $scope.printStafCert; var y=document.getElementById("printRenewal"); y.onclick = $scope.printRenewal; }
	$scope.getDisplaySummary = function (temp,tN) { $scope.tempArrJson['getName']='finRec'; $scope.getRecReport(); var str1='',str2='',str3=''; $scope.nPageC=0; 
		if (tN==='residentfinance') { var str1;  str1='<div class="row-fluid"><div style="border-bottom:solid 1px; margin-top:5px;">Inc.<i><b>'+ $scope.summary[0]['Income.Amt'] + '</b></i></div><div style="border-bottom:solid 1px; margin-top:5px;">Exp.<i><b>'+ $scope.summary[1]['Expnses.Amt'] + '</b></i></div><div style=" margin-top:5px; border-bottom:solid 1px;">Balance:&nbsp;<i><b style="color:red;">'+ $scope.summary[2]['Balance'] + '</b></i></div>';    str3= str1+ '<div style="margin-top:5px;">' + '<a id=printBtn type="submit" ng-disabled="true" class="btn btn-primary" ng-click="" name="openWindow" value="">Ledger</a></div></div>';	
			var x=document.getElementById("summy"); x.innerHTML= str3;  var y=document.getElementById("printBtn"); y.onclick = $scope.printRFinance; $scope.$digest(); }
	}
	$scope.getDisplayProgNote = function (temp,tN) { $scope.tempArrJson['getName']='progressNote'; $scope.getProgressNoteReport(); var str3='';  $scope.nPageC=0;  var da= new Date(temp[0]['maxDate']), dval; da.setDate(da.getDate()+1); dval= (da.getMonth()+1)+ '/'+(da.getDate())+'/'+da.getFullYear();  var str1;  str1='<div class="row-fluid"> <div style="border-bottom:solid 1px; margin-top:5px;"><i><b>'+ dval + '</b></i>(<i><b style="color:red;">'+ parseInt (temp[0]['DatesDiff']/7)+'</b></i> pass) </div>';    str3= str1+ ' <div style="margin-top:10px;">' + '<a id=printBtn type="submit" ng-disabled="true" class="btn btn-primary" ng-click="" name="openWindow" value="">Prog. Note</a></div></div>';	
		var x=document.getElementById("summy"); x.innerHTML= str3;  var y=document.getElementById("printBtn"); y.onclick = $scope.printRProgNote; $scope.$digest();
	}
	$scope.getDisplayFireDrill = function (temp,tN) {  $scope.tempArrJson['getName']='firedrillReport'; $scope.getfiredrillReport();  var str3='';  $scope.nPageC=0;   var da= new Date(temp[0]['maxDate']), dval; da.setDate(da.getDate()); dval= (da.getMonth()+1)+ '/'+(da.getDate())+'/'+da.getFullYear();  var dv=parseInt (temp[0]['DatesDiff']);  var str1;  str1='<div style="margin-top:5px;">Last Date: &nbsp;<i><b>'+ dval + '</b></i></div><div style="margin-top:7px;">'+ (dv>=0? 'Next In : &nbsp;<i><b style="color:red;">'+ dv+' days </b></i>':' Past <i><b>'+(-1*dv)+' </b></i> days') + '</div>';    str3= str1+ '<div style="margin-top:10px;">' + 'Click button to:&nbsp;<a id=printBtn type="submit" ng-disabled="true" class="btn" ng-click="" name="openWindow" value="">Print</a></div>';	
		var x=document.getElementById("summy"); x.innerHTML= str3;  var y=document.getElementById("printBtn"); y.onclick = $scope.printFireDrill; $scope.$digest();
	}
	$scope.getDisplayWeeklyMenu = function (temp,tN) { $scope.tempArrJson['getName']='weeklyMenuReport'; $scope.getweeklyMenuReport();  var str3='';  $scope.nPageC=0;  
	var da= new Date(temp[0][0]['maxDate']), dval; da.setDate(da.getDate()+1); dval= (da.getMonth()+1)+ '/'+(da.getDate())+'/'+da.getFullYear();  
	str1='<div style="margin-top:5px; ">Last Date: &nbsp;<i><b style="color:red;">'+ dval + '</b></i></div>';    str3= str1+ '<div style="border-radius:4px; margin-top:7px; margin-left:0px; border:solid 1px;">' +'<a id=printBtn type="submit" ng-disabled="true" class="btn" ng-click="" name="openWindow" value="">Print</a>&nbsp; <a id="createWeeklyMenu" type="submit" ng-disabled="true" class="btn" ng-click="">Create Menu</a></div>';		
	var x=document.getElementById("summy"); x.innerHTML= str3;  var y=document.getElementById("printBtn"); y.onclick = $scope.printWeeklyMenu;  var z=document.getElementById("createWeeklyMenu"); z.onclick = $scope.insertWeeklyMenu; 
	}	
$scope.printRenewal = function () {  
	var tdata= $rootScope.logRec[$cookies.get ('licNo')]; var fName= tdata['OpFName'], mName= tdata['OpMName'], LName= tdata['OpLName'], preBy;  var x=document.getElementById("printRenewal");  
		var myWindow = window.open("", "Print", "width='+screen.width+',height='+screen.height+'");  var page=''; //alert ('lic no'+ $cookies.get ('licNo') + '\n Page C' + $scope.nPageC + '\n Name: '+ LName+ ' \n'+$scope.staffCertSummary[0].length); 
	if ($scope.nPageC===0) 
		{ 	
		var links= "<link rel=stylesheet href='css/bootstrap-responsive.css' media=all type=text/css><link rel=stylesheet href='css/Bootstrap.min.css' media=all type=text/css><link rel='stylesheet' href='css/ui-bootstrap-2.5.0-csp.css' type='text/css'> <link rel='stylesheet' href='css/printable.css' type='text/css'>";  
		var t=500, r=125, w=150, backIm="background-image: url(img/renewal/developedBy.jpg)!important; background-repeat: repeat-x;"; 

		var tprec=$scope.Records[$scope.rowNo]; var OIS='', BCR='', CGApp='', CPR='', FAID='';  
		 	for (var i=0; i<$scope.staffCertSummary[0].length; i++)
			{ var tda= new Date ($scope.staffCertSummary[0][i]['maxDate']), tcurD= new Date();   tcurD=(tcurD.getMonth()+1)+ '/'+(tcurD.getDate()+1)+'/'+tcurD.getFullYear(); tda.setDate(tda.getDate());  tda=(tda.getMonth()+1)+ '/'+(tda.getDate()+1)+'/'+tda.getFullYear(); var tcrscd= $scope.staffCertSummary[0][i]['CrsCode'];  
			  if (tcrscd==='Faid') FAID= tda; else if (tcrscd==='CPR/AED') CPR= tda; else if (tcrscd==='DD-Operator' || tcrscd==='DD-Caregiver' ) CGApp= tda;  else if (tcrscd==='LTCR/BCR') BCR= tda;  else if (tcrscd==='OIS') OIS= tda; 
			}
		var str, end, da, bodyp='';  da= new Date(), da.setDate(da.getDate()) ,d=(da.getMonth()+1)+ '/'+(da.getDate())+'/'+da.getFullYear(); var OpDb= new Date(tdata['OpDb']); OpDb.setDate(OpDb.getDate()+1); OpDb=(OpDb.getMonth()+1)+ '/'+(OpDb.getDate())+'/'+OpDb.getFullYear();
		bodyp=bodyp + "<div class='container page' style='margin:0px; "+ backIm+"'><div class=row style='margin:-25px; position: relative; "+ backIm+"'>"+(cssSettingCont(t-500,r+125,w+200, '<b style=font-size:16px;>'+tdata['Name'].toUpperCase()+'</b>', '#e0e0e0')+ cssSettingCont(t-475,r+125,w+200, '<b style=font-size:16px;>'+tdata['OpAddress']+ ' '+ tdata['OpCity']+ '  '+ tdata['OpState'] + '  '+ tdata['OpZipCode']+'</b>', '#FFD39B') + cssSettingCont(t-450,r+150,w+150, '<b style=font-size:16px;>License Renewal Packet 2021-2022</b>', '#e0e0e0')+ cssSettingCont(t-400,r+50,w+375, 'Page Contents <span style=float:right;> Number of Pages</span>', '#FFD39B'))+(cssSettingCont(t-375,r+50,w+375, '1) This page <span style=float:right;> 1</span>', '#e0e0e0') + cssSettingCont(t-350,r+50,w+375, '2) CareHome WorkSheet <span style=float:right;> 2 - 3</span>', '#FFD39B') + cssSettingCont(t-325,r+50,w+375, '3) License Renewal Application <span style=float:right;> 4 - 10</span>', '#e0e0e0')+ cssSettingCont(t-300,r+50,w+375, '4) Authorization And Disclosure <span style=float:right;> 11 - 12</span>', '#FFD39B') + cssSettingCont(t-275,r+50,w+375, '5) Fee determination form <span style=float:right;> 13</span>', '#e0e0e0') + cssSettingCont(t-250,r+50,w+375, '6) Enrollement agreement <span style=float:right;> 14 - 19</span>', '#FFD39B') + cssSettingCont(t-225,r+50,w+375, '7) CPR/AED and First Aid Certificates <span style=float:right;> 20-21</span>', '#e0e0e0') + cssSettingCont(t-200,r+50,w+375, '8) Operators Certificates for Cotinued education <span style=float:right;> 22-26</span>', '#FFD39B') + cssSettingCont(t-175,r+50,w+375, '9) Staffing Plan <span style=float:right;> 27</span>', '#e0e0e0') + cssSettingCont(t-150,r+50,w+375, '10) Backup Operators Agreement <span style=float:right;> 28</span>', '#FFD39B'))+"</div></div>";  		
		bodyp=bodyp + "<div class='container page' style='margin:0px;'><div class=row style='margin:-25px; position: relative;'><img src='img/renewal/1. carehome worksheet_.jpg' style='width:8.5in;'></div></div>";  
		bodyp=bodyp + "<div class='container page' style='margin:0px; '><div class=row style='margin:-25px; position: relative;'><img src='img/renewal/2. carehome worksheet.jpg'  style='width:8.5in;'></div></div>"; 
		//bodyp=bodyp + "<div class='container page' style='margin:0px;'><div class=row style='margin:-25px; position: relative;'><img src='img/renewal/3. carehome worksheet.jpg'  style='width:8.5in;'>"+(cssSetting(t-500,r,w, '20 Hours') + cssSetting(t-465,r,w, '40 Hours') + cssSetting(t-430,r-10,w-150, '&#x2713')+  cssSetting(t-375,r,w, 'Current') )+ (cssSetting(t-275,r,w, 'Current') )+"</div></div>"; 
		bodyp=bodyp + "<div class='container page' style='margin:0px; border-top: solid 1px;'><div class=row style='margin:-50px; position: relative;'><img src='img/renewal/4. License Renewal Application page.jpg'  style='width:8.5in;'>"+ cssSetting(t-350,r+160,w, d)+ cssSetting(t-310,r+200,w+100, fName+ '  '+mName+ ' ' +LName)+ cssSetting(t-275,r+200,w+100, tdata['licenseNo'])+ cssSetting(t-90,r+440,w, '&#x2713')+ cssSetting(t-65,r+440,w, '&#x2713')+ cssSetting(t+50,r+440,w, '&#x2713')+ cssSetting(t+75,r+440,w, '&#x2713')+ cssSetting(t+120,r+440,w, '&#x2713')+ cssSetting(t+145,r+440,w, '&#x2713') + cssSetting(t+170,r+440,w, '&#x2713')+  cssSetting(t+235,r+440,w, '&#x2713')+ "</div></div>"; 	
		bodyp=bodyp + "<div class='container page' style='margin:0px; border-top: solid 1px;'><div class=row style='margin:-50px; position: relative;'><img src='img/renewal/4. License Renewal Application page 1.jpg'  style='width:8.5in;'>"+ (cssSetting(t-280,r+400,w, LName)+ cssSetting(t-240,r+400,w, fName) + cssSetting(t-200,r+400,w, mName)+ cssSetting(t-160,r+400,w, 'N/A')+ cssSetting(t-130,r+430,w, tdata['HomePhone']) + cssSetting(t-92,r+430,w, tdata['CellPhone']))+ (cssSetting(t-280,r+60,w, tdata['OpAddress'])+ cssSetting(t-240,r+60,w, tdata['OpCity']) + cssSetting(t-240,r-70,w, tdata['OpState']) + cssSetting(t-240,r-150,w, tdata['OpZipCode']) + cssSetting(t-200,r+60,w,'SAME')+ cssSetting(t-130,r+60,w, tdata['Email']))+ (cssSetting(t-50,r-245,w, '&#x2713')+ cssSetting(t-25,r-245,w, '&#x2713') + cssSetting(t+185,r-215,w, '&#x2713') + cssSetting(t+280,r-215,w, '&#x2713'))+ "</div></div>"; 	
		bodyp=bodyp + "<div class='container page' style='margin:0px;border-top: solid 1px;'><div class=row style= 'margin:-50px; position: relative;'><img src='img/renewal/4. License Renewal Application page 2.jpg'  style='width:8.5in;'>"+cssSetting(t-375,r-215,w, '&#x2713')+ cssSetting(t-260,r-215,w, '&#x2713')+ cssSetting(t-5,r+435,w, '&#x2713')+ cssSetting(t,r+200,w, '201112199CNA.')+ cssSetting(t+70,r+435,w, '&#x2713')+ cssSetting(t+70,r+200,w, 'Amharic')+ cssSetting(t+235,r+190,w, CPR)+ cssSetting(t+235,r+435,w, '&#x2713')+ cssSetting(t+260,r+210,w, CPR)+ cssSetting(t+260,r+435,w, '&#x2713')+"</div></div>"; 	 
		bodyp=bodyp + "<div class='container page' style='margin:0px; border-top: solid 1px;'><div class=row style='margin:-50px; position: relative;'><img src='img/renewal/4. License Renewal Application page 3.jpg'  style='width:8.5in;'>"+cssOperatorCrs()+ cssSetting(t+95,r-225, w, '&#x2713')+"</div></div>"; 	
		bodyp=bodyp + "<div class='container page' style='margin:0px;border-top: solid 1px;'><div class=row style='margin:-50px; position: relative;'><img src='img/renewal/4. License Renewal Application page 4.jpg'  style='width:8.5in;'>"+(cssSetting(t-270,r+400,w+40, 'Berhanemeskel Assefa') + cssSetting(t-230,r+400,w+40, tdata['Address']) + cssSetting(t-190,r+400,w+40,tdata['City']+'/'+ tdata['State']+'/'+tdata['Zipcode'])+ cssSetting(t-160,r+170,w+40,'503-922-9149'))+ (cssSetting(t-5,r+400,w+40, 'Samuel Enkosa') + cssSetting(t+30,r+400,w+40, tdata['OpAddress'])+ cssSetting(t+70,r+400,w+40,tdata['OpCity']+'/'+ tdata['OpState']+'/'+tdata['OpZipCode'])+ cssSetting(t+110,r+170,w+40,'971-280-4613'))+ "</div></div>"; 	
		bodyp=bodyp + "<div class='container page' style='margin:0px;border-top: solid 1px;'><div class=row style='margin:-50px; position: relative;'><img src='img/renewal/4. License Renewal Application page 5.jpg'  style='width:8.5in;'>"+(cssSetting(t-305,r+400,w+40, tdata['Address'])+ cssSetting(t-305,r-25,w+40, 'SAME') + cssSetting(t-265,r+400,w+40,tdata['City'])+ cssSetting(t-265,r+250,w+40,tdata['State']) +cssSetting(t-265,r+150,w+40, tdata['Zipcode'])+ cssSetting(t-230,r+405,w+40,tdata['HomePhone']) + cssSetting(t-230,r-25,w+40, tdata['Email']))+ (cssSetting(t-155,r+400,w+40, fName+' '+ LName)+ cssSetting(t-155,r+150,w+40,tdata['CellPhone'])+ cssSetting(t-160,r-225,w, '&#x2713'))+ (cssSetting(t-110,r+400,w+40, 'Berhanemeskel Asefa')+ cssSetting(t-110,r+150,w+40,'503-922-9149')+ cssSetting(t-115,r-180,w, '&#x2713'))+ (cssSetting(t-75,r-180,w, '&#x2713')+ cssStaffData())+ (cssSetting(t+195,r+400,w+15, 3) + cssSetting(t+195,r+275,w+15, 0) +cssSetting(t+195,r+200,w+15, 0)+cssSetting(t+195,r+100,w+15, 0)+cssSetting(t+195,r,w+15, 0) + cssSetting(t+195,r-110,w+15, 0)+cssSetting(t+195,r-210,w+15, 3))+ (cssSetting(t+260,r-45,w+15, '&#x2713'))+"</div></div>"; 	
		bodyp=bodyp + "<div class='container page' style='margin:0px;border-top: solid 1px;'><div class=row style='margin:-50px; position: relative;'><img src='img/renewal/4. License Renewal Application page 6.jpg'  style='width:8.5in;'>"+(cssSetting(t-335,r-170,w, '&#x2713')+cssSetting(t-230,r-215,w, '&#x2713')+ cssSetting(t-300,r+360,w+40, 'Berhanemeskel Assefa') + cssSetting(t-300,r+30,w+40, '503-922-9149')+  cssSetting(t-275,r+340,w+40, tdata['Address']) + cssSetting(t-275,r+170,w+40, tdata['City']) + cssSetting(t-275,r+70,w+40, tdata['State']) + cssSetting(t-275,r+20,w+40, tdata['Zipcode']))+  (cssSignature(t+380,r+400) + cssSetting(t+390,r+100,w+60, fName+' '+ mName+ ' ' + LName)+  cssSetting(t+390,r-190,w+40, d))+"</div></div>"
		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin:-50px; position: relative;'><img src='img/renewal/5. Authorization 1.jpg'  style='width:8.5in;'>"+ (cssSetting(t-340,r+400,w, LName)+ cssSetting(t-300,r+400,w, 'N/A')+ cssSetting(t-340,r+150,w, fName)+ cssSetting(t-340,r-50,w, mName.substring(0, 1)+'.')+ cssSetting(t-340,r-140,w, OpDb))+"</div></div>";   	
		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin:-50px; position: relative;'><img src='img/renewal/5. Authorization_two.jpg'  style='width:8.5in;'>"+ (cssSignature(t-325,r+400) + cssSetting(t-315,r-60,w, d)+  cssSetting(t-260,r+370,w+60, fName+' '+ mName+ ' ' + LName)+ (cssInitial(t+155,r+445)+ cssInitial(t+155,r+70)+ cssInitial(t+155,r-100))+ cssSignature(t+360,r+400) + cssSetting(t+425,r+380,w+60, fName+' '+ mName+ ' ' + LName)+  cssSetting(t+370,r-60,w+40, d))+"</div></div>"; 	
		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin:-50px; position: relative;'><img src='img/renewal/6. Fee Determination.jpg'  style='width:8.5in;'>"+(cssSetting(t-355,r+290,w+60, fName+ ' ' + LName)+ cssSetting(t-360,r-165,w, tdata['licenseNo']))+(cssSetting(t-325,r+220,w, '5')+cssSetting(t-325,r-175,w+10, '$300.00'))+ (cssSetting(t+480,r-190,w+10, '$300.00'))+"</div></div>"; 	
	bodyp=bodyp + "<div class='container page' style='margin:0px; "+ backIm+"'><div class=row style='margin:-25px; position: relative;'>"+(cssSettingCont(t-500,r+125,w+200, '<b style=font-size:16px;>'+tdata['Name'].toUpperCase()+'</b>', '#e0e0e0')+ cssSettingCont(t-475,r+125,w+200, '<b style=font-size:16px;>'+tdata['Address']+ ' '+ tdata['City']+ '  '+ tdata['State'] + '  '+ tdata['Zipcode']+'</b>', '#FFD39B') + cssSettingCont(t-450,r+150,w+250, '<b style=font-size:16px;>Medicaid Provider Enrollement Agreement - 2021 </b>', '#e0e0e0')+ cssSettingCont(t-400,r+50,w+375, 'Page Contents <span style=float:right;> Number of Pages</span>', '#FFD39B'))+(cssSettingCont(t-375,r+50,w+375, '1) This page <span style=float:right;> 1</span>', '#e0e0e0') + cssSettingCont(t-350,r+50,w+375, '2) Medicaid Provider Enrollement <span style=float:right;> 2 - 7</span>', '#FFD39B')) +"</div></div>";  		

		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin:-50px; position: relative;'><img src='img/renewal/7. Medicaid Enrollement 1.jpg'  style='width:8.5in;'>"+(cssSetting(t-315,r+400,w+40, tdata['Address']) + cssSetting(t-315,r+80,w, tdata['City'])+ cssSetting(t-315,r-60,w, tdata['State'])+ cssSetting(t-315,r-140,w, tdata['Zipcode'])) +(cssSetting(t-275,r+400,w, 'SAME'))+(cssSetting(t-230,r+400,w+40, tdata['HomePhone'])+cssSetting(t-230,r+80,w, '527685')+ cssSetting(t-230,r-140,w, '5'))+ cssSetting(t-200,r+130,w+60, fName + ' '+ mName + ' ' + LName)+ cssSetting(t-142,r+100,w, '&#x2713') + cssSetting(t-30,r+395,w, '&#x2713')+"</div></div>"; 	
		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin:-50px; position: relative;'><img src='img/renewal/7. Medicaid Enrollement 2.jpg'  style='width:8.5in;'>"+(cssSetting(t-345,r+420,w, LName) + cssSetting(t-345,r+140,w, fName) + cssSetting(t-345,r-40,w, mName.substring(0, 1)+'.')+ cssSetting(t-360,r-135,w, 'Operator'))+ (cssSetting(t-300,r+420,w+40, tdata['OpAddress'])+cssSetting(t-300,r+140,w, tdata['OpCity'])+ cssSetting(t-300,r-40,w, tdata['OpState'])+ cssSetting(t-300,r-100,w, tdata['OpZipCode']))+ (cssSetting(t-260,r+420,w, '185-82-2395')+cssSetting(t-260,r+140,w, OpDb)+ cssSetting(t-260,r-40,w, tdata['CellPhone']))+ (cssSetting(t-235,r+255,w, '100'))+  (cssSetting(t-210,r+45,w, '&#x2713')+cssSetting(t-185,r+140,w, '&#x2713')+ cssSetting(t-165,r+45,w, '&#x2713')+cssSetting(t-95,r+45,w, '&#x2713'))+ cssSetting(t-20,r+420,w, 'N/A')+ cssSetting(t+300,r+420,w, 'N/A')+ "</div></div>"; 	 
		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin:-50px; position: relative;'><img src='img/renewal/7. Medicaid Enrollement 3.jpg'  style='width:8.5in;'>"+cssSetting(t-375,r+420,w, 'N/A')+ cssSetting(t-250,r-55,w, '&#x2713') +  cssSetting(t-85,r+420,w, 'N/A')+ cssSetting(t+215,r+420,w, 'N/A')+ "</div></div>"; 	
		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin:-50px; position: relative;'><img src='img/renewal/7. Medicaid Enrollement 4.jpg'  style='width:8.5in;'>"+cssSetting(t-335,r+420,w, 'N/A')+"</div></div>"; 	
		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin:-50px; position: relative;'><img src='img/renewal/7. Medicaid Enrollement 5.jpg'  style='width:8.5in;'></div></div>"; 	
		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin:-50px; position: relative;'><img src='img/renewal/7. Medicaid Enrollement 6.jpg'  style='width:8.5in;'>"+cssSignature(t-435,r+420)+ cssSetting(t-425,r-150, w, d)+"</div></div>"; 	
		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin-left: 50px; position: relative; -webkit-transform: scale(1.15); transform: scale(1.15);'><img src='img/renewal/8. CPRTseNeg.jpg' style='width:5in; height:5in;'><img src='img/renewal/8. CPRSamEnk.jpg' style='width:5in; height:5in;'></div></div>"; 	
		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin-left: 50px; position: relative; -webkit-transform: scale(1.15); transform: scale(1.15);'><img src='img/renewal/8. CPRBREASS.jpg' style='width:5in; height:5in;'><img src='img/renewal/8. CPRGetTib.jpg' style='width:5in; height:5in;'></div></div>"; 	
		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin-left: 25px; position: relative;'><img src='img/renewal/9. Anger management.jpg' style='width:7.5in; height:10in;'></div></div>"; 
		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin-left: 25px; position: relative;'><img src='img/renewal/9. Older Adults  and depression.jpg' style='width:7.5in; height:10in;'></div></div>"; 		
		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin-left: 25px; position: relative;'><img src='img/renewal/9. Injury prevention.jpg' style='width:7.5in; height:10in;'></div></div>"; 		
		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin-left: 25px; position: relative;'><img src='img/renewal/9. Improving hand hygiene.jpg' style='width:7.5in; height:10in;'></div></div>";
		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin-left: 25px; position: relative; '><img src='img/renewal/9. End of Life.jpg' style='width:7.5in; height:10in;'></div></div>"; 	
 		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin-left: 25px; position: relative;'><img src='img/renewal/10. Staffing Plan 2021.jpg' style='width:7.5in; height:10in;'></div></div>"; 	
		bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin:-50px; position: relative;'><img src='img/renewal/11. Backup operator 2021 updated.jpg'  style='width:8.5in;'>"+  (cssSignature(t+235,r+240) +cssSetting(t+250,r-60,w+40, d))+"</div></div>"; 	
		//bodyp=bodyp + "<div class='container page' style='margin: 0px;'><div class=row style='margin:-50px; position: relative;'><img src='img/renewal/11. Backup operator 2021 updated.jpg'  style='width:8.5in;'>"+ (cssSetting(t-270,r+250,w+60, fName + ' '+ LName) + cssSetting(t-270,r-100,w+60, 'Berhanemeskel Asefa')) + (cssSetting(t-250,r+300,w+40, tdata['HomePhone']) + cssSetting(t-250,r-60,w+60, tdata['CellPhone'])) + (cssSetting(t-233,r+130,w+200, tdata['OpAddress']+ ', '+ tdata['OpCity'] + ' '+ tdata['OpState']+ ' '+ tdata['OpZipCode']))+ (cssSetting(t-215,r+275,w+40, tdata['licenseNo'])+ cssSetting(t-217,r+10,w-10, tdata['lictype'])+ cssSetting(t-217,r-170,w+40, '5'))+ (cssSignature(t+250,r+250) +cssSetting(t+260,r-60,w+40, d))+"</div></div>"; 	
	x.innerHTML="Close"; $scope.nPageC=1; myWindow.document.write(links + bodyp); //links+page); 
	}  
else if ($scope.nPageC===1) { $scope.nPageC=0;  myWindow.close(); x.innerHTML="Renewal"; }    
}
function cssSetting(t,r,w,cont) {  var s1="'margin:0px; font-style: italic;  position: absolute; padding: 0px; top: "+ t +"px; right: "+r+"px; width:"+ w+ "px;'";	return ("<div style="+s1+">"+cont+"</div>");  }
function cssSettingCont(t,r,w,cont, color) {  var s1="'border-radius:5px; background-color: "+ color +" !important; margin:0px; position: absolute; padding: 0px; top: "+ t +"px; right: "+(r-100)+"px; width:"+ w+ "px;'";	return ("<div style="+s1+">"+cont+"</div>");  }
function cssStaffData () { var t=510, r=135, str='',da,d, w=150, filRec= $scope.Records.filter(x => x.PrevName !== 'Operator' && x.Dis==0 );  filRec.sort(); for (var i=0, t1=40; i<filRec.length; i++,t1=t1-22) {  da= new Date(filRec[i]['EmpBD']), da.setDate(da.getDate()+1) ,d=(da.getMonth()+1)+ '/'+(da.getDate())+'/'+da.getFullYear(); str=str+ cssSetting(t-t1,r+400,w+40, filRec[i]['EmpFName'] + ' '+ filRec[i]['EmpLName']) + cssSetting(t-t1,r+200,w, d) +  (filRec[i]['Live']==='0'? '': cssSetting(t-t1,r-75,w, '&#x2713')) + (filRec[i]['PrevName']==='Family'? '': cssSetting(t-t1,r-110,w, '&#x2713' ));  } /*str=str + cssSetting(t-40,r-75,w, '&#x2713') + cssSetting(t-20,r-75,w, '&#x2713' )+ cssSetting(t+5,r-75,w, '&#x2713') + cssSetting(t+45,r+400,w+40, 'Fikirte Rumicho') + cssSetting(t+45,r-75,w, '&#x2713'  ) ; */ return str; }
function cssOperatorCrs () { var t=510, r=140, str='', da,d, w=150, tdata=$scope.staffCertSummary[1];  for (var i=0, t1=0; i<tdata.length; i++,t1=t1-40) { da= new Date(tdata[i]['Certtaken']), da.setDate(da.getDate()+1) ,d=(da.getMonth()+1)+ '/'+(da.getDate())+'/'+da.getFullYear(); str=str+ cssSetting(t-185+t1,r+140,w+300, tdata[i]['certification'].substring (0, 60)) + cssSetting(t-180+t1,r-60,w, d ) + cssSetting(t-180+t1,r-220,w, tdata[i]['CrHrs']); } str=str +  cssSetting(t+140+t1,r-220,w, $scope.staffCertSummary[2]) ; return str;}
function cssSignature(t,r) {  var s1="'margin:0px; position: absolute; padding: 0px; top: "+ t +"px; right: "+r+"px;'";	return ("<div style="+s1+"><img src='img/renewal/Tseli_Signature updated.jpg' style='width:120px; height:30px;'>&nbsp;</div>");  }
function cssInitial(t,r) {  var s1="'margin:0px; position: absolute; padding: 0px; top: "+ t +"px; right: "+r+"px;'";	return ("<div style="+s1+"><img src='img/renewal/Tseli_Initial.jpg' style='width:30px; height:30px;'>&nbsp;</div>");  }
$scope.printStafCert = function () {  
	 var fName=  $rootScope.logRec[$cookies.get ('licNo')]['OpFName'], mName= $rootScope.logRec[$cookies.get ('licNo')]['OpMName'], LName= $rootScope.logRec[$cookies.get ('licNo')]['OpLName'], preBy;  var x=document.getElementById("printBtn"); 
		var myWindow = window.open("", "Print", "width='+screen.width+',height='+screen.height+'");  var page=''; //alert ( 'Page C' + $scope.nPageC + '\n Name: '+ LName+ ' \n'+$scope.staffCertSummary[0].length); 
	if ($scope.nPageC===0) 
		{ 	
		var links= "<link rel=stylesheet href='css/bootstrap-responsive.css' media=all type=text/css><link rel=stylesheet href='css/Bootstrap.min.css' media=all type=text/css><link rel='stylesheet' href='css/ui-bootstrap-2.5.0-csp.css' type='text/css'> <link rel='stylesheet' href='css/printable.css' type='text/css'>";  
//var s11="'font-style: italic; font-weight: bold; position: absolute; top: 125px; right: 62.5px; background-color: red; color: black; padding-left: 20px; padding-right: 20px; width:5cm; border:solid 1px; border-radius:3px;'", s21="'font-style: italic; font-weight: bold; position: absolute; top: 145px; right: 62.5px; background-color: red; color: black; padding-left: 20px; padding-right: 20px; width:5cm; border:solid 1px; border-radius:3px;'";  var s31="'font-style: italic; font-weight: bold; position: absolute; top: 165px; right: 62.5px; background-color: red; color: black; padding-left: 20px; padding-right: 20px; width:5cm; border:solid 1px; border-radius:3px;'"; var s32="'font-style: italic; font-weight: bold; position: absolute; top: 185px; right: 62.5px; background-color: red; color: black; padding-left: 20px; padding-right: 20px; width:5cm; border:solid 1px; border-radius:3px;'"; var s41="'font-style: italic; font-weight: bold;position: absolute; top: 225px; right: 62.5px; background-color: red; color: black; padding-left: 20px; padding-right: 20px; width:5cm; border:solid 1px; border-radius:3px;'";  
		var  s1="'float: left; border-right: solid 1px; border-left:solid 1px; border-bottom:solid 1px; width: 1cm; border-radius:5px;'", s2="'float: left; border-right: solid 1px; border-left:solid 1px; border-bottom:solid 1px; width: 2cm; border-radius:5px;'",s3="'float: left; border-right: solid 1px; border-left:solid 1px; border-bottom:solid 1px; width: 3cm; border-radius:5px;'", s4="'margin:0px; float:left; border-bottom:solid 1px; border-top:solid 1px; border-right:solid 1px;  width:8.5in;'",  s42="'float:left; margin:0px; border-left:solid 1px; border-right:solid 1px; border-top:solid 1px;border-radius:2px; width:6.323cm;'", s43="'float:left; margin:0px; border-left:solid 1px; border-right:solid 1px; border-top:solid 1px;border-radius:2px; width:9.475cm;'",  s44="'float:left; margin:0px; border-left:solid 1px; border-right:solid 1px; border-top:solid 1px;border-radius:2px; width:12.65cm;'"; var s10="'margin:0px; color:red; text-align: left; font-weight: normal; font-family: Helvetica, Arial, sans-serif; font-size:12px'"; s9="'width=100%; margin:10px; float: left;  height: 50px; text-align: left; font-family: Helvetica, sans-serif; font-size:24px; '";
		var tprec=$scope.Records[$scope.rowNo];  
		var bodyp='', header='', cont=cont + "<div class='container page' style=''>";   
		header=header + "<div class=row style='width:8.5in;border-bottom:solid 1px; margin:0px;'><div style='margin:10px; font-size:20px;'>The Way of Life Group Home LLC</div></div>";
		bodyp=bodyp + "<div class=row style='width:8.5in; margin:0px;'><div style='margin:10px; font-size:20px;'><i><b>"+ tprec['EmpFName']+' ' + tprec['EmpMName']+ ' ' + tprec['EmpLName']+ "</b></i></div>";	
		bodyp=bodyp+ "<div class=row style='width:8.5in; margin:0px;'><div style="+s1+"><b> SNo.</b></div><div style="+s3+"><b> CRS.ID</b></div><div style="+s43+"><b> Crs Name</b></div><div style="+s3+"><b> Completed</b></div><div style="+s2+"><b> CR/hrs</b></div></div>";		
		 	for (var i=0; i<$scope.staffCertSummary[0].length; i++)
			{ 
			var tda= new Date ($scope.staffCertSummary[0][i]['maxDate']), tcurD= new Date();   tcurD=(tcurD.getMonth()+1)+ '/'+(tcurD.getDate()+1)+'/'+tcurD.getFullYear(); tda.setDate(tda.getDate());  tda=(tda.getMonth()+1)+ '/'+(tda.getDate()+1)+'/'+tda.getFullYear(); tcrscd= $scope.staffCertSummary[0][i]['CrsCode'];  
		bodyp=bodyp+ "<div class=row style='width:8.5in; margin-left:0px;'><div style="+s1+">"+(i+1)+")</div><div style="+s3+"> "+$scope.staffCertSummary[0][i]['CrsCode']+"</div><div style="+s43+"> "+$scope.staffCertSummary[0][i]['certification']+"</div><div style="+s3+"> "+$scope.staffCertSummary[0][i]['maxDate']+"</div><div style="+s2+"> "+$scope.staffCertSummary[0][i]['CrHrs']+"</div></div>";
}
		//var str, end, da, i=0, p=0,lines=0, bodyp='';   da= new Date(tprec['HiredD']), da.setDate(da.getDate()+1) ,d=(da.getMonth()+1)+ '/'+(da.getDate())+'/'+da.getFullYear();
		bodyp=bodyp+ "<div class=row style='width:8.5in; margin:0px;'><div style="+s1+">-</div><div style="+s3+"></div><div style="+s43+"></div><div style="+s3+">Total Cr.Hrs.</div><div style="+s2+">"+$scope.staffCertSummary[1]+"</div></div>";
		bodyp=cont+ header + bodyp + '</div>';
		
	x.innerHTML="Close"; $scope.nPageC=1; myWindow.document.write(links + bodyp); //links+page); 
	}  
else if ($scope.nPageC===1) { $scope.nPageC=0;  myWindow.close(); x.innerHTML="Print"; } 
}
$scope.printWeeklyMenu = function() { var fHomeName=$scope.weeklyMenuSummary[0][0]['Name']; address= $scope.weeklyMenuSummary[0][0]['Address']; city=$scope.weeklyMenuSummary[0][0]['City']; state=$scope.weeklyMenuSummary[0][0]['State'];  zipcode=$scope.weeklyMenuSummary[0][0]['Zipcode']; var x=document.getElementById("printBtn"); 
		var myWindow = window.open("", "Print", "width='+screen.width+',height='+screen.height+'");  title= fHomeName + '<br>' + address + '  ' +city + '  ' + state +' ' + zipcode; $scope.dateRange='xxxxx';
	if ($scope.nPageC==0)  {  var links= "<link rel=stylesheet href='css/bootstrap-responsive.css' media=all type=text/css><link rel=stylesheet href='css/Bootstrap.min.css' media=all type=text/css><link rel='stylesheet' href='css/ui-bootstrap-2.5.0-csp.css' type='text/css'> <link rel='stylesheet' href='css/PrintableLandscape.css' type='text/css'>";  var s1="'margin-left:0px; float: left; text-align: left; font-family: Arial, Helvetica, sans-serif; border-right:solid 1px; font-size:20px;'"; 
		var col1="col-xs-1 col-sm-1 col-md-1 col-lg-1", col2="col-xs-2 col-sm-2 col-md-2 col-lg-2", col8="col-xs-8 col-sm-8 col-md-8 col-lg-8"; var s5="'margin-left:-10px; font-weight:normal;'";var s1="'margin:5px; color:red; text-align: left; font-weight: normal; font-family: Helvetica, Arial, sans-serif; font-size:12px;'", s11="'margin:5px; color:blue; text-align: left; font-weight: normal; font-family: Helvetica, Arial, sans-serif; font-size:12px;'", s2="'border:solid 1px; font-weight:bold; height:2cm; font-size:12px; width:10.5cm;'", s3="'margin:0px;  border-left: solid 1px; font-weight: bold; font-size: 16px; float:left; width:3.75cm; height:1cm'; border-left:solid 1px;'", s4="'margin:0px; border-left: solid 1px; font-size: 11px; float:left; width:3.75cm; height:3.75cm'; border-left:solid 1px;"; var s5="'margin-left:-10px; font-weight:normal;'";
		var str, end, da, iInitial,  i=0,  iter=1, days=0, p=0,lines=0, bodyp='', cont='', rlink='', footer='', bfast='', lun='', din='',mcat='', header='', breakfast='',lunch='', dinner='';   da= new Date($scope.weeklyMenuSummary[0][0]['maxDate']), da.setDate(da.getDate()+1), maxd=(da.getMonth()+1)+ '/'+(da.getDate()+1)+'/'+da.getFullYear();
				da= new Date($scope.weeklyMenuSummary[0][0]['minDate']); mind=da.getDay(); 	
		cont=cont + "<div class='container page' style='margin: 20px;'>";  				
		footer=footer + "<div class=row style='width:27cm;'><div> <p style='font-weight:normal; font-size:13.75px; margin:5px;'>SNACKS AVAILABLE THIS WEEK INCLUDE: Sliced Fresh Fruits, i.e.: <u>apples, blueberries, plums (if in season), jello varities.</u></p></div></div>";
		footer=footer + "<div class=row style='width:27cm;'><div><p style='font-weight:normal; font-size:12px; margin:5px;'>TIPS: Offer nutritious snacks and liquids as meal supplements at least twice dail; indicate when you serve FRESH fruits & vegetables; document substitutions.</p></div></div>";
		footer=footer + "<div class=row style='width:27cm;'><div><p style='font-weight:bold; font-size:13.75px; margin:5px;'>Breakfast is served at: 8:00 A.M, Lunch is served at: 12:30 P.M, Dinner is served at: 6:00 P.M</p></div></div>";
		footer=footer + "<div class=row style='width:27cm;'><div><p style='float:left; margin:10px; font-style:italic; font-weight:normal;'>ACHP Recommended Weekly Menu Form Revised 10/2016</p></div> <div><p style='float:right; margin:20px; font-style:italic; font-weight:normal;'>Retension Schedule: Retain weekly menus in facility records for 3 years</p></div></div>";
		//parseInt ($scope.weeklyMenuSummary[0][0]['MaxMinDiff']) +1;
		ida= new Date($scope.weeklyMenuSummary[1][0]['MenuDate']);  ida=ida.getDay(); iInitial=61;/* 11/31/2021 */var arrsize= 150;//from 08/01/2021 to 01/31/2022 180 days 
		for (var i= iInitial; i<=arrsize; i++) 
		{   if (iter==1) { var da= new Date($scope.weeklyMenuSummary[i][0]['MenuDate']);  da.setDate(da.getDate()+2); mind= (da.getMonth()+1)+ '.'+(da.getDate())+'.'+(da.getYear()-100); da.setDate(da.getDate()+6); mind=mind +'-' + (da.getMonth()+1)+ '.'+(da.getDate())+'.'+(da.getYear()-100); //.substring(2);  //$temp.substring(0, 7)		
		header=header + "<div class=row style='width:27cm;'><div> &nbsp; <p style='float:left; font-weight: bold; font-size: 20px;'>"+ title  + "</p> </div><div> <p style='float:right; font-weight: bold; font-size: 20px;'>MENU FOR THE WEEK OF <u><i>"+ mind +"</i></u></p></div></div>";
 		header=header + "<div class=row style='width:27cm; border:solid 1px;'><div style="+s3 +">Sunday</div><div style="+s3 +">Monday</div><div style="+s3 +">Tuesday</div><div style="+s3 +">Wendsday</div><div style="+s3 +">Thursday</div><div style="+s3 +">Friday</div><div style="+s3 +">Saturday</div></div>";		
		bodyp=bodyp + cont + header; breakfast="<div class=row style='width:27cm; border:solid 1px;'>"; lunch="<div class=row style='width:27cm; border:solid 1px;'>"; dinner="<div class=row style='width:27cm; border:solid 1px;'>"; } 
		var len=$scope.weeklyMenuSummary[i].length; bfast=''; lun=''; din=''; meal=''; mcat=''; rlink=''; msno='', cveg=0;
		for (var mloop=0; mloop<len; mloop++)  {msno=$scope.weeklyMenuSummary[i][mloop]['MealSno']; mcat=$scope.weeklyMenuSummary[i][mloop]['MealCat'];  meal=$scope.weeklyMenuSummary[i][mloop]['MealName']; rlink=$scope.weeklyMenuSummary[i][mloop]['RecipeLink']; rlink= (rlink!=null) ? "<a class='hide-for-print' href='" + rlink+ "' target='_blank'>video link</a>" : ' ' ;
			if (mcat=='Meal BreakFast')  bfast='('+ msno +') ' + bfast+ meal + rlink;  else if (mcat=='Meal Lunch')  lun='('+ msno +') ' + lun+ meal + rlink;  else if (mcat=='Meal Dinner')  din='('+ msno +') ' + din+ meal + rlink;  else if (mcat=='Veggies/Fruits') { if (cveg==0) { cveg++; bfast=bfast+ '('+ msno +') ' + meal + rlink; }   else if (cveg==1) { cveg++; lun=lun+  '('+ msno +') ' + meal + rlink; }   else if (cveg==2) { cveg++;din=din+  '('+ msno +') ' + meal;  } } else if (mcat=='Drinks/Beverages') { bfast=bfast+ '('+ msno +')' + meal + rlink + '<br>'; lun=lun+ '('+ msno +')' + meal + rlink+ '<br>';  din=din+ '('+ msno +')' + meal + rlink+ '<br>'; }
			}
		breakfast=breakfast + "<div style="+s4 +"><p style="+s1+ ">"+  bfast + "</p></div>";  lunch=lunch + "<div style="+s4 +"><p style="+s1+ ">"+ lun + "</p></div>";  dinner=dinner + "<div style="+s4 +"><p style="+s1+ ">"+ din +   "</p></div>";  
		if (iter%7==0) {  bodyp=  bodyp +  breakfast + "</div>" + lunch + "</div>" + dinner + "</div>"+footer+"</div></div>";  header=''; breakfast=''; lunch=''; dinner=''; bfast=''; lun=''; din='';  iter=1; }
		else if (iter%7!=0 && i==arrsize) {  bodyp=  bodyp +  breakfast + "</div>" + lunch + "</div>" + dinner + "</div>"+footer+"</div></div>"; footer=''; header=''; breakfast=''; lunch=''; dinner=''; bfast=''; lun=''; din='';  iter=0; }
		else iter=iter+1;
		} 
	x.innerHTML="Close"; $scope.nPageC=1; myWindow.document.write(links+ bodyp);  
	}  
else if ($scope.nPageC==1) { bodyp=''; $scope.nPageC=0;  myWindow.close(); x.innerHTML="View"; } 
}

$scope.printFireDrill = function() { $rootScope.logRec= $cookies.getObject('logRec'); var fName= $rootScope.logRec[0]['OpFName'], LName= $rootScope.logRec[0]['OpLName'], preBy;  var x=document.getElementById("printBtn"); 
		var myWindow = window.open("", "Print", "width='+screen.width+',height='+screen.height+'");  var page=''; 
	if ($scope.nPageC==0) 
		{ 	ij= $scope.assrowNo;
	//for (var ij=4; ij < $scope.fdReport.length; ij++)  
	//{	 
		var links= "<link rel=stylesheet href='css/bootstrap-responsive.css' media=all type=text/css><link rel=stylesheet href='css/Bootstrap.min.css' media=all type=text/css><link rel='stylesheet' href='css/ui-bootstrap-2.5.0-csp.css' type='text/css'> <link rel='stylesheet' href='css/printable.css' type='text/css'>";  var s1="'margin-left:0px; float: left; text-align: left; font-family: Arial, Helvetica, sans-serif; border-right:solid 1px; font-size:20px;'", s2="'margin-left:0px; float: left; height: 20px; text-align: left; font-family: Helvetica, sans-serif; border-right:solid 1px; font-size:10px; width:12.5%'"; 
		var col1="col-xs-1 col-sm-1 col-md-1 col-lg-1", col2="col-xs-2 col-sm-2 col-md-2 col-lg-2", col8="col-xs-8 col-sm-8 col-md-8 col-lg-8"; var s5="'margin-left:-10px; font-weight:normal;'";var s1="'margin-left:0px; color:red; text-align: left; font-weight: normal; font-family: Arial, Helvetica, sans-serif; font-size:12px;'", s2="'margin-left:0px; float: left; height: 12px; text-align: left; font-family: Helvetica, sans-serif; border-right:solid 1px; font-size:10px; width:12.5%'"; var col1="col-xs-1 col-sm-1 col-md-1 col-lg-1", col2="col-xs-2 col-sm-2 col-md-2 col-lg-2", col8="col-xs-8 col-sm-8 col-md-8 col-lg-8"; var s5="'margin-left:-10px; font-weight:normal;'";
		var str, end, da, i=0, p=0,lines=0, bodyp='';   da= new Date($scope.fdReport[ij][0]['EvacDriDate']), d=(da.getMonth()+1)+ '/'+(da.getDate()+1)+'/'+da.getFullYear();
		bodyp=bodyp + "<div id=printResFinance class='container page' style='margin: 0px;'><div class=row style='margin:0px; width:19cm;'><img src=img/pict/fireDrill1.jpg style='width:19cm;'></div><div class=row style='border:solid 1px; margin-left: 0px; width:19cm;'><div style='border-right:solid 1px; font-weight:bold; height:18px; font-size:12px; width:5.25cm; float:left;'> &nbsp;Operator: <i style="+s1+">"+ $cookies.get('AfcOpName')  +"</i></div><div style=' border-right:solid 1px; float:left; margin-right: 1px; font-weight:bold; height:18px; font-size:12px; width:4cm;'> &nbsp;License #: <i style="+s1+">"+$rootScope.logRec[0]['licenseNo'].match(/\d+/g)+"</i></div><div style='float:left; margin-right: 1px; font-weight:bold; height:18px; font-size:12px;'> &nbsp;Drill Date: <i style="+s1+">"+d+"</i></div></div>"; 
		bodyp=bodyp + "<div class=row style='border-bottom:solid 1px; border-right:solid 1px; border-left:solid 1px; margin-left: 0px; width:19cm;'><div style='border-right:solid 1px; font-weight:bold; height:18px; font-size:12px; width:5.25cm; float:left;'> &nbsp;Sleeping Drill: <i style="+s1+">"+(( $scope.fdReport[ij][0]['SleepingDrill'] == 1) ? 'YES' :'NO')+"</i></div><div style='float:left; margin-right: 1px; font-weight:bold; height:18px; font-size:12px;'> &nbsp;Evacuation Route: <i style="+s1+">"+$scope.fdReport[ij][0]['EvacRoute']+"</i></div></div>";
		bodyp=bodyp + "<div class=row style='border-bottom:solid 1px; border-right:solid 1px; border-left:solid 1px; margin-left: 0px; width:19cm;'><div style='border-right:solid 1px; font-weight:bold; height:18px; font-size:12px; width:9.25cm; float:left;'> &nbsp;Location of simulated fire: <i style="+s1+">"+$scope.fdReport[ij][0]['LocSimFire']+"</i></div><div style='float:left; margin-right: 1px; font-weight:bold; height:18px; font-size:12px;'> &nbsp; Starting point for staff initiating drill: <i style="+s1+">"+$scope.fdReport[ij][0]['StPtStaffInitDril']+"</i></div></div>";
		bodyp=bodyp + "<div class=row style='border-bottom:solid 1px; border-right:solid 1px; border-left:solid 1px; margin-left: 0px; width:19cm;'><div style='font-weight:bold; height:18px; font-size:12px; float:left;'> &nbsp;Occupants alerted by: <i style="+s1+">"+$scope.fdReport[ij][0]['OcAlertBy']+"</i></div></div>";
		bodyp=bodyp + "<div class=row style='border-bottom:solid 1px; border-right:solid 1px; border-left:solid 1px; margin-left: 0px; width:19cm;'><div style='border-right:solid 1px; font-weight:bold; height:30px; font-size:12px; width:9.25cm; float:left;'> &nbsp;Initial Point of Safety (location): <i style="+s1+">"+$scope.fdReport[ij][0]['InitialPtSafety']+"</i></div><div style='float:left; margin-right: 1px; font-weight:bold; height:30px; font-size:12px;'> &nbsp; Final Point of Safety (location): <i style="+s1+">"+$scope.fdReport[ij][0]['FinalPtSafety']+"</i></div></div>";
		bodyp=bodyp + "<div class=row style='margin:0px; width:19cm;'><img src=img/pict/fireDrill2.jpg style='width:19cm;'></div>";
		bodyp=bodyp + "<div class=row style='border:solid 1px;  margin-left: 0px; width:19cm;'><div style='border-right:solid 1px; font-weight:bold; height:50px; font-size:12px; width:6cm; float:left;'> &nbsp;Evacuation Drill Start Time: <i style="+s1+"><br> &nbsp;"+$scope.fdReport[ij][0]['EvacDrilStTime']+"</i></div><div style=' border-right:solid 1px; float:left; margin-right: 1px; font-weight:bold; height:50px; font-size:12px; width:6cm'> &nbsp; Time to Initial Point of Safety: <i style="+s1+"> <br> &nbsp;"+$scope.fdReport[ij][0]['TimetoInitialPtSafety']+"</i></div><div style='float:left; margin-right: 1px; font-weight:bold; height:50px; font-size:12px; width:6cm'> &nbsp; Time to Final Point of Safety: <i style="+s1+"> <br> &nbsp;"+$scope.fdReport[ij][0]['TimetoFinalPtSafety']+"</i></div></div>";
		bodyp=bodyp + "<div class=row style=' border-bottom:solid 1px;margin:0px; width:19cm;'><img src=img/pict/fireDrill3.jpg style='width:19cm;'></div>";
		for (var i=0; i<$scope.fdReport[ij][2].length; i++) { var v2=$scope.fdReport[ij][2][i];
		bodyp=bodyp + "<div class=row style='border-bottom:solid 1px; border-left:solid 1px; border-right:solid 1px; margin-left: 0px; width:19cm;'><div style='border-right:solid 1px; font-weight:bold; height:18px; font-size:12px; width:4.761cm; float:left;'> &nbsp;<i style="+s1+">"+ v2['ResFName']+'  ' + v2['ResLName']+"</i></div><div style=' border-right:solid 1px; float:left; margin-right: 1px; font-weight:bold; height:18px; font-size:12px; width:5.20cm;'> &nbsp;<i style="+s1+">"+ ((v2['AssNeeded'] != null) ? (v2['AssNeeded']) :'') +"</i></div><div style='border-right:solid 1px; float:left; margin-right: 1px; font-weight:bold; height:18px; font-size:12px; width:4.25cm;'>&nbsp;<i style="+s1+">"+ ((v2['StPoint'] != null) ? (v2['StPoint']) :'') +"</i></div><div style='float:left; margin-right: 1px; font-weight:bold; height:18px; font-size:12px;'>&nbsp;<i style="+s1+">"+ ((v2['Note'] != null) ? (v2['Note']) : '')+"</i></div></div>";
		}
		bodyp=bodyp + "<div class=row style='margin:0px; width:19cm;'><img src=img/pict/fireDrill4.jpg style='width:19cm;'></div>";		
		bodyp=bodyp + "</div><div id=printResFinance class='container page' style='margin: 0px;'><div class=row style='border:solid 1px;  margin-left: 0px; width:19cm;'><div style='border-right:solid 1px; font-weight:bold; height:18px; font-size:12px; width:9.961cm; float:left;'> &nbsp;Minimum # of Staff Scheduled At Any Time: <i style="+s1+"> &nbsp;"+$scope.fdReport[ij][0]['MinStaffSchAnyTtime']+"</i></div><div style=' float:left; margin-right: 1px; font-weight:bold; height:18px; font-size:12px;'> &nbsp; # of Staff Participating In This Drill: <i style="+s1+"> &nbsp;"+$scope.fdReport[ij][0]['StaffPartInDrill']+"</i></div></div>";
		bodyp=bodyp + "<div class=row style='border-bottom:solid 1px; border-left:solid 1px; border-right:solid 1px; margin-left: 0px; width:19cm;'><div style='border-right:solid 1px; font-weight:bold; height:18px; font-size:12px; width:4.761cm; float:left;'> &nbsp;Staff Participating:</div><div style=' border-right:solid 1px; float:left; margin-right: 1px; font-weight:bold; height:18px; font-size:12px; width:5.20cm;'> &nbsp;Role/Assistance Provided:</div><div style='border-right:solid 1px; float:left; margin-right: 1px; font-weight:bold; height:18px; font-size:12px; width:4.25cm;'>&nbsp; Starting Point:</div><div style='float:left; margin-right: 1px; font-weight:bold; height:18px; font-size:12px;'>&nbsp; Notes:</i></div></div>";		
		for (var i=0; i<$scope.fdReport[ij][1].length; i++) { var v1=$scope.fdReport[ij][1][i];
		bodyp=bodyp + "<div class=row style='border-bottom:solid 1px; border-left:solid 1px; border-right:solid 1px; margin-left: 0px; width:19cm;'><div style='border-right:solid 1px; font-weight:bold; height:18px; font-size:12px; width:4.761cm; float:left;'> &nbsp;<i style="+s1+">"+ v1['EmpFName']+ ' ' + v1['EmpLName']+"</i></div><div style=' border-right:solid 1px; float:left; margin-right: 1px; font-weight:bold; height:18px; font-size:12px; width:5.20cm;'> &nbsp;<i style="+s1+">"+ ((v1['Role'] != null) ? (v1['Role']) :'') +"</i></div><div style='border-right:solid 1px; float:left; margin-right: 1px; font-weight:bold; height:18px; font-size:12px; width:4.25cm;'>&nbsp;<i style="+s1+">"+ ((v1['StartingPt'] != null) ? (v1['StartingPt']) :'') +"</i></div><div style='float:left; margin-right: 1px; font-weight:bold; height:18px; font-size:12px;'>&nbsp;<i style="+s1+">"+ ((v1['Notes'] != null) ? (v1['Notes']) : '')+"</i></div></div>";		
		}
		bodyp=bodyp + "<div class=row style='margin:0px; width:19cm;'><img src=img/pict/fireDrill6.jpg style='width:19cm;'></div>";	
		bodyp=bodyp + "<div class=row style='border-bottom: solid 1px; border-left: solid 1px; border-right: solid 1px;margin:0px; width:19cm;'><p style='margin:5px; color:red; font-size:12px;'><i>"+$scope.fdReport[ij][0]['Description']+"</i></p></div>";		
		var desLen= Math.trunc($scope.fdReport[ij][0]['Description'].length/67)+1;
		bodyp=bodyp + "<div class=row style='width:19cm;  margin-top: "+(125-(desLen*50/22))/2+"%;'><img src=img/pict/fireDrill7.jpg style='width:19cm;'>"+ cssSetting(720, 300,0, $scope.licenseNo)+ cssSetting(720, 150,0, d)+ "</div>";	
		bodyp= bodyp +"</div>"; page=page + bodyp;
		
	//} 
	x.innerHTML="Close"; $scope.nPageC=1; myWindow.document.write(links + page); //links+page); 
	}  
else if ($scope.nPageC==1) { $scope.nPageC=0;  myWindow.close(); x.innerHTML="View"; } 
}
$scope.printRProgNote = function() {    var fName=$scope.columnNames[1].tblName, LName= $scope.columnNames[3].tblName, preBy; var x=document.getElementById("printBtn"); 
		var myWindow = window.open("", "Print", "width='+screen.width+',height='+screen.height+'"); 
	if ($scope.nPageC==0) 
		{ 		
		var links= "<link rel=stylesheet href='css/bootstrap-responsive.css' media=all type=text/css><link rel=stylesheet href='css/Bootstrap.min.css' media=all type=text/css><link rel='stylesheet' href='css/ui-bootstrap-2.5.0-csp.css' type='text/css'> <link rel='stylesheet' href='css/printable.css' type='text/css'>";  var s1="'margin-left:0px; float: left; text-align: left; font-family: Arial, Helvetica, sans-serif; border-right:solid 1px; font-size:20px;'", s2="'margin-left:0px; float: left; height: 20px; text-align: left; font-family: Helvetica, sans-serif; border-right:solid 1px; font-size:10px; width:12.5%'"; 
		var col1="col-xs-1 col-sm-1 col-md-1 col-lg-1", col2="col-xs-2 col-sm-2 col-md-2 col-lg-2", col8="col-xs-8 col-sm-8 col-md-8 col-lg-8"; var s5="'margin-left:-10px; font-weight:normal;'";var s1="'margin-left:0px; float: left; text-align: left; font-family: Arial, Helvetica, sans-serif; border-right:solid 1px; font-size:20px;'", s2="'margin-left:0px; float: left; height: 20px; text-align: left; font-family: Helvetica, sans-serif; border-right:solid 1px; font-size:10px; width:12.5%'"; var col1="col-xs-1 col-sm-1 col-md-1 col-lg-1", col2="col-xs-2 col-sm-2 col-md-2 col-lg-2", col8="col-xs-8 col-sm-8 col-md-8 col-lg-8"; var s5="'margin-left:-10px; font-weight:normal;'"; s9="'margin:10px; float: left;  height: 20px; text-align: left; font-family: Helvetica, sans-serif; font-size:24px;  width:100%'";
		var str, end, da, i=0, strcont='', p=0,lines=0, bodyp='', pages=0; 
		var header= "<div class=row style='margin-left: -10px; width:630px'><div style='border: solid 1px; border-radius:5px; height:40px;'><p style="+s9+">"+$rootScope.logRec[$cookies.get ('licNo')]['Name']+"</p></div><div style='border: solid 1px;border-radius:5px; height:40px;'><p style="+s9+">Individual Progress Note</p></div><div style='border: solid 1px; border-radius:5px; height:40px;'><p style='margin:10px; float: left; font-size:24px;'>Resident Name: <u><i>"+ $scope.columnNames[1].tblName + " " +$scope.columnNames[3].tblName+ "</i></u></p></div></div>";
		bodyp=bodyp + "<div id=printResFinance class='container page' style='margin: 5px;'><div class=row style='margin:0px; width:17cm;'>"+ header+"</div><div class=row style='border:solid 1px; margin-left: 0px; width:605px;'><div class='"+col1+"' style='margin-left: 0px; margin-right: 0px; font-weight:bold; height:16px; font-size:14px; width:2cm;'>Date</div><div  class='"+col8+"' style='border-left: solid 1px; border-right: solid 1px;  margin-left:-5px; margin-right:-5px; font-weight:bold; height:16px; font-size:14px; text-align:center;'>Documentation </div><div class='"+col1+"' style='margin-left:20px; font-weight:bold; height:16px; width:3cm; font-size:14px;'>Signature</div></div>";
			for (var j=0; j<$scope.PNReport.length; j++) 
			{   var textV=$scope.PNReport[j]['ProDoc'], templines=lines; if (textV.length%67!=0) lines= lines + Math.trunc(textV.length/67)+1;  else lines= lines + Math.trunc(textV.length/67); da= new Date($scope.PNReport[j]['ProgDate']);  da.setDate(da.getDate()+1) ;  d=(da.getMonth()+1)+ '/'+(da.getDate())+'/'+da.getFullYear();
					var TimeStamp= "<i style='margin-left: 10px; margin-top:0px; font-size:10px'> written by: "  + $scope.PNReport[j]['EmpId']+ " <br> " + $scope.PNReport[j]['TimeStamp'] + "</i>";
					//if (lines==40) { 
					//bodyp=bodyp + "<div class=row style='border:solid 1px; margin-left: 0px; width:605px;'><div class='"+col1+"' style='margin-left: 0px; font-size:12px; width:2cm;'><label style="+s5+">" + d +"</label></div><span  class='"+col8+"' style='border-left: solid 1px; border-right: solid 1px; margin-left:-5px; margin-right:-5px;'><p style='text-align:justify; margin-top:5px; margin-bottom: 5px; margin-left:-10px; margin-right:-10px; font-size:12px; font-family: 'Courier New';'>"+$scope.PNReport[j]['ProDoc'].substr(str , end)+ '\n' +"</p></span><div style='margin-left:5px; class='"+col1+"'>"+TimeStamp+ "</div></div>"; 
					//bodyp=bodyp + "<div class=row style='margin:0px; width:17cm; margin-top: 2%;'></div></div>"
					//}
					if (lines>=40) 
					{	 
						str=0; end=(40-templines)*67; //var curda= new Date(), curd=(curda.getMonth()+1)+ '/'+(curda.getDate()+1)+'/'+curda.getFullYear();
						if (templines!=40) { strcont='Cont...'; pages=pages+1;
						bodyp=bodyp + "<div class=row style='border:solid 1px; margin-left: 0px; width:605px;'><div class='"+col1+"' style='margin-left: 0px; font-size:12px; width:2cm;'><label style="+s5+">" + d +"</label></div><span  class='"+col8+"' style='border-left: solid 1px; border-right: solid 1px; margin-left:-5px; margin-right:-5px;'><p style='text-align:justify; margin-top:5px; margin-bottom: 5px; margin-left:-10px; margin-right:-10px; font-size:12px; font-family: 'Courier New';'>"+$scope.PNReport[j]['ProDoc'].substr(str , end)+ '\n' +"</p></span><div style='margin-left:5px; class='"+col1+"'>"+TimeStamp+ "</div></div>"; 
						bodyp=bodyp + "<div class=row style='margin:0px; width:17cm; margin-top: 2%;'> pages "+ pages+" </div></div>"
							}
							while (lines > 40) 
							{ 	lines=lines-40;
								if (lines>40) { str=end+1; end= end + (40*67);   pages=pages+1;
								bodyp=bodyp + "<div id=printResFinance class='container page' style='margin: 5px;'><div class=row style='margin:0px; width:17cm;'><div class=row style='border:solid 1px; margin-left: 0px; width:605px;'><div class='"+col1+"' style='margin-left: 0px; margin-right: 0px; font-weight:bold; height:16px; font-size:14px; width:2cm;'>Date</div><div  class='"+col8+"' style='border-left: solid 1px; border-right: solid 1px;  margin-left:-5px; margin-right:-5px; font-weight:bold; height:16px; font-size:14px; text-align:center;'>Documentation (<i>"+fName +'  '+ LName+ "</i>)</div><div class='"+col1+"' style='margin-left:20px; font-weight:bold; height:16px; width:3cm; font-size:14px;'>Signature</div></div>";
								bodyp=bodyp + "<div class=row style='border:solid 1px; margin-left: 0px; width:605px;'><div class='"+col1+"' style='margin-left: 0px; font-size:12px; width:2cm;'><label style="+s5+">" + strcont+ '\n'+ d +"</label></div><span  class='"+col8+"' style='border-left: solid 1px; border-right: solid 1px; margin-left:-5px; margin-right:-5px;'><p style='text-align:justify; margin-top:5px; margin-bottom: 5px; margin-left:-10px; margin-right:-10px; font-size:12px; font-family: 'Courier New';'>"+$scope.PNReport[j]['ProDoc'].substr(str-1 , end)+ "</p></span><div style='margin-left:5px; class='"+col1+"'>"+TimeStamp+ "</div></div>"; 
								bodyp=bodyp + "<div class=row style='margin:0px; width:17cm; margin-top: 2%;'> pages "+ pages+ "</div></div>";
								}
								else { str=end+1; end= end + (lines*67);
								bodyp=bodyp + "<div id=printResFinance class='container page' style='margin: 5px;'><div class=row style='margin:0px; width:17cm;'>"+header+"</div><div class=row style='border:solid 1px; margin-left: 0px; width:605px;'><div class='"+col1+"' style='margin-left: 0px; margin-right: 0px; font-weight:bold; height:16px; font-size:14px; width:2cm;'>Date</div><div  class='"+col8+"' style='border-left: solid 1px; border-right: solid 1px;  margin-left:-5px; margin-right:-5px; font-weight:bold; height:16px; font-size:14px; text-align:center;'>Documentation </div><div class='"+col1+"' style='margin-left:20px; font-weight:bold; height:16px; width:3cm; font-size:14px;'>Signature</div></div>";
								bodyp=bodyp + "<div class=row style='border:solid 1px; margin-left: 0px; width:605px;'><div class='"+col1+"' style='margin-left: 0px; font-size:12px; width:2cm;'><label style="+s5+">" + strcont + '\n'+ d +"</label></div><span  class='"+col8+"' style='border-left: solid 1px; border-right: solid 1px; margin-left:-5px; margin-right:-5px;'><p style='text-align:justify; margin-top:5px; margin-bottom: 5px; margin-left:-10px; margin-right:-10px; font-size:12px; font-family: 'Courier New';'>"+$scope.PNReport[j]['ProDoc'].substr(str-1 , end)+ '\n'+"</p></span><div style='margin-left:5px; class='"+col1+"'>"+TimeStamp+ "</div></div>"; 
								} strcont='';		 					
							}
					}  
					else  {  bodyp=bodyp + "<div class=row style='border:solid 1px; margin-left: 0px; width:605px;'><div class='"+col1+"' style='margin-left: 0px; font-size:12px; width:2cm;'><label style="+s5+">" + d +"</label></div><span  class='"+col8+"' style='border-left: solid 1px; border-right: solid 1px; margin-left:-5px; margin-right:-5px;'><p style='text-align:justify; margin-top:5px; margin-bottom: 5px; margin-left:-10px; margin-right:-10px; font-size:12px; font-family: 'Courier New';'>"+$scope.PNReport[j]['ProDoc']+"</p></span><div style='margin-left:5px; class='"+col1+"'>"+TimeStamp+ "</div></div>"; } 
			} bodyp=bodyp + "<div class=row style='margin:0px; width:17cm; margin-top: "+(93-(lines/40)*100)+"%;'>  pages "+ pages+" </div></div>";
				x.innerHTML="Close"; $scope.nPageC=1; myWindow.document.write(links+bodyp); 
	}  
else if ($scope.nPageC==1) { $scope.nPageC=0;  myWindow.close(); x.innerHTML="View";  } 
}
//This is finance
	$scope.printRFinance = function() {   
	var links= "<link rel=stylesheet href='css/bootstrap-responsive.css' media=all type=text/css><link rel=stylesheet href='css/Bootstrap.min.css' media=all type=text/css><link rel='stylesheet' href='css/ui-bootstrap-2.5.0-csp.css' type='text/css'> <link rel='stylesheet' href='css/printable.css' type='text/css'>";  		
		var i=0, p=0, bodyp='', pages=$scope.RecReport.length/24,  signature='', resinfo='', title1='', title2='', data='', inc=0, incamount=0, expense=0, expamount=0, Balance=0, invoice='';  var x=document.getElementById("printBtn");  var s1="'margin-left:0px; float: left; text-align: left; height: 25px;  font-family: Arial, Helvetica, sans-serif; border-right:solid 1px; font-size:20px;  width:25%'", s2="'margin-left:0px; float: left; height: 20px; text-align: left; font-family: Helvetica, sans-serif; border-right:solid 1px; font-size:10px; width:12.5%'"; s3="'margin:0px; float: left; text-align: left; font-weight: bold; height:30px; center; font-family: Arial, Helvetica, sans-serif; border-right:solid 1px; font-size:13px;  width:12.5%'", s4="'margin-left:0px; float: left; height: 25px; text-align: left; font-family: Arial, Helvetica, sans-serif; border-right:solid 1px; font-size:20px;  width:12.5%'"; 
		var myWindow = window.open("", "Print", "width='+screen.width+',height='+screen.height+'");  var s5="'margin-left: 5px; '", s6="'margin-left: 5px; '"; s7="'margin-left:0px; float: left; border-right:solid 1px;  height: 20px; text-align: left; font-family: Helvetica, sans-serif; font-size:14px;  width:25%'";  s8="'margin-left:0px; float: left; border-right:solid 1px;  height: 25px; text-align: left; font-family: Helvetica, sans-serif; font-size:16px;  width:100%'";  s9="'margin:10px; float: left;  height: 25px; text-align: left; font-family: Helvetica, sans-serif; font-size:24px;  width:100%'";
			if (pages%1>0) pages=pages+1-pages%1; 
		if ($scope.nPageC==0) {  resinfo="<p style="+s9+">"+$rootScope.logRec[$cookies.get ('licNo')]['Name']+"</p><p style="+s9+">Individual Financial Ledger</p><p style='margin:10px; float: left; font-size:24px;'>Resident Name: <u><i>"+ $scope.columnNames[1].tblName + " " +$scope.columnNames[3].tblName+ "</i></u></p><p style='margin:10px; float: left; font-size:24px;'>TYPE of Account (Mark circle):  <label style='float:right; font-weight: normal;'><input type=radio name=cash> Cash &nbsp;&nbsp;<input type=radio name=Checking> Checking&nbsp;&nbsp; <input type=radio name=Saving> Savings </label></p><br>";
			for (var j=0; j<pages; j++)
			{   var name='Name', initial='Initials'; for (var s=0; s<5; s++) { if (s==!0) {name=''; initial='';  }  signature=signature + "<div class=row style='margin-left: 0px; margin-right: 0px; border-top:solid 1px;'><span style="+s7+">&nbsp;&nbsp;"+name+"</span><span style="+s7+">&nbsp;&nbsp;"+initial+"</span><span style="+s7+">&nbsp;&nbsp;"+name+"</span><span style="+s7+">&nbsp;&nbsp;"+initial+"</span></div>"; }
				x.innerHTML="Close"; $scope.nPageC=1;  title1="<div class=row style='margin-left: 0px; margin-right: 0px; width:17cm;'><span style="+s4+">&nbsp</span><span style="+s1+"><label style="+s5+">INCOME</label></span><span style="+s1+"><label style="+s5+">EXPENSE</label></span><span style="+s4+">&nbsp;</span><span style="+s4+">&nbsp;</span><span style="+s4+">&nbsp;</span></div>"; 
				title2="<div class=row style='border-left: solid 1px; border-right: solid 1px;margin-right: 0px; margin-left: 0px; width:17cm;'><span style="+s3+"><label style="+s5+">Date</label></span><span style="+s3+"><label style="+s5+">Income Source</label></span><span style="+s3+"><label style="+s5+">Amount</label></span><span style="+s3+"><label style="+s5+">Item Description</label></span><span style="+s3+"><label style="+s5+">Amount</label></span><span style="+s3+"><label style="+s5+">Balance</label></span><span style="+s3+"><label style="+s5+">Receipt No.</label></span><span style="+s3+"><label style="+s5+">Initial</label></span></div>";
				for (var l=0; l<24; l++) 
				{  if (i<$scope.RecReport.length) {if ($scope.RecReport[i]['ResIncome']==null) inc='&nbsp;'; else inc=$scope.RecReport[i]['ResIncome']; if ($scope.RecReport[i]['ResIncAmount']==null) incamount=0; else incamount=$scope.RecReport[i]['ResIncAmount']; if ($scope.RecReport[i]['ResExpense']==null) expense='&nbsp;'; else expense=$scope.RecReport[i]['ResExpense']; if ($scope.RecReport[i]['ResExpAmount']==null) expamount=0; else expamount=$scope.RecReport[i]['ResExpAmount']; if ($scope.RecReport[i]['Invoice']==null) invoice='&nbsp;'; else invoice=$scope.RecReport[i]['Invoice'];  }				
				if (i<$scope.RecReport.length) {  var da= new Date($scope.RecReport[i]['ResFinDate']); da.setDate(da.getDate()+1); Balance= parseFloat (Balance) + parseFloat ($scope.RecReport[i]['ResIncAmount']-$scope.RecReport[i]['ResExpAmount']);  data=data + "<div class=row style='margin-left: 0px; margin-right: 0px; border-top:solid 1px;'><span style="+ s2+">&nbsp;&nbsp;"+   (da.getMonth()+1)+ '/'+(da.getDate())+'/'+da.getFullYear() +"</span><span style="+ s2+">&nbsp;&nbsp;"+ inc +"</span><span style="+ s2+">&nbsp;&nbsp;"+ ((incamount != 0) ? ('$'+incamount) :'' )+"</span><span style="+ s2+">"+expense+"</span><span style="+ s2+">&nbsp;&nbsp;"+ ((expamount != 0) ? ('$' + expamount) :'' )+"</span><span style="+ s2+">&nbsp;&nbsp;$"+ Balance.toFixed(2)+"</span><span style="+ s2+">"+ invoice+"</span><span style="+ s2+">&nbsp;</span></div>"; }
				else data=data + "<div class=row style='margin-left: 0px; margin-right: 0px; border-top:solid 1px; width:17cm;'><span style="+ s2+"><label style="+s5+">&nbsp;</label></span><span style="+ s2+"><label style="+s5+">&nbsp;</label></span><span style="+ s2+"><label style="+s5+">&nbsp;</label></span><span style="+ s2+"><label style="+s5+">&nbsp;</label></span><span style="+ s2+">&nbsp;</span><span style="+ s2+"><label style="+s5+">&nbsp;</label></span><span style="+ s2+"><label style="+s5+">&nbsp;</label></span><span style="+ s2+">&nbsp;</span></div>";
				i++;      
				} p++;
				bodyp=bodyp+ "<Div id=printResFinance class='container page' style='margin: 5px;'><div class=row style='margin-left: -15px; margin-right: -50px; color:red; width:17cm;'></div><div class=row style='margin-left: -10px; margin-right: 10px; border:solid 0px;'>"+ resinfo+"</div><div class=row style='border-left:solid 1px; border-bottom:solid 1px; border-top:solid 1px; border-right:solid 1px; text-align: left; width:17cm;'>&nbsp;&nbsp;Signature Key: "+signature+"</div><br><div class=row style='border: solid 1px; width:17cm;'>"+title1+"</div><div class=row>"+title2+"</div><Div class=row style='border-left:solid 1px; border-bottom:solid 1px; text-align: left; width:17cm;'>"+ data+"</div><Div class=row style=''><label style='float:right; font-weight:normal;'>Page <u>"+p +"</u> of <u>____</u></label></div><Div class=row style='width:17cm;'><Div></div></div></div>";  	
				data='', title1='', title2='', signature='';
			}
		myWindow.document.write(links+bodyp);  
		}  
			else if ($scope.nPageC==1) {$scope.nPageC=0;  myWindow.close(); x.innerHTML="View"; } 
}
	$scope.getRecReport = function () { var config= {params: $scope.tempArrJson, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) .then (function(response) { $scope.RecReport=response.data; })  , function (response) { alert ("failed to show"); };  }
	$scope.getProgressNoteReport = function () { var config= {params: $scope.tempArrJson, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) .then (function(response) { $scope.PNReport=response.data;   })  , function (response) { alert ("failed to show"); };  }
	$scope.getfiredrillReport = function () { var config= {params: $scope.tempArrJson, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) .then (function(response) { $scope.fdReport=response.data;  })  , function (response) { alert ("failed to show"); };  }
	$scope.getweeklyMenuReport = function () { var config= {params: $scope.tempArrJson, headers: {'Accept' : 'application/json'}}; $http.get("pages/connection.php", config) .then (function(response) { $scope.weeklyMenuReport=response.data;   })  , function (response) { alert ("failed to show"); };  }	
	$scope.insertWeeklyMenu = function () { $scope.tempArrJson['lastDate']= $scope.weeklyMenuSummary[0][0]['maxDate']; var MaxDate= $scope.weeklyMenuSummary[0][0]['MaxMinDiff']; MaxDate++; for (var i in $scope.weeklyMenuSummary[MaxDate]) { var mcat= $scope.weeklyMenuSummary[MaxDate][i]['MealCat'], msno=$scope.weeklyMenuSummary[MaxDate][i]['MealSno']; if (mcat=='Meal BreakFast') $scope.tempArrJson['Meal BreakFast']= msno; else if (mcat=='Meal Lunch') $scope.tempArrJson['Meal Lunch']= msno; else if (mcat=='Meal Dinner') $scope.tempArrJson['Meal Dinner']= msno;  } 
		$scope.tempArrJson['postName']='InsertMonthlyMenu'; var arrJson={}, arrDataInfo={}; arrDataInfo[0]=$scope.tempArrJson; 
		var confirmpas= $window.prompt ('Password for Record Operation Required!'); if (confirmpas==='Sami@123') {
		$http.post("pages/post_connection.php", arrDataInfo ,  { headers: {'Content-Type': 'application/x-www-form-urlencoded'} }) .then (function(response) {  alert (response.data);  $scope.assfillFields();  });		
		}
		else alert ('Wrong Confirmation Password!');
	}
/// pattern 
	$scope.getPattern = function($temp, t) {  if (t=='Main')  $temp.length=$temp.length+1;
			for (var k in $temp) {  if ($temp[k].tblLabel=='TimeStamp') { $scope.realDT= new Date(); $scope.realDT.toLocaleString();  $scope.realDTP=k; }
					if (t=='Main') {  if ($temp[k].tblKey=='PRI') $scope.pK=$temp[k].tblLabel;  if ($temp[k].tblKey=='MUL' || $temp[k].tblKey=='UNI') $temp[k].tblNgIf =true; } 
					if (t=='Ass') { if ($temp[k].tblKey=='PRI')  { $scope.asspK=$temp[k].tblLabel; } if ($temp[k].tblKey=='MUL' || $temp[k].tblKey=='UNI') $temp[k].tblNgIf =true; } 
								if ($temp[k].tblAutoInc=='auto_increment')
								$temp[k].tblAutoInc=true; else $temp[k].tblAutoInc=false;  
								var dtString=$temp[k].tblType, dtComment=$temp[k].tblComments; 
								var vcSize=""; 
								if ($temp[k].tblKey=='PRI') $temp[k].tblStyle={"margin":"0px", "font-weight": "bold", "font-family": "Arial, Helvetica, sans-serif", "color": "Navy"}; 
									else 
								if ($temp[k].tblKey=='MUL')
									$temp[k].tblStyle={"margin":"0px","font-family": "Arial, Helvetica, sans-serif", "background-color":"rgb(180, 180, 180)","color": "Navy"}; 
										else if ($temp[k].tblKey=='UNI') $temp[k].tblStyle={"margin":"0px","font-family": "Arial, Helvetica, sans-serif", "background-color":"rgb(180, 180, 180)","color": "Navy"};  
										else $temp[k].tblStyle={"margin":"0px","font-family": "Arial, Helvetica, sans-serif", "color": "Navy"}; 
		if(dtString.substr(0,7)=='varchar') {  
		for (var i=8;i<dtString.length-1;i++) vcSize=vcSize + dtString.charAt(i); vcSize= parseInt(vcSize); $temp[k].tblColSize=vcSize;
		var idRegExp = new RegExp("\\bid\\b","i"); if (dtComment.search(idRegExp)!=-1) { $temp[k].tblId='id'; $temp[k].tblPat= new RegExp("^[a-z]*[a-z0-9\\_\\.\\-\\/]{3,"+(vcSize)+"}$","i"); }
		var codeRegExp = new RegExp("\\code\\b","i"); if (dtComment.search(codeRegExp)!=-1) {  $temp[k].tblId='id'; $temp[k].tblPat= new RegExp("^[a-z]{1}[a-z0-9\\_\\.\\-\\/]{3,"+(vcSize)+"}$","i"); }
		var nameRegExp = new RegExp("\\bname\\b","i"); if (dtComment.search(nameRegExp)!=-1) {  $temp[k].tblId='name'; $temp[k].tblPat= new RegExp("^[a-zA-Z\\ \\_]{1,"+(vcSize)+"}$");   }
		var titleRegExp = new RegExp("\\btitle\\b","i"); if (dtComment.search(titleRegExp)!=-1) {  $temp[k].tblId='title'; $temp[k].tblPat= new RegExp("^[a-zA-Z0-9\\_\\- ]{1,"+(vcSize-1)+"}$","i");   } 
		var phoneRegExp = new RegExp("\\phone\\b","i"); if (dtComment.search(phoneRegExp)!=-1) { $temp[k].tblInputType='tel'; $temp[k].tblId='phone';  $temp[k].tblPat= new RegExp("^([\\+]\\d{1,3}?([\\.\\- ])?)?(\\d{3}[\\.\\- ]?)(\\d{3}[\\.\\- ]?)(\\d{4}[\\.\\- ]?){1,"+(vcSize-1)+"}$"); } 
		var addressRegExp = new RegExp("\\address\\b","i"); if (dtComment.search(addressRegExp)!=-1) { $temp[k].tblInputType='text'; $temp[k].tblId='address'; $temp[k].tblPat= new RegExp("^[a-zA-Z0-9\\_\\- ]{3,"+(vcSize)+"}$");   }  
		var cityRegExp= new RegExp("\\bcity\\b","i"); if (dtComment.search(cityRegExp)!=-1) {  $temp[k].tblId='city'; $temp[k].tblPat= new RegExp("^[a-zA-Z]{1,"+(vcSize)+"}$");    }
		var stateRegExp = new RegExp("\\bstate\\b","i"); if (dtComment.search(stateRegExp)!=-1) {  $temp[k].tblId='state'; $temp[k].tblPat= new RegExp("^([a-z]{2}?){1,"+(vcSize)+"}$","i"); } //|([a-z]){1,"+(vcSize)+"})
		var zipRegExp= new RegExp("\\bzip\\b","i"); if (dtComment.search(zipRegExp)!=-1) {  $temp[k].tblId='zip'; $temp[k].tblPat= new RegExp("^(\\d{5}(\\-\\d{4})?){1,"+(vcSize-1)+"}$"); } //|([a-z][a-z]?\\d\\d?|[a-z{2}\\d[a-z])?\\d[a-z][a-z]){5,"+(vcSize)+"}$","i"
		var typeRegExp = new RegExp("\\btype\\b","i"); if (dtComment.search(typeRegExp)!=-1) { $temp[k].tblId='type'; $temp[k].tblPat= new RegExp("^[a-zA-Z0-9_\\-\\/ ]{1,"+(vcSize)+"}$"); } 
		var countyRegExp = new RegExp("\\bcounty\\b","i"); if (dtComment.search(countyRegExp)!=-1) {  $temp[k].tblId='county'; $temp[k].tblPat= new RegExp("^[a-zA-Z]{1,"+(vcSize)+"}$"); } 
		var emailRegExp = new RegExp("\\bemail\\b","i"); if (dtComment.search(emailRegExp)!=-1) { $temp[k].tblInputType='email'; $temp[k].tblId='email';   }  //$temp[k].tblPat= new RegExp("^([a-z0-9\\_])?([\\w!#$%&'*\\+-/=?^`{|}~;])+([@])(([a-z]|[\\d]+)?)((([a-z0-9]+|[\\d]+)?([\\.]))([a-z]{2,4})$","i");
		var passwordRegExp = new RegExp("\\bpassword\\b","i"); if (dtComment.search(passwordRegExp)!=-1) {  $temp[k].tblInputType='password'; } 
		} 
		else if (dtString.substr(0,10)=='tinyint(1)') { $temp[k].tblInputType='checkbox'; } 
		else if (dtString.substr(0,3)=='bit'|| dtString.substr(0,3)=='int' || dtString.substr(0,7)=='tinyint' || dtString.substr(0,8)=='smallint' || dtString.substr(0,8)=='mediumint' || dtString.substr(0,6)=='bigint') $temp[k].tblPat= new RegExp("[+-]?([^0][0-9]*|0)"); 
		else if (dtString.substr(0,7)=='decimal' || dtString.substr(0,5)=='float' || dtString.substr(0,6)=='double' || dtString.substr(0,4)=='real') $temp[k].tblPat=new RegExp("^([0-9]+\\.[0-9]+)?$"); 
    	else if (dtString.substr(0,8)=='datetime') { $temp[k].tblInputType='datetime-local'; }
		else if (dtString.substr(0,4)=='date') { $temp[k].tblInputType='date'; $temp[k].tblPat=new RegExp("^(\\d{4}[-/]\\d{2}[-/]\\d{2})|(\\d{2}[-/]\\d{2}[-/]\\d{4})$"); }//(0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])[- /.](19|20)\\d\\d	
		else if (dtString.substr(0,4)=='time') {   }
		else if (dtString.substr(0,4)=='text')  { $temp[k].tblInputType='textarea'; /* $temp[k].tblPat= new RegExp("^[a-z0-9\\.\\ ]*$");*/ } 
		else if (dtString.substr(0, 10)=='mediumblob')  { $temp[k].tblInputType='mediumblob'; /* $temp[k].tblPat= new RegExp("^[a-z0-9\\.\\ ]*$");*/ }  
				}
		return $temp;
		//var re= new RegExp("\\D"); $temp[k].tblCol = Integer.parseInt(dtString.replaceAll(re, " "));
		//var telRegExp = /^(\+\d{1,3} ?)?(\(\d{1,5}\)|\d{1,5})?\d{3}?\d{0,7}( (x|xtn|ext|extn|pax|pbx|extension)?\.? ?\d{2-5})?$/i;
		//var pcodeRegExp = /^(\d{5}(-\d{4})?|([a-z][a-z]?\d\d?|[a-z{2}\d[a-z])?\d[a-z][a-z])$/i;
		//var emailRegExp = /^(([^<>()\[\]\\.,;:@"\x00-\x20\x7F]|\\.)+|("""([^\x0A\x0D"\\]|\\\\)+"""))@(([a-z]|#\d+?)([a-z0-9-]|#\d+?)*([a-z0-9]|#\d+?)\.)+([a-z]{2,4})$/i;																						
	}
});  
